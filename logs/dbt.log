

============================== 2022-07-15 16:33:20.144340 | e7b98073-6f8f-4676-8ab5-64c14df7ab20 ==============================
16:33:20.144365 [info ] [MainThread]: Running with dbt=1.1.1
16:33:20.145020 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
16:33:20.145236 [debug] [MainThread]: Tracking: tracking
16:33:20.174121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e0783e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e0783e070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e07870190>]}
16:33:20.198955 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
16:33:20.199342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e7b98073-6f8f-4676-8ab5-64c14df7ab20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e07884940>]}
16:33:20.209636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e07892a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e07892760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e07892520>]}


============================== 2022-07-15 16:35:26.482980 | 8cc95d11-8688-481c-8e73-2165c9317d5b ==============================
16:35:26.483052 [info ] [MainThread]: Running with dbt=1.1.1
16:35:26.487776 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
16:35:26.488203 [debug] [MainThread]: Tracking: tracking
16:35:26.546027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff441f2f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff441f2ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff441f32670>]}
16:35:26.573201 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
16:35:26.573608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8cc95d11-8688-481c-8e73-2165c9317d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff441f8f370>]}
16:35:26.698318 [debug] [MainThread]: Parsing macros/catalog.sql
16:35:26.703941 [debug] [MainThread]: Parsing macros/relations.sql
16:35:26.705977 [debug] [MainThread]: Parsing macros/adapters.sql
16:35:26.739543 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
16:35:26.742510 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
16:35:26.749244 [debug] [MainThread]: Parsing macros/materializations/configs.sql
16:35:26.752686 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
16:35:26.755080 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
16:35:26.786356 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
16:35:26.810392 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
16:35:26.838815 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
16:35:26.846277 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
16:35:26.858748 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
16:35:26.861832 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
16:35:26.869191 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
16:35:26.899212 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
16:35:26.903950 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
16:35:26.934140 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
16:35:26.957424 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
16:35:26.967789 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
16:35:26.974664 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
16:35:26.995402 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
16:35:26.999209 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
16:35:27.012540 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
16:35:27.026583 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
16:35:27.036015 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
16:35:27.058849 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
16:35:27.060798 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
16:35:27.063894 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
16:35:27.065834 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
16:35:27.066916 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
16:35:27.067908 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
16:35:27.068741 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
16:35:27.070452 [debug] [MainThread]: Parsing macros/etc/statement.sql
16:35:27.076128 [debug] [MainThread]: Parsing macros/etc/datetime.sql
16:35:27.089088 [debug] [MainThread]: Parsing macros/adapters/schema.sql
16:35:27.092474 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
16:35:27.097283 [debug] [MainThread]: Parsing macros/adapters/relation.sql
16:35:27.112083 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
16:35:27.116312 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
16:35:27.122620 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
16:35:27.132599 [debug] [MainThread]: Parsing macros/adapters/columns.sql
16:35:27.145315 [debug] [MainThread]: Parsing tests/generic/builtin.sql
16:35:27.426272 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
16:35:27.438061 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
16:35:27.499088 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'yt_channel_from_brazil' in the 'models' section of file 'models/mart/schema.yml'
16:35:27.501084 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 't_video_channel_groupped' in the 'models' section of file 'models/mart/schema.yml'
16:35:27.541054 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_blog.not_null_yt_channel_from_brazil_channel.856162f305' (models/mart/schema.yml) depends on a node named 'yt_channel_from_brazil' which was not found
16:35:27.541351 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_blog.not_null_yt_channel_from_brazil_total_subs.ce1a2fa95b' (models/mart/schema.yml) depends on a node named 'yt_channel_from_brazil' which was not found
16:35:27.541659 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_blog.not_null_yt_channel_from_brazil_language.c36d9873b0' (models/mart/schema.yml) depends on a node named 'yt_channel_from_brazil' which was not found
16:35:27.541936 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_blog.not_null_yt_channel_from_brazil_owner.b57066e424' (models/mart/schema.yml) depends on a node named 'yt_channel_from_brazil' which was not found
16:35:27.542175 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_blog.not_null_yt_channel_from_brazil_country.cf50509de5' (models/mart/schema.yml) depends on a node named 'yt_channel_from_brazil' which was not found
16:35:27.542447 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_blog.not_null_t_video_channel_groupped_name.63b3ccc1e3' (models/mart/schema.yml) depends on a node named 't_video_channel_groupped' which was not found
16:35:27.542754 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_blog.not_null_t_video_channel_groupped_total.631287fe99' (models/mart/schema.yml) depends on a node named 't_video_channel_groupped' which was not found
16:35:27.572879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cc95d11-8688-481c-8e73-2165c9317d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44206d0d0>]}
16:35:27.582330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cc95d11-8688-481c-8e73-2165c9317d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff441f8faf0>]}
16:35:27.582699 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 8 sources, 0 exposures, 0 metrics
16:35:27.582971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cc95d11-8688-481c-8e73-2165c9317d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff441f8a040>]}
16:35:27.585349 [info ] [MainThread]: 
16:35:27.586010 [debug] [MainThread]: Acquiring new postgres connection "master"
16:35:27.586944 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
16:35:27.601494 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
16:35:27.601759 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
16:35:27.601910 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:35:28.256913 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.65 seconds
16:35:28.264128 [debug] [ThreadPool]: On list_get_dbt: Close
16:35:28.291605 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
16:35:28.298865 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
16:35:28.299058 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
16:35:28.299197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:35:28.313603 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
16:35:28.325813 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
16:35:28.326049 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
16:35:28.369441 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.04 seconds
16:35:28.371072 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
16:35:28.371361 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
16:35:28.376532 [debug] [MainThread]: Using postgres connection "master"
16:35:28.376743 [debug] [MainThread]: On master: BEGIN
16:35:28.376891 [debug] [MainThread]: Opening a new connection, currently in state init
16:35:28.387506 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
16:35:28.387710 [debug] [MainThread]: Using postgres connection "master"
16:35:28.387864 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:35:28.471651 [debug] [MainThread]: SQL status: SELECT 1 in 0.08 seconds
16:35:28.473011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cc95d11-8688-481c-8e73-2165c9317d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44206df70>]}
16:35:28.473320 [debug] [MainThread]: On master: ROLLBACK
16:35:28.473622 [debug] [MainThread]: Using postgres connection "master"
16:35:28.473798 [debug] [MainThread]: On master: BEGIN
16:35:28.474109 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:35:28.474272 [debug] [MainThread]: On master: COMMIT
16:35:28.474416 [debug] [MainThread]: Using postgres connection "master"
16:35:28.474545 [debug] [MainThread]: On master: COMMIT
16:35:28.474780 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:35:28.474938 [debug] [MainThread]: On master: Close
16:35:28.475303 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
16:35:28.475661 [info ] [MainThread]: 
16:35:28.480026 [debug] [Thread-1  ]: Began running node seed.dbt_blog.city
16:35:28.480517 [info ] [Thread-1  ]: 1 of 2 START seed file wetube.city ............................................. [RUN]
16:35:28.480997 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.dbt_blog.city"
16:35:28.481159 [debug] [Thread-1  ]: Began compiling node seed.dbt_blog.city
16:35:28.481324 [debug] [Thread-1  ]: finished collecting timing info
16:35:28.481475 [debug] [Thread-1  ]: Began executing node seed.dbt_blog.city
16:35:28.528195 [debug] [Thread-1  ]: Using postgres connection "seed.dbt_blog.city"
16:35:28.528433 [debug] [Thread-1  ]: On seed.dbt_blog.city: BEGIN
16:35:28.528609 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:35:28.540318 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
16:35:28.540559 [debug] [Thread-1  ]: Using postgres connection "seed.dbt_blog.city"
16:35:28.540710 [debug] [Thread-1  ]: On seed.dbt_blog.city: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "seed.dbt_blog.city"} */
truncate table "get_dbt"."wetube"."city"
16:35:28.566501 [debug] [Thread-1  ]: Postgres adapter: Postgres error: cannot truncate a table referenced in a foreign key constraint
DETAIL:  Table "user_address" references "city".
HINT:  Truncate table "user_address" at the same time, or use TRUNCATE ... CASCADE.

16:35:28.566773 [debug] [Thread-1  ]: On seed.dbt_blog.city: ROLLBACK
16:35:28.567302 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro truncate_relation
16:35:28.567475 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
16:35:28.567682 [debug] [Thread-1  ]: finished collecting timing info
16:35:28.567850 [debug] [Thread-1  ]: On seed.dbt_blog.city: Close
16:35:28.568225 [debug] [Thread-1  ]: Database Error in seed city (seeds/city.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "user_address" references "city".
  HINT:  Truncate table "user_address" at the same time, or use TRUNCATE ... CASCADE.
16:35:28.568528 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc95d11-8688-481c-8e73-2165c9317d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4422a55b0>]}
16:35:28.568806 [error] [Thread-1  ]: 1 of 2 ERROR loading seed file wetube.city ..................................... [[31mERROR[0m in 0.09s]
16:35:28.569227 [debug] [Thread-1  ]: Finished running node seed.dbt_blog.city
16:35:28.569437 [debug] [Thread-1  ]: Began running node seed.dbt_blog.state
16:35:28.569805 [info ] [Thread-1  ]: 2 of 2 START seed file wetube.state ............................................ [RUN]
16:35:28.570225 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.dbt_blog.state"
16:35:28.570373 [debug] [Thread-1  ]: Began compiling node seed.dbt_blog.state
16:35:28.570516 [debug] [Thread-1  ]: finished collecting timing info
16:35:28.570660 [debug] [Thread-1  ]: Began executing node seed.dbt_blog.state
16:35:28.576620 [debug] [Thread-1  ]: Using postgres connection "seed.dbt_blog.state"
16:35:28.576787 [debug] [Thread-1  ]: On seed.dbt_blog.state: BEGIN
16:35:28.577036 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:35:28.586234 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
16:35:28.586457 [debug] [Thread-1  ]: Using postgres connection "seed.dbt_blog.state"
16:35:28.586603 [debug] [Thread-1  ]: On seed.dbt_blog.state: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "seed.dbt_blog.state"} */
truncate table "get_dbt"."wetube"."state"
16:35:28.588112 [debug] [Thread-1  ]: Postgres adapter: Postgres error: cannot truncate a table referenced in a foreign key constraint
DETAIL:  Table "user_address" references "state".
HINT:  Truncate table "user_address" at the same time, or use TRUNCATE ... CASCADE.

16:35:28.588302 [debug] [Thread-1  ]: On seed.dbt_blog.state: ROLLBACK
16:35:28.588624 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro truncate_relation
16:35:28.588768 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
16:35:28.588977 [debug] [Thread-1  ]: finished collecting timing info
16:35:28.589144 [debug] [Thread-1  ]: On seed.dbt_blog.state: Close
16:35:28.589517 [debug] [Thread-1  ]: Database Error in seed state (seeds/state.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "user_address" references "state".
  HINT:  Truncate table "user_address" at the same time, or use TRUNCATE ... CASCADE.
16:35:28.589792 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc95d11-8688-481c-8e73-2165c9317d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4422a51c0>]}
16:35:28.590081 [error] [Thread-1  ]: 2 of 2 ERROR loading seed file wetube.state .................................... [[31mERROR[0m in 0.02s]
16:35:28.590468 [debug] [Thread-1  ]: Finished running node seed.dbt_blog.state
16:35:28.595656 [debug] [MainThread]: Acquiring new postgres connection "master"
16:35:28.595856 [debug] [MainThread]: Using postgres connection "master"
16:35:28.595997 [debug] [MainThread]: On master: BEGIN
16:35:28.596124 [debug] [MainThread]: Opening a new connection, currently in state closed
16:35:28.616558 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
16:35:28.616828 [debug] [MainThread]: On master: COMMIT
16:35:28.616998 [debug] [MainThread]: Using postgres connection "master"
16:35:28.617149 [debug] [MainThread]: On master: COMMIT
16:35:28.617498 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:35:28.617723 [debug] [MainThread]: On master: Close
16:35:28.618228 [info ] [MainThread]: 
16:35:28.618526 [info ] [MainThread]: Finished running 2 seeds in 1.03s.
16:35:28.618800 [debug] [MainThread]: Connection 'master' was properly closed.
16:35:28.618963 [debug] [MainThread]: Connection 'seed.dbt_blog.state' was properly closed.
16:35:28.627489 [info ] [MainThread]: 
16:35:28.627903 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
16:35:28.628287 [info ] [MainThread]: 
16:35:28.628540 [error] [MainThread]: [33mDatabase Error in seed city (seeds/city.csv)[0m
16:35:28.628776 [error] [MainThread]:   cannot truncate a table referenced in a foreign key constraint
16:35:28.628989 [error] [MainThread]:   DETAIL:  Table "user_address" references "city".
16:35:28.629198 [error] [MainThread]:   HINT:  Truncate table "user_address" at the same time, or use TRUNCATE ... CASCADE.
16:35:28.629412 [info ] [MainThread]: 
16:35:28.629625 [error] [MainThread]: [33mDatabase Error in seed state (seeds/state.csv)[0m
16:35:28.629839 [error] [MainThread]:   cannot truncate a table referenced in a foreign key constraint
16:35:28.630049 [error] [MainThread]:   DETAIL:  Table "user_address" references "state".
16:35:28.630252 [error] [MainThread]:   HINT:  Truncate table "user_address" at the same time, or use TRUNCATE ... CASCADE.
16:35:28.630484 [info ] [MainThread]: 
16:35:28.630720 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
16:35:28.631055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44227c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44206d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4422133d0>]}


============================== 2022-07-15 23:05:49.760115 | e1090422-970c-4bfb-9c9b-e1ebffa9c424 ==============================
23:05:49.760153 [info ] [MainThread]: Running with dbt=1.1.1
23:05:49.761527 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
23:05:49.761710 [debug] [MainThread]: Tracking: tracking
23:05:49.809729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902c7f6af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902c7f6340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902c7f1550>]}
23:05:49.881795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
23:05:49.882226 [debug] [MainThread]: Partial parsing: added file: dbt_blog://seeds/account.csv
23:05:49.927566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1090422-970c-4bfb-9c9b-e1ebffa9c424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902c9940d0>]}
23:05:49.962812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1090422-970c-4bfb-9c9b-e1ebffa9c424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902bf0a6d0>]}
23:05:49.963169 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 3 seed files, 8 sources, 0 exposures, 0 metrics
23:05:49.963469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1090422-970c-4bfb-9c9b-e1ebffa9c424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902bf0a7c0>]}
23:05:49.965439 [info ] [MainThread]: 
23:05:49.965981 [debug] [MainThread]: Acquiring new postgres connection "master"
23:05:49.966940 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
23:05:49.980139 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
23:05:49.980467 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
23:05:49.980649 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:05:50.048723 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.07 seconds
23:05:50.050345 [debug] [ThreadPool]: On list_get_dbt: Close
23:05:50.051764 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
23:05:50.058836 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
23:05:50.059013 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
23:05:50.059155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
23:05:50.070068 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:05:50.070316 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
23:05:50.070559 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
23:05:50.079886 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
23:05:50.081608 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
23:05:50.081964 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
23:05:50.087031 [debug] [MainThread]: Using postgres connection "master"
23:05:50.087199 [debug] [MainThread]: On master: BEGIN
23:05:50.087337 [debug] [MainThread]: Opening a new connection, currently in state init
23:05:50.096877 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:05:50.097084 [debug] [MainThread]: Using postgres connection "master"
23:05:50.097227 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
23:05:50.138926 [debug] [MainThread]: SQL status: SELECT 1 in 0.04 seconds
23:05:50.140172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1090422-970c-4bfb-9c9b-e1ebffa9c424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902bf1b670>]}
23:05:50.140432 [debug] [MainThread]: On master: ROLLBACK
23:05:50.140695 [debug] [MainThread]: Using postgres connection "master"
23:05:50.140841 [debug] [MainThread]: On master: BEGIN
23:05:50.141191 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
23:05:50.141344 [debug] [MainThread]: On master: COMMIT
23:05:50.141475 [debug] [MainThread]: Using postgres connection "master"
23:05:50.141594 [debug] [MainThread]: On master: COMMIT
23:05:50.141802 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
23:05:50.141943 [debug] [MainThread]: On master: Close
23:05:50.142252 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
23:05:50.142480 [info ] [MainThread]: 
23:05:50.146521 [debug] [Thread-1  ]: Began running node seed.dbt_blog.account
23:05:50.146854 [info ] [Thread-1  ]: 1 of 3 START seed file wetube.account .......................................... [RUN]
23:05:50.147314 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.dbt_blog.account"
23:05:50.147468 [debug] [Thread-1  ]: Began compiling node seed.dbt_blog.account
23:05:50.147621 [debug] [Thread-1  ]: finished collecting timing info
23:05:50.147759 [debug] [Thread-1  ]: Began executing node seed.dbt_blog.account
23:05:50.187417 [debug] [Thread-1  ]: Using postgres connection "seed.dbt_blog.account"
23:05:50.187664 [debug] [Thread-1  ]: On seed.dbt_blog.account: BEGIN
23:05:50.187810 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:05:50.197118 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
23:05:50.197322 [debug] [Thread-1  ]: Using postgres connection "seed.dbt_blog.account"
23:05:50.197465 [debug] [Thread-1  ]: On seed.dbt_blog.account: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "seed.dbt_blog.account"} */
truncate table "get_dbt"."wetube"."account"
23:05:50.203402 [debug] [Thread-1  ]: Postgres adapter: Postgres error: cannot truncate a table referenced in a foreign key constraint
DETAIL:  Table "user_address" references "account".
HINT:  Truncate table "user_address" at the same time, or use TRUNCATE ... CASCADE.

23:05:50.203875 [debug] [Thread-1  ]: On seed.dbt_blog.account: ROLLBACK
23:05:50.204306 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro truncate_relation
23:05:50.204457 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
23:05:50.204656 [debug] [Thread-1  ]: finished collecting timing info
23:05:50.204817 [debug] [Thread-1  ]: On seed.dbt_blog.account: Close
23:05:50.205254 [debug] [Thread-1  ]: Database Error in seed account (seeds/account.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "user_address" references "account".
  HINT:  Truncate table "user_address" at the same time, or use TRUNCATE ... CASCADE.
23:05:50.205552 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1090422-970c-4bfb-9c9b-e1ebffa9c424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902c9f2a60>]}
23:05:50.205828 [error] [Thread-1  ]: 1 of 3 ERROR loading seed file wetube.account .................................. [[31mERROR[0m in 0.06s]
23:05:50.206241 [debug] [Thread-1  ]: Finished running node seed.dbt_blog.account
23:05:50.206443 [debug] [Thread-1  ]: Began running node seed.dbt_blog.city
23:05:50.206687 [info ] [Thread-1  ]: 2 of 3 START seed file wetube.city ............................................. [RUN]
23:05:50.207108 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.dbt_blog.city"
23:05:50.207264 [debug] [Thread-1  ]: Began compiling node seed.dbt_blog.city
23:05:50.207413 [debug] [Thread-1  ]: finished collecting timing info
23:05:50.207558 [debug] [Thread-1  ]: Began executing node seed.dbt_blog.city
23:05:50.212804 [debug] [Thread-1  ]: Using postgres connection "seed.dbt_blog.city"
23:05:50.212972 [debug] [Thread-1  ]: On seed.dbt_blog.city: BEGIN
23:05:50.213112 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:05:50.222771 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
23:05:50.222980 [debug] [Thread-1  ]: Using postgres connection "seed.dbt_blog.city"
23:05:50.223121 [debug] [Thread-1  ]: On seed.dbt_blog.city: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "seed.dbt_blog.city"} */
truncate table "get_dbt"."wetube"."city"
23:05:50.224639 [debug] [Thread-1  ]: Postgres adapter: Postgres error: cannot truncate a table referenced in a foreign key constraint
DETAIL:  Table "user_address" references "city".
HINT:  Truncate table "user_address" at the same time, or use TRUNCATE ... CASCADE.

23:05:50.224839 [debug] [Thread-1  ]: On seed.dbt_blog.city: ROLLBACK
23:05:50.225168 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro truncate_relation
23:05:50.225312 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
23:05:50.225508 [debug] [Thread-1  ]: finished collecting timing info
23:05:50.225668 [debug] [Thread-1  ]: On seed.dbt_blog.city: Close
23:05:50.226012 [debug] [Thread-1  ]: Database Error in seed city (seeds/city.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "user_address" references "city".
  HINT:  Truncate table "user_address" at the same time, or use TRUNCATE ... CASCADE.
23:05:50.226356 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1090422-970c-4bfb-9c9b-e1ebffa9c424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902cc4b3a0>]}
23:05:50.226775 [error] [Thread-1  ]: 2 of 3 ERROR loading seed file wetube.city ..................................... [[31mERROR[0m in 0.02s]
23:05:50.227345 [debug] [Thread-1  ]: Finished running node seed.dbt_blog.city
23:05:50.227577 [debug] [Thread-1  ]: Began running node seed.dbt_blog.state
23:05:50.227870 [info ] [Thread-1  ]: 3 of 3 START seed file wetube.state ............................................ [RUN]
23:05:50.228466 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.dbt_blog.state"
23:05:50.228642 [debug] [Thread-1  ]: Began compiling node seed.dbt_blog.state
23:05:50.228796 [debug] [Thread-1  ]: finished collecting timing info
23:05:50.228964 [debug] [Thread-1  ]: Began executing node seed.dbt_blog.state
23:05:50.235970 [debug] [Thread-1  ]: Using postgres connection "seed.dbt_blog.state"
23:05:50.236237 [debug] [Thread-1  ]: On seed.dbt_blog.state: BEGIN
23:05:50.236389 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:05:50.247409 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
23:05:50.247689 [debug] [Thread-1  ]: Using postgres connection "seed.dbt_blog.state"
23:05:50.247854 [debug] [Thread-1  ]: On seed.dbt_blog.state: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "seed.dbt_blog.state"} */
truncate table "get_dbt"."wetube"."state"
23:05:50.249330 [debug] [Thread-1  ]: Postgres adapter: Postgres error: cannot truncate a table referenced in a foreign key constraint
DETAIL:  Table "user_address" references "state".
HINT:  Truncate table "user_address" at the same time, or use TRUNCATE ... CASCADE.

23:05:50.249525 [debug] [Thread-1  ]: On seed.dbt_blog.state: ROLLBACK
23:05:50.249952 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro truncate_relation
23:05:50.250113 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
23:05:50.250322 [debug] [Thread-1  ]: finished collecting timing info
23:05:50.250488 [debug] [Thread-1  ]: On seed.dbt_blog.state: Close
23:05:50.250924 [debug] [Thread-1  ]: Database Error in seed state (seeds/state.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "user_address" references "state".
  HINT:  Truncate table "user_address" at the same time, or use TRUNCATE ... CASCADE.
23:05:50.251346 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1090422-970c-4bfb-9c9b-e1ebffa9c424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902c9fbc70>]}
23:05:50.251774 [error] [Thread-1  ]: 3 of 3 ERROR loading seed file wetube.state .................................... [[31mERROR[0m in 0.02s]
23:05:50.252396 [debug] [Thread-1  ]: Finished running node seed.dbt_blog.state
23:05:50.254308 [debug] [MainThread]: Acquiring new postgres connection "master"
23:05:50.254668 [debug] [MainThread]: Using postgres connection "master"
23:05:50.254829 [debug] [MainThread]: On master: BEGIN
23:05:50.254966 [debug] [MainThread]: Opening a new connection, currently in state closed
23:05:50.265462 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:05:50.265732 [debug] [MainThread]: On master: COMMIT
23:05:50.265887 [debug] [MainThread]: Using postgres connection "master"
23:05:50.266025 [debug] [MainThread]: On master: COMMIT
23:05:50.266249 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
23:05:50.266427 [debug] [MainThread]: On master: Close
23:05:50.267029 [info ] [MainThread]: 
23:05:50.267503 [info ] [MainThread]: Finished running 3 seeds in 0.30s.
23:05:50.267877 [debug] [MainThread]: Connection 'master' was properly closed.
23:05:50.268053 [debug] [MainThread]: Connection 'seed.dbt_blog.state' was properly closed.
23:05:50.276194 [info ] [MainThread]: 
23:05:50.276560 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
23:05:50.276859 [info ] [MainThread]: 
23:05:50.277100 [error] [MainThread]: [33mDatabase Error in seed account (seeds/account.csv)[0m
23:05:50.277335 [error] [MainThread]:   cannot truncate a table referenced in a foreign key constraint
23:05:50.277554 [error] [MainThread]:   DETAIL:  Table "user_address" references "account".
23:05:50.277772 [error] [MainThread]:   HINT:  Truncate table "user_address" at the same time, or use TRUNCATE ... CASCADE.
23:05:50.278002 [info ] [MainThread]: 
23:05:50.278241 [error] [MainThread]: [33mDatabase Error in seed city (seeds/city.csv)[0m
23:05:50.278485 [error] [MainThread]:   cannot truncate a table referenced in a foreign key constraint
23:05:50.278717 [error] [MainThread]:   DETAIL:  Table "user_address" references "city".
23:05:50.278943 [error] [MainThread]:   HINT:  Truncate table "user_address" at the same time, or use TRUNCATE ... CASCADE.
23:05:50.279231 [info ] [MainThread]: 
23:05:50.279565 [error] [MainThread]: [33mDatabase Error in seed state (seeds/state.csv)[0m
23:05:50.279821 [error] [MainThread]:   cannot truncate a table referenced in a foreign key constraint
23:05:50.280061 [error] [MainThread]:   DETAIL:  Table "user_address" references "state".
23:05:50.280290 [error] [MainThread]:   HINT:  Truncate table "user_address" at the same time, or use TRUNCATE ... CASCADE.
23:05:50.280579 [info ] [MainThread]: 
23:05:50.280839 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
23:05:50.281256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902c844be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902c91afa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902c7f1310>]}


============================== 2022-07-15 23:06:22.169836 | a23a256c-3b2a-4b88-9389-b33792649751 ==============================
23:06:22.169858 [info ] [MainThread]: Running with dbt=1.1.1
23:06:22.170599 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
23:06:22.170767 [debug] [MainThread]: Tracking: tracking
23:06:22.199365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8bfef5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8bfef5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8bfef3550>]}
23:06:22.265500 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 1 files changed.
23:06:22.266190 [debug] [MainThread]: Partial parsing: update schema file: dbt_blog://models/mart/schema.yml
23:06:22.266370 [debug] [MainThread]: Partial parsing: deleted file: dbt_blog://seeds/state.csv
23:06:22.266543 [debug] [MainThread]: Partial parsing: deleted file: dbt_blog://seeds/city.csv
23:06:22.288016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a23a256c-3b2a-4b88-9389-b33792649751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8c00840d0>]}
23:06:22.295604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a23a256c-3b2a-4b88-9389-b33792649751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8c000fe20>]}
23:06:22.295930 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 8 sources, 0 exposures, 0 metrics
23:06:22.296215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a23a256c-3b2a-4b88-9389-b33792649751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8c000fee0>]}
23:06:22.298074 [info ] [MainThread]: 
23:06:22.298619 [debug] [MainThread]: Acquiring new postgres connection "master"
23:06:22.299433 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
23:06:22.348681 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
23:06:22.348920 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
23:06:22.349082 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:06:22.384983 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.04 seconds
23:06:22.386850 [debug] [ThreadPool]: On list_get_dbt: Close
23:06:22.388164 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
23:06:22.395347 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
23:06:22.395602 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
23:06:22.395750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
23:06:22.405166 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:06:22.405386 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
23:06:22.405527 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
23:06:22.409195 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
23:06:22.410735 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
23:06:22.411015 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
23:06:22.415871 [debug] [MainThread]: Using postgres connection "master"
23:06:22.416040 [debug] [MainThread]: On master: BEGIN
23:06:22.416173 [debug] [MainThread]: Opening a new connection, currently in state init
23:06:22.425988 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:06:22.426196 [debug] [MainThread]: Using postgres connection "master"
23:06:22.426340 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
23:06:22.464883 [debug] [MainThread]: SQL status: SELECT 1 in 0.04 seconds
23:06:22.466135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a23a256c-3b2a-4b88-9389-b33792649751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8c0043790>]}
23:06:22.466420 [debug] [MainThread]: On master: ROLLBACK
23:06:22.466667 [debug] [MainThread]: Using postgres connection "master"
23:06:22.466795 [debug] [MainThread]: On master: BEGIN
23:06:22.467139 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
23:06:22.467283 [debug] [MainThread]: On master: COMMIT
23:06:22.467408 [debug] [MainThread]: Using postgres connection "master"
23:06:22.467519 [debug] [MainThread]: On master: COMMIT
23:06:22.467720 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
23:06:22.467858 [debug] [MainThread]: On master: Close
23:06:22.468170 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
23:06:22.468395 [info ] [MainThread]: 
23:06:22.473047 [debug] [Thread-1  ]: Began running node seed.dbt_blog.account
23:06:22.473353 [info ] [Thread-1  ]: 1 of 1 START seed file wetube.account .......................................... [RUN]
23:06:22.473798 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.dbt_blog.account"
23:06:22.473945 [debug] [Thread-1  ]: Began compiling node seed.dbt_blog.account
23:06:22.474093 [debug] [Thread-1  ]: finished collecting timing info
23:06:22.474229 [debug] [Thread-1  ]: Began executing node seed.dbt_blog.account
23:06:22.508410 [debug] [Thread-1  ]: Using postgres connection "seed.dbt_blog.account"
23:06:22.508629 [debug] [Thread-1  ]: On seed.dbt_blog.account: BEGIN
23:06:22.508770 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:06:22.518817 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
23:06:22.519171 [debug] [Thread-1  ]: Using postgres connection "seed.dbt_blog.account"
23:06:22.519347 [debug] [Thread-1  ]: On seed.dbt_blog.account: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "seed.dbt_blog.account"} */
truncate table "get_dbt"."wetube"."account"
23:06:22.520663 [debug] [Thread-1  ]: Postgres adapter: Postgres error: cannot truncate a table referenced in a foreign key constraint
DETAIL:  Table "user_address" references "account".
HINT:  Truncate table "user_address" at the same time, or use TRUNCATE ... CASCADE.

23:06:22.521174 [debug] [Thread-1  ]: On seed.dbt_blog.account: ROLLBACK
23:06:22.521591 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro truncate_relation
23:06:22.521739 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
23:06:22.521943 [debug] [Thread-1  ]: finished collecting timing info
23:06:22.522104 [debug] [Thread-1  ]: On seed.dbt_blog.account: Close
23:06:22.522469 [debug] [Thread-1  ]: Database Error in seed account (seeds/account.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "user_address" references "account".
  HINT:  Truncate table "user_address" at the same time, or use TRUNCATE ... CASCADE.
23:06:22.522763 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a23a256c-3b2a-4b88-9389-b33792649751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8c0220880>]}
23:06:22.523050 [error] [Thread-1  ]: 1 of 1 ERROR loading seed file wetube.account .................................. [[31mERROR[0m in 0.05s]
23:06:22.523482 [debug] [Thread-1  ]: Finished running node seed.dbt_blog.account
23:06:22.524603 [debug] [MainThread]: Acquiring new postgres connection "master"
23:06:22.524805 [debug] [MainThread]: Using postgres connection "master"
23:06:22.524946 [debug] [MainThread]: On master: BEGIN
23:06:22.525073 [debug] [MainThread]: Opening a new connection, currently in state closed
23:06:22.534874 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:06:22.535281 [debug] [MainThread]: On master: COMMIT
23:06:22.535437 [debug] [MainThread]: Using postgres connection "master"
23:06:22.535574 [debug] [MainThread]: On master: COMMIT
23:06:22.535842 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
23:06:22.536050 [debug] [MainThread]: On master: Close
23:06:22.536460 [info ] [MainThread]: 
23:06:22.536731 [info ] [MainThread]: Finished running 1 seed in 0.24s.
23:06:22.536983 [debug] [MainThread]: Connection 'master' was properly closed.
23:06:22.537274 [debug] [MainThread]: Connection 'seed.dbt_blog.account' was properly closed.
23:06:22.544140 [info ] [MainThread]: 
23:06:22.544478 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
23:06:22.544759 [info ] [MainThread]: 
23:06:22.544993 [error] [MainThread]: [33mDatabase Error in seed account (seeds/account.csv)[0m
23:06:22.545225 [error] [MainThread]:   cannot truncate a table referenced in a foreign key constraint
23:06:22.545474 [error] [MainThread]:   DETAIL:  Table "user_address" references "account".
23:06:22.545683 [error] [MainThread]:   HINT:  Truncate table "user_address" at the same time, or use TRUNCATE ... CASCADE.
23:06:22.545905 [info ] [MainThread]: 
23:06:22.546126 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
23:06:22.546453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8bff50c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8c003fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8bf9bd910>]}


============================== 2022-07-21 01:58:44.824358 | b680e75f-e6cc-4e1d-bba9-8da06d354703 ==============================
01:58:44.824379 [info ] [MainThread]: Running with dbt=1.1.1
01:58:44.825631 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
01:58:44.825808 [debug] [MainThread]: Tracking: tracking
01:58:45.200976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f26f6af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f26f6340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f26f1550>]}
01:58:45.232627 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
01:58:45.233003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b680e75f-e6cc-4e1d-bba9-8da06d354703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f26f12e0>]}
01:58:45.240267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f274f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f274fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f274f8e0>]}


============================== 2022-07-21 02:01:20.147863 | de128bd4-66f8-47c0-a09b-71da9023ad44 ==============================
02:01:20.147888 [info ] [MainThread]: Running with dbt=1.1.1
02:01:20.148878 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:01:20.149031 [debug] [MainThread]: Tracking: tracking
02:01:20.171412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf766f1ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf766f1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf76730190>]}
02:01:20.205982 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
02:01:20.206368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'de128bd4-66f8-47c0-a09b-71da9023ad44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf76752760>]}
02:01:20.213948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf766f76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf767508e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf76750850>]}


============================== 2022-07-21 02:02:50.596587 | f63a15b7-8d87-4387-b491-fa71c385c91f ==============================
02:02:50.596625 [info ] [MainThread]: Running with dbt=1.1.1
02:02:50.597770 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:02:50.597920 [debug] [MainThread]: Tracking: tracking
02:02:50.622475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad20ecdaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad20ecd340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad20ec8550>]}
02:02:50.656514 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
02:02:50.656920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f63a15b7-8d87-4387-b491-fa71c385c91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad21052790>]}
02:02:50.665085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad21050be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad210503d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad21050430>]}


============================== 2022-07-21 02:03:26.912609 | 132f54a4-5ea6-4c25-aae2-969ba70ea3f0 ==============================
02:03:26.912639 [info ] [MainThread]: Running with dbt=1.1.1
02:03:26.913662 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:03:26.913878 [debug] [MainThread]: Tracking: tracking
02:03:26.942311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f50ef4520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f50ef4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f50ef1550>]}
02:03:26.976375 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
02:03:26.976752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '132f54a4-5ea6-4c25-aae2-969ba70ea3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f51052760>]}
02:03:27.011272 [debug] [MainThread]: Parsing macros/catalog.sql
02:03:27.016617 [debug] [MainThread]: Parsing macros/relations.sql
02:03:27.018487 [debug] [MainThread]: Parsing macros/adapters.sql
02:03:27.047801 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
02:03:27.049587 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
02:03:27.053619 [debug] [MainThread]: Parsing macros/materializations/configs.sql
02:03:27.055922 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
02:03:27.057644 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
02:03:27.075140 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
02:03:27.088191 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
02:03:27.099948 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
02:03:27.104608 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
02:03:27.106507 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
02:03:27.108402 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
02:03:27.113044 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
02:03:27.130192 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
02:03:27.132430 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
02:03:27.143240 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
02:03:27.158862 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
02:03:27.166638 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
02:03:27.169631 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
02:03:27.176844 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
02:03:27.178108 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
02:03:27.180926 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
02:03:27.183326 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
02:03:27.189598 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
02:03:27.206520 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
02:03:27.208015 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
02:03:27.210433 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
02:03:27.211945 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
02:03:27.212919 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
02:03:27.213725 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
02:03:27.214518 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
02:03:27.215860 [debug] [MainThread]: Parsing macros/etc/statement.sql
02:03:27.220300 [debug] [MainThread]: Parsing macros/etc/datetime.sql
02:03:27.228906 [debug] [MainThread]: Parsing macros/adapters/schema.sql
02:03:27.231137 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
02:03:27.233986 [debug] [MainThread]: Parsing macros/adapters/relation.sql
02:03:27.271941 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
02:03:27.275914 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
02:03:27.281921 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
02:03:27.291841 [debug] [MainThread]: Parsing macros/adapters/columns.sql
02:03:27.305170 [debug] [MainThread]: Parsing tests/generic/builtin.sql
02:03:27.507561 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
02:03:27.522675 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
02:03:27.526345 [debug] [MainThread]: 1699: static parser successfully parsed mart/number_of_subs_by_channel.sql
02:03:27.617269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '132f54a4-5ea6-4c25-aae2-969ba70ea3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f50ad4220>]}
02:03:27.624913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '132f54a4-5ea6-4c25-aae2-969ba70ea3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f51136fd0>]}
02:03:27.625286 [info ] [MainThread]: Found 3 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
02:03:27.625556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '132f54a4-5ea6-4c25-aae2-969ba70ea3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5108caf0>]}
02:03:27.627243 [info ] [MainThread]: 
02:03:27.627706 [debug] [MainThread]: Acquiring new postgres connection "master"
02:03:27.628542 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
02:03:27.639293 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
02:03:27.639453 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
02:03:27.639580 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:03:28.105608 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.47 seconds
02:03:28.107207 [debug] [ThreadPool]: On list_get_dbt: Close
02:03:28.108517 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
02:03:28.115368 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
02:03:28.115539 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
02:03:28.115677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
02:03:28.131176 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
02:03:28.131387 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
02:03:28.131524 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
02:03:28.164338 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.03 seconds
02:03:28.165949 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
02:03:28.166248 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
02:03:28.171211 [debug] [MainThread]: Using postgres connection "master"
02:03:28.171407 [debug] [MainThread]: On master: BEGIN
02:03:28.171545 [debug] [MainThread]: Opening a new connection, currently in state init
02:03:28.182021 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
02:03:28.182242 [debug] [MainThread]: Using postgres connection "master"
02:03:28.182399 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
02:03:28.301771 [debug] [MainThread]: SQL status: SELECT 1 in 0.12 seconds
02:03:28.303177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '132f54a4-5ea6-4c25-aae2-969ba70ea3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f50ad45e0>]}
02:03:28.303493 [debug] [MainThread]: On master: ROLLBACK
02:03:28.303756 [debug] [MainThread]: Using postgres connection "master"
02:03:28.303899 [debug] [MainThread]: On master: BEGIN
02:03:28.304227 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
02:03:28.304420 [debug] [MainThread]: On master: COMMIT
02:03:28.304578 [debug] [MainThread]: Using postgres connection "master"
02:03:28.304721 [debug] [MainThread]: On master: COMMIT
02:03:28.304962 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
02:03:28.305127 [debug] [MainThread]: On master: Close
02:03:28.305573 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
02:03:28.305854 [info ] [MainThread]: 
02:03:28.309970 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
02:03:28.310277 [info ] [Thread-1  ]: 1 of 3 START table model wetube.my_first_dbt_model ............................. [RUN]
02:03:28.310914 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
02:03:28.311105 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
02:03:28.311276 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
02:03:28.314167 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
02:03:28.315272 [debug] [Thread-1  ]: finished collecting timing info
02:03:28.315604 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
02:03:28.365399 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
02:03:28.366802 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
02:03:28.367145 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
02:03:28.367315 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:03:28.377660 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
02:03:28.377914 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
02:03:28.378077 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
02:03:28.428560 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.05 seconds
02:03:28.436366 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
02:03:28.436596 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
02:03:28.441966 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
02:03:28.456153 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
02:03:28.456355 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
02:03:28.456492 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
02:03:28.459124 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
02:03:28.464344 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
02:03:28.464506 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
02:03:28.464933 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
02:03:28.466145 [debug] [Thread-1  ]: finished collecting timing info
02:03:28.466318 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
02:03:28.466703 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '132f54a4-5ea6-4c25-aae2-969ba70ea3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f512abdf0>]}
02:03:28.467063 [info ] [Thread-1  ]: 1 of 3 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.16s]
02:03:28.467461 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
02:03:28.467649 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
02:03:28.467890 [info ] [Thread-1  ]: 2 of 3 START table model wetube.number_of_subs_by_channel ...................... [RUN]
02:03:28.468353 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
02:03:28.468561 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
02:03:28.468711 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
02:03:28.472129 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
02:03:28.472960 [debug] [Thread-1  ]: finished collecting timing info
02:03:28.473139 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
02:03:28.476055 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
02:03:28.476664 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
02:03:28.476816 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
02:03:28.476945 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:03:28.486315 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
02:03:28.486529 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
02:03:28.486741 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source as source_channel_subs as (

    select id_subscriber from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
),

select * from number_of_subs_by_channel

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
02:03:28.488185 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "source_channel_subs"
LINE 12: source as source_channel_subs as (
                   ^

02:03:28.488370 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: ROLLBACK
02:03:28.488724 [debug] [Thread-1  ]: finished collecting timing info
02:03:28.488904 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
02:03:28.489321 [debug] [Thread-1  ]: Database Error in model number_of_subs_by_channel (models/mart/number_of_subs_by_channel.sql)
  syntax error at or near "source_channel_subs"
  LINE 12: source as source_channel_subs as (
                     ^
  compiled SQL at target/run/dbt_blog/models/mart/number_of_subs_by_channel.sql
02:03:28.489702 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '132f54a4-5ea6-4c25-aae2-969ba70ea3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f512bd490>]}
02:03:28.490164 [error] [Thread-1  ]: 2 of 3 ERROR creating table model wetube.number_of_subs_by_channel ............. [[31mERROR[0m in 0.02s]
02:03:28.490712 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
02:03:28.490949 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
02:03:28.491331 [info ] [Thread-1  ]: 3 of 3 START view model wetube.my_second_dbt_model ............................. [RUN]
02:03:28.491790 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
02:03:28.491969 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
02:03:28.492227 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
02:03:28.494890 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
02:03:28.495540 [debug] [Thread-1  ]: finished collecting timing info
02:03:28.495723 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
02:03:28.522370 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
02:03:28.523022 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
02:03:28.523185 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
02:03:28.523321 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:03:28.533317 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
02:03:28.533754 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
02:03:28.534059 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
02:03:28.545945 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
02:03:28.549130 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
02:03:28.549350 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
02:03:28.549969 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
02:03:28.551505 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
02:03:28.551677 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
02:03:28.551835 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
02:03:28.553341 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
02:03:28.555194 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
02:03:28.555352 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
02:03:28.558549 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
02:03:28.559748 [debug] [Thread-1  ]: finished collecting timing info
02:03:28.559929 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
02:03:28.560328 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '132f54a4-5ea6-4c25-aae2-969ba70ea3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f51288be0>]}
02:03:28.560685 [info ] [Thread-1  ]: 3 of 3 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
02:03:28.561232 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
02:03:28.563033 [debug] [MainThread]: Acquiring new postgres connection "master"
02:03:28.563230 [debug] [MainThread]: Using postgres connection "master"
02:03:28.563371 [debug] [MainThread]: On master: BEGIN
02:03:28.563498 [debug] [MainThread]: Opening a new connection, currently in state closed
02:03:28.572740 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
02:03:28.572961 [debug] [MainThread]: On master: COMMIT
02:03:28.573108 [debug] [MainThread]: Using postgres connection "master"
02:03:28.573241 [debug] [MainThread]: On master: COMMIT
02:03:28.573498 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
02:03:28.573667 [debug] [MainThread]: On master: Close
02:03:28.574155 [info ] [MainThread]: 
02:03:28.574459 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0.95s.
02:03:28.574740 [debug] [MainThread]: Connection 'master' was properly closed.
02:03:28.574877 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
02:03:28.581840 [info ] [MainThread]: 
02:03:28.582142 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
02:03:28.582429 [info ] [MainThread]: 
02:03:28.582682 [error] [MainThread]: [33mDatabase Error in model number_of_subs_by_channel (models/mart/number_of_subs_by_channel.sql)[0m
02:03:28.583013 [error] [MainThread]:   syntax error at or near "source_channel_subs"
02:03:28.583296 [error] [MainThread]:   LINE 12: source as source_channel_subs as (
02:03:28.583532 [error] [MainThread]:                      ^
02:03:28.583745 [error] [MainThread]:   compiled SQL at target/run/dbt_blog/models/mart/number_of_subs_by_channel.sql
02:03:28.583976 [info ] [MainThread]: 
02:03:28.584270 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
02:03:28.584638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f50ad4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f51050fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f51359040>]}


============================== 2022-07-21 02:04:36.930320 | e9b00712-0df1-4265-8041-9cb8a8bbda1d ==============================
02:04:36.930357 [info ] [MainThread]: Running with dbt=1.1.1
02:04:36.931378 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:04:36.931535 [debug] [MainThread]: Tracking: tracking
02:04:36.950307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b3f7335b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b3f733d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b3f7324f0>]}
02:04:37.018588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:04:37.019122 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/number_of_subs_by_channel.sql
02:04:37.037789 [debug] [MainThread]: 1699: static parser successfully parsed mart/number_of_subs_by_channel.sql
02:04:37.123151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9b00712-0df1-4265-8041-9cb8a8bbda1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b3f71f130>]}
02:04:37.131122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9b00712-0df1-4265-8041-9cb8a8bbda1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b3f7bf910>]}
02:04:37.131571 [info ] [MainThread]: Found 3 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
02:04:37.131913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9b00712-0df1-4265-8041-9cb8a8bbda1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b3f943460>]}
02:04:37.133699 [info ] [MainThread]: 
02:04:37.134188 [debug] [MainThread]: Acquiring new postgres connection "master"
02:04:37.135064 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
02:04:37.146812 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
02:04:37.147005 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
02:04:37.147150 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:04:37.185848 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.04 seconds
02:04:37.187543 [debug] [ThreadPool]: On list_get_dbt: Close
02:04:37.188759 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
02:04:37.196017 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
02:04:37.196215 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
02:04:37.196359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
02:04:37.205523 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
02:04:37.205731 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
02:04:37.205883 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
02:04:37.210112 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
02:04:37.211714 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
02:04:37.211984 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
02:04:37.216969 [debug] [MainThread]: Using postgres connection "master"
02:04:37.217148 [debug] [MainThread]: On master: BEGIN
02:04:37.217288 [debug] [MainThread]: Opening a new connection, currently in state init
02:04:37.226658 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
02:04:37.226877 [debug] [MainThread]: Using postgres connection "master"
02:04:37.227022 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
02:04:37.271260 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
02:04:37.272667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9b00712-0df1-4265-8041-9cb8a8bbda1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b3f7bf820>]}
02:04:37.272963 [debug] [MainThread]: On master: ROLLBACK
02:04:37.273245 [debug] [MainThread]: Using postgres connection "master"
02:04:37.273388 [debug] [MainThread]: On master: BEGIN
02:04:37.273740 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
02:04:37.273899 [debug] [MainThread]: On master: COMMIT
02:04:37.274032 [debug] [MainThread]: Using postgres connection "master"
02:04:37.274151 [debug] [MainThread]: On master: COMMIT
02:04:37.274373 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
02:04:37.274539 [debug] [MainThread]: On master: Close
02:04:37.274905 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
02:04:37.275139 [info ] [MainThread]: 
02:04:37.279126 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
02:04:37.279393 [info ] [Thread-1  ]: 1 of 3 START table model wetube.my_first_dbt_model ............................. [RUN]
02:04:37.279820 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
02:04:37.279957 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
02:04:37.280086 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
02:04:37.282237 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
02:04:37.282682 [debug] [Thread-1  ]: finished collecting timing info
02:04:37.282856 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
02:04:37.320136 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
02:04:37.320785 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
02:04:37.320945 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
02:04:37.321084 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:04:37.330485 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
02:04:37.330763 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
02:04:37.330929 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
02:04:37.335845 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
02:04:37.342989 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
02:04:37.343181 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
02:04:37.345099 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
02:04:37.347679 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
02:04:37.347850 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
02:04:37.348376 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
02:04:37.361457 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
02:04:37.361640 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
02:04:37.361776 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
02:04:37.362393 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
02:04:37.367580 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
02:04:37.367746 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
02:04:37.383666 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
02:04:37.384925 [debug] [Thread-1  ]: finished collecting timing info
02:04:37.385101 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
02:04:37.385499 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9b00712-0df1-4265-8041-9cb8a8bbda1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b3fc1eee0>]}
02:04:37.385855 [info ] [Thread-1  ]: 1 of 3 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
02:04:37.386249 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
02:04:37.386432 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
02:04:37.386854 [info ] [Thread-1  ]: 2 of 3 START table model wetube.number_of_subs_by_channel ...................... [RUN]
02:04:37.387269 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
02:04:37.387415 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
02:04:37.387551 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
02:04:37.390524 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
02:04:37.390990 [debug] [Thread-1  ]: finished collecting timing info
02:04:37.391147 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
02:04:37.393805 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
02:04:37.394238 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
02:04:37.394377 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
02:04:37.394499 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:04:37.403097 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
02:04:37.403344 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
02:04:37.403494 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select id_subscriber from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
),

select * from number_of_subs_by_channel

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
02:04:37.404390 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 30: select * from number_of_subs_by_channel
         ^

02:04:37.404566 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: ROLLBACK
02:04:37.404918 [debug] [Thread-1  ]: finished collecting timing info
02:04:37.405087 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
02:04:37.405636 [debug] [Thread-1  ]: Database Error in model number_of_subs_by_channel (models/mart/number_of_subs_by_channel.sql)
  syntax error at or near "select"
  LINE 30: select * from number_of_subs_by_channel
           ^
  compiled SQL at target/run/dbt_blog/models/mart/number_of_subs_by_channel.sql
02:04:37.405952 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9b00712-0df1-4265-8041-9cb8a8bbda1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b3fc4f250>]}
02:04:37.406308 [error] [Thread-1  ]: 2 of 3 ERROR creating table model wetube.number_of_subs_by_channel ............. [[31mERROR[0m in 0.02s]
02:04:37.406822 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
02:04:37.407015 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
02:04:37.407499 [info ] [Thread-1  ]: 3 of 3 START view model wetube.my_second_dbt_model ............................. [RUN]
02:04:37.408186 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
02:04:37.408343 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
02:04:37.408503 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
02:04:37.411136 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
02:04:37.411744 [debug] [Thread-1  ]: finished collecting timing info
02:04:37.411954 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
02:04:37.436227 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
02:04:37.436843 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
02:04:37.437005 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
02:04:37.437141 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:04:37.447844 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
02:04:37.448514 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
02:04:37.448968 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
02:04:37.453929 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
02:04:37.457180 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
02:04:37.457405 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
02:04:37.457994 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
02:04:37.459482 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
02:04:37.459652 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
02:04:37.459796 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
02:04:37.460378 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
02:04:37.462117 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
02:04:37.462273 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
02:04:37.462628 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
02:04:37.463769 [debug] [Thread-1  ]: finished collecting timing info
02:04:37.464008 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
02:04:37.464447 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9b00712-0df1-4265-8041-9cb8a8bbda1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b3f63e400>]}
02:04:37.464821 [info ] [Thread-1  ]: 3 of 3 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
02:04:37.465239 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
02:04:37.466227 [debug] [MainThread]: Acquiring new postgres connection "master"
02:04:37.466421 [debug] [MainThread]: Using postgres connection "master"
02:04:37.466564 [debug] [MainThread]: On master: BEGIN
02:04:37.466695 [debug] [MainThread]: Opening a new connection, currently in state closed
02:04:37.475728 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
02:04:37.475949 [debug] [MainThread]: On master: COMMIT
02:04:37.476099 [debug] [MainThread]: Using postgres connection "master"
02:04:37.476233 [debug] [MainThread]: On master: COMMIT
02:04:37.476479 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
02:04:37.476646 [debug] [MainThread]: On master: Close
02:04:37.477047 [info ] [MainThread]: 
02:04:37.477311 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0.34s.
02:04:37.477565 [debug] [MainThread]: Connection 'master' was properly closed.
02:04:37.477696 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
02:04:37.484521 [info ] [MainThread]: 
02:04:37.484813 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
02:04:37.485089 [info ] [MainThread]: 
02:04:37.485360 [error] [MainThread]: [33mDatabase Error in model number_of_subs_by_channel (models/mart/number_of_subs_by_channel.sql)[0m
02:04:37.485599 [error] [MainThread]:   syntax error at or near "select"
02:04:37.485818 [error] [MainThread]:   LINE 30: select * from number_of_subs_by_channel
02:04:37.486028 [error] [MainThread]:            ^
02:04:37.486238 [error] [MainThread]:   compiled SQL at target/run/dbt_blog/models/mart/number_of_subs_by_channel.sql
02:04:37.486522 [info ] [MainThread]: 
02:04:37.486820 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
02:04:37.487180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b3fc76220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b3fc76430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b3fc761f0>]}


============================== 2022-07-21 02:05:23.912145 | 0137dad3-5e3c-4d94-8a4c-b748e6910d7f ==============================
02:05:23.912170 [info ] [MainThread]: Running with dbt=1.1.1
02:05:23.912976 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:05:23.913154 [debug] [MainThread]: Tracking: tracking
02:05:23.938807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf74db6af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf74db6340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf74db4550>]}
02:05:24.003300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:05:24.003867 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/number_of_subs_by_channel.sql
02:05:24.023668 [debug] [MainThread]: 1699: static parser successfully parsed mart/number_of_subs_by_channel.sql
02:05:24.156972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0137dad3-5e3c-4d94-8a4c-b748e6910d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf74da0130>]}
02:05:24.164892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0137dad3-5e3c-4d94-8a4c-b748e6910d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf74f82f10>]}
02:05:24.165324 [info ] [MainThread]: Found 3 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
02:05:24.165663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0137dad3-5e3c-4d94-8a4c-b748e6910d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf74fc4430>]}
02:05:24.167491 [info ] [MainThread]: 
02:05:24.167995 [debug] [MainThread]: Acquiring new postgres connection "master"
02:05:24.168906 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
02:05:24.181846 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
02:05:24.182081 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
02:05:24.182240 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:05:24.215875 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.03 seconds
02:05:24.217448 [debug] [ThreadPool]: On list_get_dbt: Close
02:05:24.218685 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
02:05:24.225786 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
02:05:24.225983 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
02:05:24.226127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
02:05:24.235587 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
02:05:24.235805 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
02:05:24.235954 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
02:05:24.239405 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
02:05:24.241110 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
02:05:24.241404 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
02:05:24.246400 [debug] [MainThread]: Using postgres connection "master"
02:05:24.246584 [debug] [MainThread]: On master: BEGIN
02:05:24.246726 [debug] [MainThread]: Opening a new connection, currently in state init
02:05:24.256317 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
02:05:24.256537 [debug] [MainThread]: Using postgres connection "master"
02:05:24.256688 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
02:05:24.297004 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
02:05:24.298278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0137dad3-5e3c-4d94-8a4c-b748e6910d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf74f10700>]}
02:05:24.298593 [debug] [MainThread]: On master: ROLLBACK
02:05:24.298860 [debug] [MainThread]: Using postgres connection "master"
02:05:24.298993 [debug] [MainThread]: On master: BEGIN
02:05:24.299296 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
02:05:24.299451 [debug] [MainThread]: On master: COMMIT
02:05:24.299581 [debug] [MainThread]: Using postgres connection "master"
02:05:24.299699 [debug] [MainThread]: On master: COMMIT
02:05:24.299937 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
02:05:24.300097 [debug] [MainThread]: On master: Close
02:05:24.300417 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
02:05:24.300648 [info ] [MainThread]: 
02:05:24.305043 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
02:05:24.305321 [info ] [Thread-1  ]: 1 of 3 START table model wetube.my_first_dbt_model ............................. [RUN]
02:05:24.305748 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
02:05:24.305895 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
02:05:24.306034 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
02:05:24.308377 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
02:05:24.308820 [debug] [Thread-1  ]: finished collecting timing info
02:05:24.308968 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
02:05:24.337947 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
02:05:24.338506 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
02:05:24.338634 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
02:05:24.338739 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:05:24.348086 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
02:05:24.348360 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
02:05:24.348516 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
02:05:24.352635 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
02:05:24.360887 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
02:05:24.361106 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
02:05:24.361690 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
02:05:24.364253 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
02:05:24.364416 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
02:05:24.364967 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
02:05:24.378465 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
02:05:24.378709 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
02:05:24.378882 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
02:05:24.379511 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
02:05:24.384838 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
02:05:24.385006 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
02:05:24.387048 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
02:05:24.388318 [debug] [Thread-1  ]: finished collecting timing info
02:05:24.388503 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
02:05:24.388918 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0137dad3-5e3c-4d94-8a4c-b748e6910d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf753a1eb0>]}
02:05:24.389358 [info ] [Thread-1  ]: 1 of 3 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.08s]
02:05:24.389794 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
02:05:24.389993 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
02:05:24.390416 [info ] [Thread-1  ]: 2 of 3 START table model wetube.number_of_subs_by_channel ...................... [RUN]
02:05:24.390901 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
02:05:24.391061 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
02:05:24.391206 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
02:05:24.394357 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
02:05:24.394975 [debug] [Thread-1  ]: finished collecting timing info
02:05:24.395180 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
02:05:24.398430 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
02:05:24.399081 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
02:05:24.399254 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
02:05:24.399395 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:05:24.411018 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
02:05:24.411278 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
02:05:24.411431 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select id_subscriber from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
02:05:24.416910 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "id_channel" specified in USING clause does not exist in left table

02:05:24.417215 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: ROLLBACK
02:05:24.417615 [debug] [Thread-1  ]: finished collecting timing info
02:05:24.417861 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
02:05:24.418326 [debug] [Thread-1  ]: Database Error in model number_of_subs_by_channel (models/mart/number_of_subs_by_channel.sql)
  column "id_channel" specified in USING clause does not exist in left table
  compiled SQL at target/run/dbt_blog/models/mart/number_of_subs_by_channel.sql
02:05:24.418640 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0137dad3-5e3c-4d94-8a4c-b748e6910d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf75409220>]}
02:05:24.419129 [error] [Thread-1  ]: 2 of 3 ERROR creating table model wetube.number_of_subs_by_channel ............. [[31mERROR[0m in 0.03s]
02:05:24.419601 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
02:05:24.419811 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
02:05:24.420211 [info ] [Thread-1  ]: 3 of 3 START view model wetube.my_second_dbt_model ............................. [RUN]
02:05:24.420793 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
02:05:24.420991 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
02:05:24.421169 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
02:05:24.424634 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
02:05:24.425391 [debug] [Thread-1  ]: finished collecting timing info
02:05:24.425586 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
02:05:24.450976 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
02:05:24.451903 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
02:05:24.452188 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
02:05:24.452355 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:05:24.462437 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
02:05:24.462705 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
02:05:24.462863 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
02:05:24.467053 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
02:05:24.469914 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
02:05:24.470136 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
02:05:24.470885 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
02:05:24.472931 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
02:05:24.473176 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
02:05:24.473323 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
02:05:24.475149 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
02:05:24.477455 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
02:05:24.477770 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
02:05:24.478316 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
02:05:24.479640 [debug] [Thread-1  ]: finished collecting timing info
02:05:24.479866 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
02:05:24.480400 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0137dad3-5e3c-4d94-8a4c-b748e6910d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf74f12a00>]}
02:05:24.480805 [info ] [Thread-1  ]: 3 of 3 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
02:05:24.481238 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
02:05:24.482472 [debug] [MainThread]: Acquiring new postgres connection "master"
02:05:24.482675 [debug] [MainThread]: Using postgres connection "master"
02:05:24.482824 [debug] [MainThread]: On master: BEGIN
02:05:24.482958 [debug] [MainThread]: Opening a new connection, currently in state closed
02:05:24.491928 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
02:05:24.492154 [debug] [MainThread]: On master: COMMIT
02:05:24.492308 [debug] [MainThread]: Using postgres connection "master"
02:05:24.492445 [debug] [MainThread]: On master: COMMIT
02:05:24.492710 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
02:05:24.492901 [debug] [MainThread]: On master: Close
02:05:24.493323 [info ] [MainThread]: 
02:05:24.493592 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0.33s.
02:05:24.493908 [debug] [MainThread]: Connection 'master' was properly closed.
02:05:24.494162 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
02:05:24.502340 [info ] [MainThread]: 
02:05:24.502806 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
02:05:24.503096 [info ] [MainThread]: 
02:05:24.503406 [error] [MainThread]: [33mDatabase Error in model number_of_subs_by_channel (models/mart/number_of_subs_by_channel.sql)[0m
02:05:24.503690 [error] [MainThread]:   column "id_channel" specified in USING clause does not exist in left table
02:05:24.503913 [error] [MainThread]:   compiled SQL at target/run/dbt_blog/models/mart/number_of_subs_by_channel.sql
02:05:24.504147 [info ] [MainThread]: 
02:05:24.504376 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
02:05:24.504710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf7542b1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf7542b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf7542b8b0>]}


============================== 2022-07-21 02:06:17.260072 | 0a67c5cb-c3a4-4665-ab4c-57387fa3c5c9 ==============================
02:06:17.260095 [info ] [MainThread]: Running with dbt=1.1.1
02:06:17.261187 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:06:17.261388 [debug] [MainThread]: Tracking: tracking
02:06:17.281708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff1ef6af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff1ef6340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff1ef4550>]}
02:06:17.346705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:06:17.347246 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/number_of_subs_by_channel.sql
02:06:17.364798 [debug] [MainThread]: 1699: static parser successfully parsed mart/number_of_subs_by_channel.sql
02:06:17.446468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a67c5cb-c3a4-4665-ab4c-57387fa3c5c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff1ee0130>]}
02:06:17.453830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a67c5cb-c3a4-4665-ab4c-57387fa3c5c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff1fc2f10>]}
02:06:17.454173 [info ] [MainThread]: Found 3 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
02:06:17.454481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a67c5cb-c3a4-4665-ab4c-57387fa3c5c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff2004430>]}
02:06:17.456228 [info ] [MainThread]: 
02:06:17.456710 [debug] [MainThread]: Acquiring new postgres connection "master"
02:06:17.457579 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
02:06:17.470016 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
02:06:17.470245 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
02:06:17.470401 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:06:17.510314 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.04 seconds
02:06:17.511992 [debug] [ThreadPool]: On list_get_dbt: Close
02:06:17.513252 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
02:06:17.520355 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
02:06:17.520551 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
02:06:17.520693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
02:06:17.529840 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
02:06:17.530053 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
02:06:17.530201 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
02:06:17.533833 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
02:06:17.535478 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
02:06:17.535755 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
02:06:17.540670 [debug] [MainThread]: Using postgres connection "master"
02:06:17.540857 [debug] [MainThread]: On master: BEGIN
02:06:17.540998 [debug] [MainThread]: Opening a new connection, currently in state init
02:06:17.550264 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
02:06:17.550488 [debug] [MainThread]: Using postgres connection "master"
02:06:17.550638 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
02:06:17.591455 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
02:06:17.592790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a67c5cb-c3a4-4665-ab4c-57387fa3c5c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff1f50700>]}
02:06:17.593058 [debug] [MainThread]: On master: ROLLBACK
02:06:17.593307 [debug] [MainThread]: Using postgres connection "master"
02:06:17.593435 [debug] [MainThread]: On master: BEGIN
02:06:17.593756 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
02:06:17.593906 [debug] [MainThread]: On master: COMMIT
02:06:17.594032 [debug] [MainThread]: Using postgres connection "master"
02:06:17.594146 [debug] [MainThread]: On master: COMMIT
02:06:17.594358 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
02:06:17.594518 [debug] [MainThread]: On master: Close
02:06:17.594835 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
02:06:17.595062 [info ] [MainThread]: 
02:06:17.599143 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
02:06:17.599409 [info ] [Thread-1  ]: 1 of 3 START table model wetube.my_first_dbt_model ............................. [RUN]
02:06:17.599826 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
02:06:17.599974 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
02:06:17.600112 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
02:06:17.602549 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
02:06:17.603015 [debug] [Thread-1  ]: finished collecting timing info
02:06:17.603182 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
02:06:17.641115 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
02:06:17.641717 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
02:06:17.641875 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
02:06:17.642010 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:06:17.652201 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
02:06:17.652431 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
02:06:17.652576 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
02:06:17.656656 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
02:06:17.663898 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
02:06:17.664080 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
02:06:17.664553 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
02:06:17.667126 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
02:06:17.667291 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
02:06:17.668676 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
02:06:17.681883 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
02:06:17.682060 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
02:06:17.682195 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
02:06:17.682842 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
02:06:17.687937 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
02:06:17.688087 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
02:06:17.691684 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
02:06:17.693159 [debug] [Thread-1  ]: finished collecting timing info
02:06:17.693350 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
02:06:17.693762 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a67c5cb-c3a4-4665-ab4c-57387fa3c5c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff20dfeb0>]}
02:06:17.694126 [info ] [Thread-1  ]: 1 of 3 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.09s]
02:06:17.694542 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
02:06:17.694737 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
02:06:17.694971 [info ] [Thread-1  ]: 2 of 3 START table model wetube.number_of_subs_by_channel ...................... [RUN]
02:06:17.695395 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
02:06:17.695555 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
02:06:17.695704 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
02:06:17.698889 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
02:06:17.699507 [debug] [Thread-1  ]: finished collecting timing info
02:06:17.699690 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
02:06:17.702605 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
02:06:17.703080 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
02:06:17.703225 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
02:06:17.703353 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:06:17.712675 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
02:06:17.712879 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
02:06:17.713022 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
02:06:17.734994 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.02 seconds
02:06:17.738168 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
02:06:17.738388 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
02:06:17.739110 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
02:06:17.741465 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
02:06:17.741749 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
02:06:17.741911 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
02:06:17.742695 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
02:06:17.744495 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
02:06:17.744658 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
02:06:17.745018 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
02:06:17.746442 [debug] [Thread-1  ]: finished collecting timing info
02:06:17.746625 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
02:06:17.747026 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a67c5cb-c3a4-4665-ab4c-57387fa3c5c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff209c9a0>]}
02:06:17.747390 [info ] [Thread-1  ]: 2 of 3 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.05s]
02:06:17.747805 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
02:06:17.748004 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
02:06:17.748226 [info ] [Thread-1  ]: 3 of 3 START view model wetube.my_second_dbt_model ............................. [RUN]
02:06:17.748643 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
02:06:17.748798 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
02:06:17.748944 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
02:06:17.751262 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
02:06:17.751884 [debug] [Thread-1  ]: finished collecting timing info
02:06:17.752058 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
02:06:17.776684 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
02:06:17.777806 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
02:06:17.778182 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
02:06:17.778388 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:06:17.788485 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
02:06:17.788717 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
02:06:17.788868 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
02:06:17.791035 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
02:06:17.793601 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
02:06:17.793757 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
02:06:17.794307 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
02:06:17.795659 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
02:06:17.795817 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
02:06:17.795952 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
02:06:17.796564 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
02:06:17.799502 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
02:06:17.799671 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
02:06:17.800042 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
02:06:17.801232 [debug] [Thread-1  ]: finished collecting timing info
02:06:17.801409 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
02:06:17.801817 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a67c5cb-c3a4-4665-ab4c-57387fa3c5c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff2496b80>]}
02:06:17.802184 [info ] [Thread-1  ]: 3 of 3 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
02:06:17.802606 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
02:06:17.803813 [debug] [MainThread]: Acquiring new postgres connection "master"
02:06:17.804009 [debug] [MainThread]: Using postgres connection "master"
02:06:17.804151 [debug] [MainThread]: On master: BEGIN
02:06:17.804280 [debug] [MainThread]: Opening a new connection, currently in state closed
02:06:17.815062 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
02:06:17.815375 [debug] [MainThread]: On master: COMMIT
02:06:17.815756 [debug] [MainThread]: Using postgres connection "master"
02:06:17.815913 [debug] [MainThread]: On master: COMMIT
02:06:17.816209 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
02:06:17.816403 [debug] [MainThread]: On master: Close
02:06:17.816830 [info ] [MainThread]: 
02:06:17.817099 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0.36s.
02:06:17.817342 [debug] [MainThread]: Connection 'master' was properly closed.
02:06:17.817471 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
02:06:17.823457 [info ] [MainThread]: 
02:06:17.823757 [info ] [MainThread]: [32mCompleted successfully[0m
02:06:17.824043 [info ] [MainThread]: 
02:06:17.824269 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
02:06:17.824588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff1f52220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff1f521c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff1dfe070>]}


============================== 2022-07-22 17:47:43.433272 | 71a1f925-31d7-432e-a7be-8c08c596b83a ==============================
17:47:43.433301 [info ] [MainThread]: Running with dbt=1.1.1
17:47:43.434608 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:47:43.434844 [debug] [MainThread]: Tracking: tracking
17:47:43.484338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e45deaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e45de340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e45d8490>]}
17:47:43.558529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
17:47:43.559742 [debug] [MainThread]: Partial parsing: update schema file: dbt_blog://models/mart/schema.yml
17:47:43.560144 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/number_of_subs_by_channel.sql
17:47:43.581732 [debug] [MainThread]: 1699: static parser successfully parsed mart/number_of_subs_by_channel.sql
17:47:43.665129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71a1f925-31d7-432e-a7be-8c08c596b83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e45c8130>]}
17:47:43.672082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71a1f925-31d7-432e-a7be-8c08c596b83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e477f790>]}
17:47:43.672413 [info ] [MainThread]: Found 3 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
17:47:43.672704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71a1f925-31d7-432e-a7be-8c08c596b83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e477f850>]}
17:47:43.674422 [info ] [MainThread]: 
17:47:43.674896 [debug] [MainThread]: Acquiring new postgres connection "master"
17:47:43.675824 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
17:47:43.688181 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
17:47:43.688453 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
17:47:43.688617 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:47:43.774438 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.09 seconds
17:47:43.776022 [debug] [ThreadPool]: On list_get_dbt: Close
17:47:43.777310 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
17:47:43.784358 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
17:47:43.784545 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
17:47:43.784687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:47:43.795487 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:47:43.795715 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
17:47:43.795863 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
17:47:43.816166 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.02 seconds
17:47:43.817797 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
17:47:43.818148 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
17:47:43.823151 [debug] [MainThread]: Using postgres connection "master"
17:47:43.823341 [debug] [MainThread]: On master: BEGIN
17:47:43.823479 [debug] [MainThread]: Opening a new connection, currently in state init
17:47:43.832548 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:47:43.832760 [debug] [MainThread]: Using postgres connection "master"
17:47:43.832904 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:47:43.923496 [debug] [MainThread]: SQL status: SELECT 2 in 0.09 seconds
17:47:43.925233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71a1f925-31d7-432e-a7be-8c08c596b83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e477f820>]}
17:47:43.925607 [debug] [MainThread]: On master: ROLLBACK
17:47:43.926151 [debug] [MainThread]: Using postgres connection "master"
17:47:43.926360 [debug] [MainThread]: On master: BEGIN
17:47:43.926846 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:47:43.927071 [debug] [MainThread]: On master: COMMIT
17:47:43.927257 [debug] [MainThread]: Using postgres connection "master"
17:47:43.927420 [debug] [MainThread]: On master: COMMIT
17:47:43.927708 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:47:43.927918 [debug] [MainThread]: On master: Close
17:47:43.928351 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
17:47:43.928674 [info ] [MainThread]: 
17:47:43.932989 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
17:47:43.933290 [info ] [Thread-1  ]: 1 of 3 START table model wetube.my_first_dbt_model ............................. [RUN]
17:47:43.933760 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
17:47:43.933924 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
17:47:43.934078 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
17:47:43.936707 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
17:47:43.937527 [debug] [Thread-1  ]: finished collecting timing info
17:47:43.937717 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
17:47:43.984426 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
17:47:43.985449 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
17:47:43.985686 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
17:47:43.985863 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:47:44.016210 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
17:47:44.016424 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
17:47:44.016625 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:47:44.085281 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.07 seconds
17:47:44.091962 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
17:47:44.092147 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:47:44.111541 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
17:47:44.114333 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
17:47:44.114627 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:47:44.115849 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:47:44.130615 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
17:47:44.130884 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
17:47:44.131139 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
17:47:44.132587 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:47:44.138441 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
17:47:44.138635 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
17:47:44.146406 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
17:47:44.148337 [debug] [Thread-1  ]: finished collecting timing info
17:47:44.148589 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
17:47:44.149096 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71a1f925-31d7-432e-a7be-8c08c596b83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e4adff10>]}
17:47:44.149496 [info ] [Thread-1  ]: 1 of 3 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.22s]
17:47:44.149991 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
17:47:44.150221 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
17:47:44.150668 [info ] [Thread-1  ]: 2 of 3 START table model wetube.number_of_subs_by_channel ...................... [RUN]
17:47:44.151122 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
17:47:44.151313 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
17:47:44.151489 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
17:47:44.154651 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
17:47:44.155222 [debug] [Thread-1  ]: finished collecting timing info
17:47:44.155421 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
17:47:44.159098 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
17:47:44.159779 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
17:47:44.159962 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
17:47:44.160102 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:47:44.170857 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:47:44.171180 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
17:47:44.171359 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
17:47:44.217863 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.05 seconds
17:47:44.220516 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
17:47:44.220704 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
17:47:44.221380 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:47:44.223510 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
17:47:44.223686 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
17:47:44.223828 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
17:47:44.224944 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:47:44.226660 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
17:47:44.226823 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
17:47:44.227192 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
17:47:44.228507 [debug] [Thread-1  ]: finished collecting timing info
17:47:44.228726 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
17:47:44.229357 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71a1f925-31d7-432e-a7be-8c08c596b83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e44f9c70>]}
17:47:44.230045 [info ] [Thread-1  ]: 2 of 3 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.08s]
17:47:44.230636 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
17:47:44.231042 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
17:47:44.231630 [info ] [Thread-1  ]: 3 of 3 START view model wetube.my_second_dbt_model ............................. [RUN]
17:47:44.232144 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
17:47:44.232312 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
17:47:44.232465 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
17:47:44.235068 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
17:47:44.235688 [debug] [Thread-1  ]: finished collecting timing info
17:47:44.235866 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
17:47:44.266987 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
17:47:44.268474 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
17:47:44.268708 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
17:47:44.268927 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:47:44.282517 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:47:44.282845 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
17:47:44.283003 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
17:47:44.297907 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
17:47:44.301228 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
17:47:44.301436 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:47:44.302002 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:47:44.304846 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
17:47:44.305148 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
17:47:44.305373 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
17:47:44.306230 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:47:44.310049 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
17:47:44.310351 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
17:47:44.311287 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
17:47:44.312906 [debug] [Thread-1  ]: finished collecting timing info
17:47:44.313129 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
17:47:44.313588 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71a1f925-31d7-432e-a7be-8c08c596b83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e4b65be0>]}
17:47:44.313972 [info ] [Thread-1  ]: 3 of 3 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.08s]
17:47:44.314399 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
17:47:44.315648 [debug] [MainThread]: Acquiring new postgres connection "master"
17:47:44.315942 [debug] [MainThread]: Using postgres connection "master"
17:47:44.316094 [debug] [MainThread]: On master: BEGIN
17:47:44.316227 [debug] [MainThread]: Opening a new connection, currently in state closed
17:47:44.326890 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:47:44.327237 [debug] [MainThread]: On master: COMMIT
17:47:44.327666 [debug] [MainThread]: Using postgres connection "master"
17:47:44.327937 [debug] [MainThread]: On master: COMMIT
17:47:44.328372 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:47:44.328611 [debug] [MainThread]: On master: Close
17:47:44.329261 [info ] [MainThread]: 
17:47:44.329552 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0.65s.
17:47:44.329803 [debug] [MainThread]: Connection 'master' was properly closed.
17:47:44.329934 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
17:47:44.336765 [info ] [MainThread]: 
17:47:44.337283 [info ] [MainThread]: [32mCompleted successfully[0m
17:47:44.337703 [info ] [MainThread]: 
17:47:44.338182 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
17:47:44.338795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e47445b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e47440a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e41b2bb0>]}


============================== 2022-07-22 20:22:15.548689 | 6c777413-76b1-4516-b7a1-f2057567641a ==============================
20:22:15.548713 [info ] [MainThread]: Running with dbt=1.1.1
20:22:15.550079 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:22:15.550233 [debug] [MainThread]: Tracking: tracking
20:22:15.578356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc99eda520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc99edacd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc99ed7550>]}
20:22:15.653782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
20:22:15.654223 [debug] [MainThread]: Partial parsing: added file: dbt_blog://models/mart/account_information.sql
20:22:15.654656 [debug] [MainThread]: Partial parsing: update schema file: dbt_blog://models/mart/schema.yml
20:22:15.674794 [debug] [MainThread]: 1699: static parser successfully parsed mart/account_information.sql
20:22:15.786866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c777413-76b1-4516-b7a1-f2057567641a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc99dfc430>]}
20:22:15.795566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c777413-76b1-4516-b7a1-f2057567641a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9a111ee0>]}
20:22:15.795908 [info ] [MainThread]: Found 4 models, 16 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
20:22:15.796200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c777413-76b1-4516-b7a1-f2057567641a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc99d7d640>]}
20:22:15.798319 [info ] [MainThread]: 
20:22:15.798813 [debug] [MainThread]: Acquiring new postgres connection "master"
20:22:15.799768 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
20:22:15.811955 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
20:22:15.812156 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
20:22:15.812305 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:22:15.936655 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.12 seconds
20:22:15.938631 [debug] [ThreadPool]: On list_get_dbt: Close
20:22:15.939897 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
20:22:15.946892 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
20:22:15.947069 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
20:22:15.947210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:22:15.957771 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:22:15.958001 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
20:22:15.958148 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
20:22:15.970394 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
20:22:15.972082 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
20:22:15.972396 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
20:22:15.978369 [debug] [MainThread]: Using postgres connection "master"
20:22:15.978565 [debug] [MainThread]: On master: BEGIN
20:22:15.978709 [debug] [MainThread]: Opening a new connection, currently in state init
20:22:15.988605 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:22:15.988813 [debug] [MainThread]: Using postgres connection "master"
20:22:15.988963 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:22:16.102466 [debug] [MainThread]: SQL status: SELECT 2 in 0.11 seconds
20:22:16.104487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c777413-76b1-4516-b7a1-f2057567641a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9a111bb0>]}
20:22:16.104879 [debug] [MainThread]: On master: ROLLBACK
20:22:16.105237 [debug] [MainThread]: Using postgres connection "master"
20:22:16.105422 [debug] [MainThread]: On master: BEGIN
20:22:16.105881 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:22:16.106097 [debug] [MainThread]: On master: COMMIT
20:22:16.106435 [debug] [MainThread]: Using postgres connection "master"
20:22:16.106694 [debug] [MainThread]: On master: COMMIT
20:22:16.107111 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:22:16.107342 [debug] [MainThread]: On master: Close
20:22:16.107772 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:22:16.108101 [info ] [MainThread]: 
20:22:16.115521 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
20:22:16.115857 [info ] [Thread-1  ]: 1 of 4 START table model wetube.account_information ............................ [RUN]
20:22:16.116341 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
20:22:16.116511 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
20:22:16.116671 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
20:22:16.121259 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
20:22:16.122820 [debug] [Thread-1  ]: finished collecting timing info
20:22:16.123144 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
20:22:16.162549 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
20:22:16.163857 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
20:22:16.164135 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
20:22:16.164305 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:22:16.174337 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:22:16.174556 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
20:22:16.174704 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (

    select * from
        "get_dbt"."wetube"."city"

),

source_state as (

    select * from
        "get_dbt"."wetube"."state"

),

source_user_address as (

    select * from
        "get_dbt"."wetube"."user_address"

),

source_account as (

    select * from
        "get_dbt"."wetube"."account"

),

account_info as (

    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name,
        state.name,
        channel.id_channel,
        channel.channel_name as channel,
        channel.creation_date as channel_creation
        channel.id
    FROM source_account account
    	inner join source_channel channel using (id_account)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
20:22:16.177940 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "channel"
LINE 52:         channel.id
                 ^

20:22:16.178206 [debug] [Thread-1  ]: On model.dbt_blog.account_information: ROLLBACK
20:22:16.178752 [debug] [Thread-1  ]: finished collecting timing info
20:22:16.178967 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
20:22:16.179350 [debug] [Thread-1  ]: Database Error in model account_information (models/mart/account_information.sql)
  syntax error at or near "channel"
  LINE 52:         channel.id
                   ^
  compiled SQL at target/run/dbt_blog/models/mart/account_information.sql
20:22:16.179647 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c777413-76b1-4516-b7a1-f2057567641a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9a328820>]}
20:22:16.180013 [error] [Thread-1  ]: 1 of 4 ERROR creating table model wetube.account_information ................... [[31mERROR[0m in 0.06s]
20:22:16.180484 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
20:22:16.180689 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
20:22:16.180924 [info ] [Thread-1  ]: 2 of 4 START table model wetube.my_first_dbt_model ............................. [RUN]
20:22:16.181512 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
20:22:16.181684 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
20:22:16.181837 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
20:22:16.184364 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
20:22:16.187911 [debug] [Thread-1  ]: finished collecting timing info
20:22:16.188172 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
20:22:16.191359 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
20:22:16.192909 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:22:16.193149 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
20:22:16.193303 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:22:16.207323 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:22:16.207556 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:22:16.207765 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
20:22:16.236218 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.03 seconds
20:22:16.243605 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:22:16.243792 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
20:22:16.250604 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
20:22:16.253196 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:22:16.253371 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
20:22:16.254626 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:22:16.268213 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
20:22:16.268421 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:22:16.268567 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
20:22:16.271486 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:22:16.277383 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:22:16.277587 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
20:22:16.311431 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
20:22:16.312827 [debug] [Thread-1  ]: finished collecting timing info
20:22:16.313027 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
20:22:16.313445 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c777413-76b1-4516-b7a1-f2057567641a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9a3193a0>]}
20:22:16.313822 [info ] [Thread-1  ]: 2 of 4 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.13s]
20:22:16.314308 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
20:22:16.314753 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
20:22:16.315293 [info ] [Thread-1  ]: 3 of 4 START table model wetube.number_of_subs_by_channel ...................... [RUN]
20:22:16.315796 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:22:16.315963 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
20:22:16.316116 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
20:22:16.319433 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
20:22:16.320975 [debug] [Thread-1  ]: finished collecting timing info
20:22:16.321195 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
20:22:16.324241 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
20:22:16.325173 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:22:16.325343 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
20:22:16.325499 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:22:16.341365 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
20:22:16.341649 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:22:16.341827 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
20:22:16.366789 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.02 seconds
20:22:16.372868 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:22:16.373186 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
20:22:16.373760 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:22:16.376310 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:22:16.376490 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
20:22:16.377166 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:22:16.379105 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
20:22:16.379319 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:22:16.379476 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
20:22:16.380142 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:22:16.382091 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:22:16.382256 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
20:22:16.390519 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
20:22:16.391941 [debug] [Thread-1  ]: finished collecting timing info
20:22:16.392144 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
20:22:16.392582 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c777413-76b1-4516-b7a1-f2057567641a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9a3d4d60>]}
20:22:16.392950 [info ] [Thread-1  ]: 3 of 4 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.08s]
20:22:16.393369 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
20:22:16.393567 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
20:22:16.393789 [info ] [Thread-1  ]: 4 of 4 START view model wetube.my_second_dbt_model ............................. [RUN]
20:22:16.394208 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
20:22:16.394516 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
20:22:16.394701 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
20:22:16.397239 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
20:22:16.397773 [debug] [Thread-1  ]: finished collecting timing info
20:22:16.397951 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
20:22:16.423842 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
20:22:16.425759 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:22:16.425937 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
20:22:16.426082 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:22:16.437203 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:22:16.437438 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:22:16.437590 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
20:22:16.451643 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
20:22:16.454508 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:22:16.454684 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
20:22:16.455179 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:22:16.456501 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
20:22:16.456662 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:22:16.456801 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
20:22:16.457532 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:22:16.459838 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:22:16.460038 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
20:22:16.461055 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:22:16.462428 [debug] [Thread-1  ]: finished collecting timing info
20:22:16.462635 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
20:22:16.463046 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c777413-76b1-4516-b7a1-f2057567641a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9a3b35e0>]}
20:22:16.463406 [info ] [Thread-1  ]: 4 of 4 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
20:22:16.463951 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
20:22:16.465038 [debug] [MainThread]: Acquiring new postgres connection "master"
20:22:16.465245 [debug] [MainThread]: Using postgres connection "master"
20:22:16.465394 [debug] [MainThread]: On master: BEGIN
20:22:16.465533 [debug] [MainThread]: Opening a new connection, currently in state closed
20:22:16.475546 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:22:16.475804 [debug] [MainThread]: On master: COMMIT
20:22:16.475961 [debug] [MainThread]: Using postgres connection "master"
20:22:16.476115 [debug] [MainThread]: On master: COMMIT
20:22:16.476396 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:22:16.476572 [debug] [MainThread]: On master: Close
20:22:16.477012 [info ] [MainThread]: 
20:22:16.477287 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0.68s.
20:22:16.477545 [debug] [MainThread]: Connection 'master' was properly closed.
20:22:16.477680 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
20:22:16.488958 [info ] [MainThread]: 
20:22:16.489426 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
20:22:16.489755 [info ] [MainThread]: 
20:22:16.490010 [error] [MainThread]: [33mDatabase Error in model account_information (models/mart/account_information.sql)[0m
20:22:16.490285 [error] [MainThread]:   syntax error at or near "channel"
20:22:16.490580 [error] [MainThread]:   LINE 52:         channel.id
20:22:16.491029 [error] [MainThread]:                    ^
20:22:16.491269 [error] [MainThread]:   compiled SQL at target/run/dbt_blog/models/mart/account_information.sql
20:22:16.491543 [info ] [MainThread]: 
20:22:16.491810 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
20:22:16.492310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9a2d24c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc99ec7c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc99ed71c0>]}


============================== 2022-07-22 20:25:56.770188 | 9b54ca20-6434-47c4-9769-149f545c65a6 ==============================
20:25:56.770220 [info ] [MainThread]: Running with dbt=1.1.1
20:25:56.771490 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:25:56.771716 [debug] [MainThread]: Tracking: tracking
20:25:56.803876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78e5d9ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78e5d9700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78e619190>]}
20:25:56.901489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
20:25:56.902075 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/account_information.sql
20:25:56.921264 [debug] [MainThread]: 1699: static parser successfully parsed mart/account_information.sql
20:25:57.046046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b54ca20-6434-47c4-9769-149f545c65a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78e7779a0>]}
20:25:57.055801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b54ca20-6434-47c4-9769-149f545c65a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78e777e80>]}
20:25:57.056251 [info ] [MainThread]: Found 4 models, 16 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
20:25:57.056569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b54ca20-6434-47c4-9769-149f545c65a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78e777280>]}
20:25:57.058911 [info ] [MainThread]: 
20:25:57.059453 [debug] [MainThread]: Acquiring new postgres connection "master"
20:25:57.060498 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
20:25:57.073214 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
20:25:57.073452 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
20:25:57.073607 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:25:57.111912 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.04 seconds
20:25:57.113620 [debug] [ThreadPool]: On list_get_dbt: Close
20:25:57.115100 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
20:25:57.123079 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
20:25:57.123293 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
20:25:57.123443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:25:57.133543 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:25:57.133772 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
20:25:57.133930 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
20:25:57.140591 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
20:25:57.157770 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
20:25:57.158224 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
20:25:57.163826 [debug] [MainThread]: Using postgres connection "master"
20:25:57.164043 [debug] [MainThread]: On master: BEGIN
20:25:57.164190 [debug] [MainThread]: Opening a new connection, currently in state init
20:25:57.173531 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:25:57.173758 [debug] [MainThread]: Using postgres connection "master"
20:25:57.173908 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:25:57.221374 [debug] [MainThread]: SQL status: SELECT 2 in 0.05 seconds
20:25:57.223414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b54ca20-6434-47c4-9769-149f545c65a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78e4ae5e0>]}
20:25:57.223805 [debug] [MainThread]: On master: ROLLBACK
20:25:57.224179 [debug] [MainThread]: Using postgres connection "master"
20:25:57.224372 [debug] [MainThread]: On master: BEGIN
20:25:57.224767 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:25:57.224950 [debug] [MainThread]: On master: COMMIT
20:25:57.225106 [debug] [MainThread]: Using postgres connection "master"
20:25:57.225244 [debug] [MainThread]: On master: COMMIT
20:25:57.225507 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:25:57.225698 [debug] [MainThread]: On master: Close
20:25:57.226066 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:25:57.226335 [info ] [MainThread]: 
20:25:57.231050 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
20:25:57.231467 [info ] [Thread-1  ]: 1 of 4 START table model wetube.account_information ............................ [RUN]
20:25:57.231999 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
20:25:57.232166 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
20:25:57.232323 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
20:25:57.237252 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
20:25:57.238210 [debug] [Thread-1  ]: finished collecting timing info
20:25:57.238862 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
20:25:57.284255 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
20:25:57.284916 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
20:25:57.285092 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
20:25:57.285234 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:25:57.295256 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:25:57.295491 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
20:25:57.295644 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (

    select * from
        "get_dbt"."wetube"."city"

),

source_state as (

    select * from
        "get_dbt"."wetube"."state"

),

source_user_address as (

    select * from
        "get_dbt"."wetube"."user_address"

),

source_account as (

    select * from
        "get_dbt"."wetube"."account"

),

account_info as (

    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name,
        state.name,
        channel.id_channel,
        channel.channel_name as channel,
        channel.creation_date as channel_creation,
        channel.id_channel
    FROM source_account account
    	inner join source_channel channel using (id_account)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
20:25:57.301450 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "id_account" specified in USING clause does not exist in left table

20:25:57.301683 [debug] [Thread-1  ]: On model.dbt_blog.account_information: ROLLBACK
20:25:57.302044 [debug] [Thread-1  ]: finished collecting timing info
20:25:57.302221 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
20:25:57.302606 [debug] [Thread-1  ]: Database Error in model account_information (models/mart/account_information.sql)
  column "id_account" specified in USING clause does not exist in left table
  compiled SQL at target/run/dbt_blog/models/mart/account_information.sql
20:25:57.302907 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b54ca20-6434-47c4-9769-149f545c65a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78e90c7f0>]}
20:25:57.303280 [error] [Thread-1  ]: 1 of 4 ERROR creating table model wetube.account_information ................... [[31mERROR[0m in 0.07s]
20:25:57.303750 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
20:25:57.303962 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
20:25:57.304380 [info ] [Thread-1  ]: 2 of 4 START table model wetube.my_first_dbt_model ............................. [RUN]
20:25:57.304836 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
20:25:57.304993 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
20:25:57.305143 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
20:25:57.307838 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
20:25:57.308379 [debug] [Thread-1  ]: finished collecting timing info
20:25:57.308562 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
20:25:57.312005 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
20:25:57.312632 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:25:57.312799 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
20:25:57.312938 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:25:57.323329 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:25:57.323623 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:25:57.323794 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
20:25:57.335843 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
20:25:57.346188 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:25:57.346495 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
20:25:57.347755 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:25:57.350346 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:25:57.350602 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
20:25:57.351344 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:25:57.365354 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
20:25:57.365578 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:25:57.365728 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
20:25:57.366369 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:25:57.372367 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:25:57.372587 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
20:25:57.379101 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
20:25:57.380423 [debug] [Thread-1  ]: finished collecting timing info
20:25:57.380622 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
20:25:57.381056 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b54ca20-6434-47c4-9769-149f545c65a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78e935bb0>]}
20:25:57.381432 [info ] [Thread-1  ]: 2 of 4 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.08s]
20:25:57.381859 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
20:25:57.382067 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
20:25:57.382453 [info ] [Thread-1  ]: 3 of 4 START table model wetube.number_of_subs_by_channel ...................... [RUN]
20:25:57.383041 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:25:57.383220 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
20:25:57.383377 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
20:25:57.387942 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
20:25:57.388542 [debug] [Thread-1  ]: finished collecting timing info
20:25:57.388887 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
20:25:57.392840 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
20:25:57.393570 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:25:57.393738 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
20:25:57.393877 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:25:57.404742 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:25:57.405021 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:25:57.405185 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
20:25:57.412068 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.01 seconds
20:25:57.414828 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:25:57.415005 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
20:25:57.416192 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:25:57.418763 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:25:57.418942 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
20:25:57.419735 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:25:57.421380 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
20:25:57.421544 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:25:57.421686 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
20:25:57.422391 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:25:57.424337 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:25:57.424504 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
20:25:57.427203 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:25:57.428449 [debug] [Thread-1  ]: finished collecting timing info
20:25:57.428645 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
20:25:57.429080 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b54ca20-6434-47c4-9769-149f545c65a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78e91f520>]}
20:25:57.429468 [info ] [Thread-1  ]: 3 of 4 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.05s]
20:25:57.429907 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
20:25:57.430116 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
20:25:57.430352 [info ] [Thread-1  ]: 4 of 4 START view model wetube.my_second_dbt_model ............................. [RUN]
20:25:57.431051 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
20:25:57.431227 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
20:25:57.431384 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
20:25:57.433909 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
20:25:57.434406 [debug] [Thread-1  ]: finished collecting timing info
20:25:57.434578 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
20:25:57.456821 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
20:25:57.457526 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:25:57.457793 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
20:25:57.457953 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:25:57.468101 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:25:57.468343 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:25:57.468494 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
20:25:57.475101 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
20:25:57.478435 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:25:57.479081 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
20:25:57.479733 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:25:57.481414 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
20:25:57.481690 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:25:57.481847 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
20:25:57.485837 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:25:57.487795 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:25:57.487959 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
20:25:57.488483 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:25:57.489833 [debug] [Thread-1  ]: finished collecting timing info
20:25:57.490029 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
20:25:57.490517 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b54ca20-6434-47c4-9769-149f545c65a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78e946040>]}
20:25:57.490912 [info ] [Thread-1  ]: 4 of 4 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
20:25:57.491347 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
20:25:57.492414 [debug] [MainThread]: Acquiring new postgres connection "master"
20:25:57.492615 [debug] [MainThread]: Using postgres connection "master"
20:25:57.492767 [debug] [MainThread]: On master: BEGIN
20:25:57.492900 [debug] [MainThread]: Opening a new connection, currently in state closed
20:25:57.504986 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:25:57.505478 [debug] [MainThread]: On master: COMMIT
20:25:57.505663 [debug] [MainThread]: Using postgres connection "master"
20:25:57.505816 [debug] [MainThread]: On master: COMMIT
20:25:57.506137 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:25:57.506395 [debug] [MainThread]: On master: Close
20:25:57.507027 [info ] [MainThread]: 
20:25:57.507442 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0.45s.
20:25:57.507806 [debug] [MainThread]: Connection 'master' was properly closed.
20:25:57.507990 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
20:25:57.516362 [info ] [MainThread]: 
20:25:57.516730 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
20:25:57.517038 [info ] [MainThread]: 
20:25:57.517298 [error] [MainThread]: [33mDatabase Error in model account_information (models/mart/account_information.sql)[0m
20:25:57.517583 [error] [MainThread]:   column "id_account" specified in USING clause does not exist in left table
20:25:57.517820 [error] [MainThread]:   compiled SQL at target/run/dbt_blog/models/mart/account_information.sql
20:25:57.518093 [info ] [MainThread]: 
20:25:57.518355 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
20:25:57.518808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78e8e1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78e8e1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78e94af40>]}


============================== 2022-07-22 20:27:44.432639 | abba51b0-dd3b-49ad-96d8-7617702f3354 ==============================
20:27:44.432666 [info ] [MainThread]: Running with dbt=1.1.1
20:27:44.433830 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:27:44.433978 [debug] [MainThread]: Tracking: tracking
20:27:44.458953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ff1633520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ff1633cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ff1631550>]}
20:27:44.537896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
20:27:44.538515 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/account_information.sql
20:27:44.557003 [debug] [MainThread]: 1699: static parser successfully parsed mart/account_information.sql
20:27:44.679109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abba51b0-dd3b-49ad-96d8-7617702f3354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ff17db4f0>]}
20:27:44.690096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abba51b0-dd3b-49ad-96d8-7617702f3354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ff17dbdc0>]}
20:27:44.690442 [info ] [MainThread]: Found 4 models, 16 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
20:27:44.690727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abba51b0-dd3b-49ad-96d8-7617702f3354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ff17dbbb0>]}
20:27:44.692699 [info ] [MainThread]: 
20:27:44.693296 [debug] [MainThread]: Acquiring new postgres connection "master"
20:27:44.694257 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
20:27:44.707853 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
20:27:44.708096 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
20:27:44.708265 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:27:44.752605 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.04 seconds
20:27:44.754345 [debug] [ThreadPool]: On list_get_dbt: Close
20:27:44.755910 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
20:27:44.764057 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
20:27:44.764296 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
20:27:44.764462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:27:44.773856 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:27:44.774093 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
20:27:44.774251 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
20:27:44.778135 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
20:27:44.779841 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
20:27:44.780143 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
20:27:44.785406 [debug] [MainThread]: Using postgres connection "master"
20:27:44.785616 [debug] [MainThread]: On master: BEGIN
20:27:44.785767 [debug] [MainThread]: Opening a new connection, currently in state init
20:27:44.795004 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:27:44.795247 [debug] [MainThread]: Using postgres connection "master"
20:27:44.795478 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:27:44.839201 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
20:27:44.840682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abba51b0-dd3b-49ad-96d8-7617702f3354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ff1506640>]}
20:27:44.841016 [debug] [MainThread]: On master: ROLLBACK
20:27:44.841329 [debug] [MainThread]: Using postgres connection "master"
20:27:44.841502 [debug] [MainThread]: On master: BEGIN
20:27:44.841863 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:27:44.842039 [debug] [MainThread]: On master: COMMIT
20:27:44.842261 [debug] [MainThread]: Using postgres connection "master"
20:27:44.842412 [debug] [MainThread]: On master: COMMIT
20:27:44.842685 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:27:44.842876 [debug] [MainThread]: On master: Close
20:27:44.843258 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:27:44.843526 [info ] [MainThread]: 
20:27:44.850143 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
20:27:44.850479 [info ] [Thread-1  ]: 1 of 4 START table model wetube.account_information ............................ [RUN]
20:27:44.850981 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
20:27:44.851149 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
20:27:44.851313 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
20:27:44.856829 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
20:27:44.857981 [debug] [Thread-1  ]: finished collecting timing info
20:27:44.858248 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
20:27:44.899805 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
20:27:44.900515 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
20:27:44.900691 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
20:27:44.900968 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:44.910949 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:27:44.911167 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
20:27:44.911313 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (

    select * from
        "get_dbt"."wetube"."city"

),

source_state as (

    select * from
        "get_dbt"."wetube"."state"

),

source_user_address as (

    select * from
        "get_dbt"."wetube"."user_address"

),

source_account as (

    select * from
        "get_dbt"."wetube"."account"

),

account_info as (

    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name,
        state.name,
        channel.id_channel,
        channel.channel_name as channel,
        channel.creation_date as channel_creation,
        channel.id_account
    FROM source_account account
    	inner join source_channel channel using (id_account)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
20:27:44.912255 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "id_account" specified in USING clause does not exist in left table

20:27:44.912431 [debug] [Thread-1  ]: On model.dbt_blog.account_information: ROLLBACK
20:27:44.912770 [debug] [Thread-1  ]: finished collecting timing info
20:27:44.912939 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
20:27:44.913290 [debug] [Thread-1  ]: Database Error in model account_information (models/mart/account_information.sql)
  column "id_account" specified in USING clause does not exist in left table
  compiled SQL at target/run/dbt_blog/models/mart/account_information.sql
20:27:44.913572 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abba51b0-dd3b-49ad-96d8-7617702f3354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ff2264850>]}
20:27:44.913948 [error] [Thread-1  ]: 1 of 4 ERROR creating table model wetube.account_information ................... [[31mERROR[0m in 0.06s]
20:27:44.914400 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
20:27:44.914596 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
20:27:44.914954 [info ] [Thread-1  ]: 2 of 4 START table model wetube.my_first_dbt_model ............................. [RUN]
20:27:44.915376 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
20:27:44.915528 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
20:27:44.915670 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
20:27:44.918200 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
20:27:44.919592 [debug] [Thread-1  ]: finished collecting timing info
20:27:44.919769 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
20:27:44.922775 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
20:27:44.923272 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:27:44.923428 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
20:27:44.923564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:44.934340 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:27:44.934563 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:27:44.934712 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
20:27:44.943484 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
20:27:44.951492 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:27:44.951735 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
20:27:44.952387 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:27:44.955292 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:27:44.955572 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
20:27:44.958202 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:27:44.972589 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
20:27:44.972836 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:27:44.972990 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
20:27:44.973805 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:27:44.979415 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:27:44.979593 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
20:27:44.981723 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:27:44.983026 [debug] [Thread-1  ]: finished collecting timing info
20:27:44.983236 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
20:27:44.983666 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abba51b0-dd3b-49ad-96d8-7617702f3354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ff228dc10>]}
20:27:44.984042 [info ] [Thread-1  ]: 2 of 4 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.07s]
20:27:44.984492 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
20:27:44.984695 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
20:27:44.985087 [info ] [Thread-1  ]: 3 of 4 START table model wetube.number_of_subs_by_channel ...................... [RUN]
20:27:44.985548 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:27:44.985705 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
20:27:44.985851 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
20:27:44.990174 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
20:27:44.990680 [debug] [Thread-1  ]: finished collecting timing info
20:27:44.990859 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
20:27:44.993798 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
20:27:44.994293 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:27:44.994450 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
20:27:44.994587 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:45.003651 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:27:45.003862 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:27:45.004011 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
20:27:45.008876 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
20:27:45.011592 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:27:45.011769 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
20:27:45.012277 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:27:45.015473 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:27:45.015721 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
20:27:45.016567 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:27:45.018613 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
20:27:45.018939 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:27:45.019118 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
20:27:45.022187 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:27:45.024906 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:27:45.025228 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
20:27:45.027311 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:27:45.028645 [debug] [Thread-1  ]: finished collecting timing info
20:27:45.029022 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
20:27:45.029481 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abba51b0-dd3b-49ad-96d8-7617702f3354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ff2240430>]}
20:27:45.029878 [info ] [Thread-1  ]: 3 of 4 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.04s]
20:27:45.030342 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
20:27:45.030660 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
20:27:45.031021 [info ] [Thread-1  ]: 4 of 4 START view model wetube.my_second_dbt_model ............................. [RUN]
20:27:45.031540 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
20:27:45.031710 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
20:27:45.031861 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
20:27:45.034717 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
20:27:45.035266 [debug] [Thread-1  ]: finished collecting timing info
20:27:45.035448 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
20:27:45.058025 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
20:27:45.058670 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:27:45.058884 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
20:27:45.059037 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:45.070478 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:27:45.070802 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:27:45.070985 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
20:27:45.075118 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:27:45.077950 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:27:45.078135 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
20:27:45.078708 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:27:45.080121 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
20:27:45.080293 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:27:45.080434 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
20:27:45.081010 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:27:45.082846 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:27:45.083011 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
20:27:45.083475 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:27:45.084646 [debug] [Thread-1  ]: finished collecting timing info
20:27:45.084833 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
20:27:45.085235 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abba51b0-dd3b-49ad-96d8-7617702f3354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ff228de50>]}
20:27:45.085668 [info ] [Thread-1  ]: 4 of 4 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
20:27:45.086096 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
20:27:45.087144 [debug] [MainThread]: Acquiring new postgres connection "master"
20:27:45.087341 [debug] [MainThread]: Using postgres connection "master"
20:27:45.087522 [debug] [MainThread]: On master: BEGIN
20:27:45.087691 [debug] [MainThread]: Opening a new connection, currently in state closed
20:27:45.097016 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:27:45.097256 [debug] [MainThread]: On master: COMMIT
20:27:45.097416 [debug] [MainThread]: Using postgres connection "master"
20:27:45.097555 [debug] [MainThread]: On master: COMMIT
20:27:45.097794 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:27:45.097965 [debug] [MainThread]: On master: Close
20:27:45.098497 [info ] [MainThread]: 
20:27:45.098785 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0.41s.
20:27:45.099040 [debug] [MainThread]: Connection 'master' was properly closed.
20:27:45.099174 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
20:27:45.106350 [info ] [MainThread]: 
20:27:45.106950 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
20:27:45.107329 [info ] [MainThread]: 
20:27:45.107609 [error] [MainThread]: [33mDatabase Error in model account_information (models/mart/account_information.sql)[0m
20:27:45.107853 [error] [MainThread]:   column "id_account" specified in USING clause does not exist in left table
20:27:45.108074 [error] [MainThread]:   compiled SQL at target/run/dbt_blog/models/mart/account_information.sql
20:27:45.108309 [info ] [MainThread]: 
20:27:45.108539 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
20:27:45.108980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ff2237880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ff2237850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ff2302880>]}


============================== 2022-07-22 20:34:27.925156 | 403252c6-40b1-4870-a526-7af4894af53a ==============================
20:34:27.925177 [info ] [MainThread]: Running with dbt=1.1.1
20:34:27.926657 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:34:27.926817 [debug] [MainThread]: Tracking: tracking
20:34:27.952218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc827f34a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc827f342e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc827f309a0>]}
20:34:28.026675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
20:34:28.027228 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/account_information.sql
20:34:28.045670 [debug] [MainThread]: 1699: static parser successfully parsed mart/account_information.sql
20:34:28.158009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '403252c6-40b1-4870-a526-7af4894af53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8280dc0d0>]}
20:34:28.166423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '403252c6-40b1-4870-a526-7af4894af53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8280dc040>]}
20:34:28.166758 [info ] [MainThread]: Found 4 models, 16 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
20:34:28.167040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '403252c6-40b1-4870-a526-7af4894af53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8280dcdf0>]}
20:34:28.169014 [info ] [MainThread]: 
20:34:28.169509 [debug] [MainThread]: Acquiring new postgres connection "master"
20:34:28.170424 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
20:34:28.182805 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
20:34:28.183068 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
20:34:28.183225 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:34:28.401819 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.22 seconds
20:34:28.403548 [debug] [ThreadPool]: On list_get_dbt: Close
20:34:28.405023 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
20:34:28.412526 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
20:34:28.412747 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
20:34:28.412909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:34:28.422407 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:34:28.422645 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
20:34:28.422797 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
20:34:28.428285 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
20:34:28.430021 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
20:34:28.430437 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
20:34:28.435480 [debug] [MainThread]: Using postgres connection "master"
20:34:28.435674 [debug] [MainThread]: On master: BEGIN
20:34:28.435894 [debug] [MainThread]: Opening a new connection, currently in state init
20:34:28.447107 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:34:28.447348 [debug] [MainThread]: Using postgres connection "master"
20:34:28.447502 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:34:28.530190 [debug] [MainThread]: SQL status: SELECT 2 in 0.08 seconds
20:34:28.531698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '403252c6-40b1-4870-a526-7af4894af53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc827e565b0>]}
20:34:28.532076 [debug] [MainThread]: On master: ROLLBACK
20:34:28.532396 [debug] [MainThread]: Using postgres connection "master"
20:34:28.532563 [debug] [MainThread]: On master: BEGIN
20:34:28.532914 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:34:28.533093 [debug] [MainThread]: On master: COMMIT
20:34:28.533245 [debug] [MainThread]: Using postgres connection "master"
20:34:28.533380 [debug] [MainThread]: On master: COMMIT
20:34:28.533626 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:34:28.533794 [debug] [MainThread]: On master: Close
20:34:28.534178 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:34:28.534448 [info ] [MainThread]: 
20:34:28.539157 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
20:34:28.539484 [info ] [Thread-1  ]: 1 of 4 START table model wetube.account_information ............................ [RUN]
20:34:28.539971 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
20:34:28.540137 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
20:34:28.540303 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
20:34:28.545114 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
20:34:28.546898 [debug] [Thread-1  ]: finished collecting timing info
20:34:28.547450 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
20:34:28.588201 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
20:34:28.590487 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
20:34:28.590813 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
20:34:28.591099 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:34:28.601357 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:34:28.601577 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
20:34:28.601724 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (

    select * from
        "get_dbt"."wetube"."city"

),

source_state as (

    select * from
        "get_dbt"."wetube"."state"

),

source_user_address as (

    select * from
        "get_dbt"."wetube"."user_address"

),

source_account as (

    select * from
        "get_dbt"."wetube"."account"

),

account_info as (

    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name,
        state.name,
        channel.id_channel,
        channel.channel_name as channel,
        channel.creation_date as channel_creation,
        channel.id_account
    FROM source_account account
    	inner join source_channel channel using (id_user)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
20:34:28.603747 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "id_user" specified in USING clause does not exist in right table

20:34:28.603935 [debug] [Thread-1  ]: On model.dbt_blog.account_information: ROLLBACK
20:34:28.604283 [debug] [Thread-1  ]: finished collecting timing info
20:34:28.604452 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
20:34:28.604807 [debug] [Thread-1  ]: Database Error in model account_information (models/mart/account_information.sql)
  column "id_user" specified in USING clause does not exist in right table
  compiled SQL at target/run/dbt_blog/models/mart/account_information.sql
20:34:28.605100 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '403252c6-40b1-4870-a526-7af4894af53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc828261850>]}
20:34:28.605465 [error] [Thread-1  ]: 1 of 4 ERROR creating table model wetube.account_information ................... [[31mERROR[0m in 0.07s]
20:34:28.605923 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
20:34:28.606124 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
20:34:28.606349 [info ] [Thread-1  ]: 2 of 4 START table model wetube.my_first_dbt_model ............................. [RUN]
20:34:28.607071 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
20:34:28.607234 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
20:34:28.607382 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
20:34:28.609914 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
20:34:28.611638 [debug] [Thread-1  ]: finished collecting timing info
20:34:28.611851 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
20:34:28.615410 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
20:34:28.616041 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:34:28.616216 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
20:34:28.616351 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:34:28.633522 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
20:34:28.633752 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:34:28.633897 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
20:34:28.648564 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
20:34:28.656156 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:34:28.656361 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
20:34:28.658108 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:34:28.660595 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:34:28.660777 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
20:34:28.661348 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:34:28.674777 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
20:34:28.674998 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:34:28.675144 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
20:34:28.677354 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:34:28.682962 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:34:28.683142 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
20:34:28.694877 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
20:34:28.696260 [debug] [Thread-1  ]: finished collecting timing info
20:34:28.696451 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
20:34:28.696869 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '403252c6-40b1-4870-a526-7af4894af53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc828275f70>]}
20:34:28.697317 [info ] [Thread-1  ]: 2 of 4 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.09s]
20:34:28.697727 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
20:34:28.697919 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
20:34:28.698141 [info ] [Thread-1  ]: 3 of 4 START table model wetube.number_of_subs_by_channel ...................... [RUN]
20:34:28.698561 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:34:28.698717 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
20:34:28.698860 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
20:34:28.703381 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
20:34:28.704365 [debug] [Thread-1  ]: finished collecting timing info
20:34:28.704597 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
20:34:28.707550 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
20:34:28.708099 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:34:28.708253 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
20:34:28.708381 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:34:28.721389 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:34:28.721607 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:34:28.721749 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
20:34:28.733606 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.01 seconds
20:34:28.736590 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:34:28.736792 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
20:34:28.737536 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:34:28.740929 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:34:28.741171 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
20:34:28.741855 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:34:28.743539 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
20:34:28.743694 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:34:28.743828 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
20:34:28.744457 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:34:28.746331 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:34:28.746487 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
20:34:28.748632 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:34:28.749817 [debug] [Thread-1  ]: finished collecting timing info
20:34:28.749998 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
20:34:28.750552 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '403252c6-40b1-4870-a526-7af4894af53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8282ecfd0>]}
20:34:28.750970 [info ] [Thread-1  ]: 3 of 4 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.05s]
20:34:28.751394 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
20:34:28.751593 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
20:34:28.751831 [info ] [Thread-1  ]: 4 of 4 START view model wetube.my_second_dbt_model ............................. [RUN]
20:34:28.752453 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
20:34:28.752620 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
20:34:28.752768 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
20:34:28.755298 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
20:34:28.755778 [debug] [Thread-1  ]: finished collecting timing info
20:34:28.756046 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
20:34:28.779068 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
20:34:28.779825 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:34:28.780000 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
20:34:28.780136 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:34:28.791613 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:34:28.791829 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:34:28.791971 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
20:34:28.795655 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:34:28.798335 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:34:28.798570 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
20:34:28.800398 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:34:28.801833 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
20:34:28.801992 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:34:28.802128 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
20:34:28.802957 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:34:28.804815 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:34:28.804978 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
20:34:28.805336 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:34:28.806501 [debug] [Thread-1  ]: finished collecting timing info
20:34:28.806691 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
20:34:28.807183 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '403252c6-40b1-4870-a526-7af4894af53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8282a0e50>]}
20:34:28.807564 [info ] [Thread-1  ]: 4 of 4 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
20:34:28.807971 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
20:34:28.809066 [debug] [MainThread]: Acquiring new postgres connection "master"
20:34:28.809333 [debug] [MainThread]: Using postgres connection "master"
20:34:28.809484 [debug] [MainThread]: On master: BEGIN
20:34:28.809616 [debug] [MainThread]: Opening a new connection, currently in state closed
20:34:28.819496 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:34:28.819714 [debug] [MainThread]: On master: COMMIT
20:34:28.819952 [debug] [MainThread]: Using postgres connection "master"
20:34:28.820091 [debug] [MainThread]: On master: COMMIT
20:34:28.820342 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:34:28.820506 [debug] [MainThread]: On master: Close
20:34:28.820916 [info ] [MainThread]: 
20:34:28.821175 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0.65s.
20:34:28.821414 [debug] [MainThread]: Connection 'master' was properly closed.
20:34:28.821541 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
20:34:28.828079 [info ] [MainThread]: 
20:34:28.828368 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
20:34:28.828645 [info ] [MainThread]: 
20:34:28.828924 [error] [MainThread]: [33mDatabase Error in model account_information (models/mart/account_information.sql)[0m
20:34:28.829154 [error] [MainThread]:   column "id_user" specified in USING clause does not exist in right table
20:34:28.829366 [error] [MainThread]:   compiled SQL at target/run/dbt_blog/models/mart/account_information.sql
20:34:28.829602 [info ] [MainThread]: 
20:34:28.829822 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
20:34:28.830229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc828261ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8282f9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8282a0e80>]}


============================== 2022-07-22 20:34:42.295027 | a34c5193-02f6-4150-b7bd-3b67dd5dadc5 ==============================
20:34:42.295051 [info ] [MainThread]: Running with dbt=1.1.1
20:34:42.295657 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:34:42.295810 [debug] [MainThread]: Tracking: tracking
20:34:42.322435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83f6f6af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83f6f6340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83f6f1550>]}
20:34:42.389256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
20:34:42.389902 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/account_information.sql
20:34:42.408871 [debug] [MainThread]: 1699: static parser successfully parsed mart/account_information.sql
20:34:42.526462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a34c5193-02f6-4150-b7bd-3b67dd5dadc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83f99b4f0>]}
20:34:42.534758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a34c5193-02f6-4150-b7bd-3b67dd5dadc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83f99bdc0>]}
20:34:42.535086 [info ] [MainThread]: Found 4 models, 16 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
20:34:42.535377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a34c5193-02f6-4150-b7bd-3b67dd5dadc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83f99bbb0>]}
20:34:42.537441 [info ] [MainThread]: 
20:34:42.537913 [debug] [MainThread]: Acquiring new postgres connection "master"
20:34:42.538864 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
20:34:42.551073 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
20:34:42.551288 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
20:34:42.551438 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:34:42.566192 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
20:34:42.567931 [debug] [ThreadPool]: On list_get_dbt: Close
20:34:42.569829 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
20:34:42.577565 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
20:34:42.577763 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
20:34:42.577905 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:34:42.588032 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:34:42.588269 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
20:34:42.588423 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
20:34:42.593413 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
20:34:42.595103 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
20:34:42.595391 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
20:34:42.600649 [debug] [MainThread]: Using postgres connection "master"
20:34:42.600838 [debug] [MainThread]: On master: BEGIN
20:34:42.600982 [debug] [MainThread]: Opening a new connection, currently in state init
20:34:42.611993 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:34:42.612219 [debug] [MainThread]: Using postgres connection "master"
20:34:42.612365 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:34:42.679593 [debug] [MainThread]: SQL status: SELECT 2 in 0.07 seconds
20:34:42.682666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a34c5193-02f6-4150-b7bd-3b67dd5dadc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83f6167c0>]}
20:34:42.683086 [debug] [MainThread]: On master: ROLLBACK
20:34:42.683509 [debug] [MainThread]: Using postgres connection "master"
20:34:42.683813 [debug] [MainThread]: On master: BEGIN
20:34:42.684293 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:34:42.684473 [debug] [MainThread]: On master: COMMIT
20:34:42.684624 [debug] [MainThread]: Using postgres connection "master"
20:34:42.684760 [debug] [MainThread]: On master: COMMIT
20:34:42.685011 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:34:42.685201 [debug] [MainThread]: On master: Close
20:34:42.685567 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:34:42.685838 [info ] [MainThread]: 
20:34:42.690369 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
20:34:42.690675 [info ] [Thread-1  ]: 1 of 4 START table model wetube.account_information ............................ [RUN]
20:34:42.691138 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
20:34:42.691303 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
20:34:42.691460 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
20:34:42.696324 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
20:34:42.696956 [debug] [Thread-1  ]: finished collecting timing info
20:34:42.697203 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
20:34:42.733608 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
20:34:42.734235 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
20:34:42.734393 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
20:34:42.734613 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:34:42.744840 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:34:42.745046 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
20:34:42.745295 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (

    select * from
        "get_dbt"."wetube"."city"

),

source_state as (

    select * from
        "get_dbt"."wetube"."state"

),

source_user_address as (

    select * from
        "get_dbt"."wetube"."user_address"

),

source_account as (

    select * from
        "get_dbt"."wetube"."account"

),

account_info as (

    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name,
        state.name,
        channel.id_channel,
        channel.channel_name as channel,
        channel.creation_date as channel_creation,
        channel.id_account
    FROM source_account account
    	inner join source_channel channel using (id_account)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
20:34:42.746092 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "id_account" specified in USING clause does not exist in left table

20:34:42.746261 [debug] [Thread-1  ]: On model.dbt_blog.account_information: ROLLBACK
20:34:42.746618 [debug] [Thread-1  ]: finished collecting timing info
20:34:42.746788 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
20:34:42.747137 [debug] [Thread-1  ]: Database Error in model account_information (models/mart/account_information.sql)
  column "id_account" specified in USING clause does not exist in left table
  compiled SQL at target/run/dbt_blog/models/mart/account_information.sql
20:34:42.747420 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34c5193-02f6-4150-b7bd-3b67dd5dadc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83fb22850>]}
20:34:42.747784 [error] [Thread-1  ]: 1 of 4 ERROR creating table model wetube.account_information ................... [[31mERROR[0m in 0.06s]
20:34:42.748239 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
20:34:42.748439 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
20:34:42.748670 [info ] [Thread-1  ]: 2 of 4 START table model wetube.my_first_dbt_model ............................. [RUN]
20:34:42.749094 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
20:34:42.749251 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
20:34:42.749401 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
20:34:42.751959 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
20:34:42.752500 [debug] [Thread-1  ]: finished collecting timing info
20:34:42.752670 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
20:34:42.755522 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
20:34:42.756063 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:34:42.756223 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
20:34:42.756357 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:34:42.766108 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:34:42.766444 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:34:42.766706 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
20:34:42.771100 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
20:34:42.779785 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:34:42.780034 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
20:34:42.780719 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:34:42.783357 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:34:42.783528 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
20:34:42.784292 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:34:42.797556 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
20:34:42.797765 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:34:42.797918 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
20:34:42.798630 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:34:42.804165 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:34:42.804332 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
20:34:42.806331 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:34:42.807595 [debug] [Thread-1  ]: finished collecting timing info
20:34:42.807781 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
20:34:42.808191 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34c5193-02f6-4150-b7bd-3b67dd5dadc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83fb33f40>]}
20:34:42.808567 [info ] [Thread-1  ]: 2 of 4 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.06s]
20:34:42.808986 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
20:34:42.809253 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
20:34:42.809521 [info ] [Thread-1  ]: 3 of 4 START table model wetube.number_of_subs_by_channel ...................... [RUN]
20:34:42.809968 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:34:42.810130 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
20:34:42.810281 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
20:34:42.814546 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
20:34:42.815251 [debug] [Thread-1  ]: finished collecting timing info
20:34:42.815430 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
20:34:42.818323 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
20:34:42.818796 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:34:42.818947 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
20:34:42.819078 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:34:42.828099 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:34:42.828307 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:34:42.828448 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
20:34:42.833137 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
20:34:42.836378 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:34:42.836604 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
20:34:42.837343 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:34:42.840218 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:34:42.840532 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
20:34:42.841725 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:34:42.843661 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
20:34:42.843845 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:34:42.843986 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
20:34:42.845702 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:34:42.848495 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:34:42.848733 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
20:34:42.850765 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:34:42.852139 [debug] [Thread-1  ]: finished collecting timing info
20:34:42.852335 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
20:34:42.852760 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34c5193-02f6-4150-b7bd-3b67dd5dadc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83fb374f0>]}
20:34:42.853140 [info ] [Thread-1  ]: 3 of 4 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.04s]
20:34:42.853575 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
20:34:42.853782 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
20:34:42.854012 [info ] [Thread-1  ]: 4 of 4 START view model wetube.my_second_dbt_model ............................. [RUN]
20:34:42.854441 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
20:34:42.854612 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
20:34:42.854768 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
20:34:42.857396 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
20:34:42.857989 [debug] [Thread-1  ]: finished collecting timing info
20:34:42.858166 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
20:34:42.880243 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
20:34:42.880868 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:34:42.881035 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
20:34:42.881171 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:34:42.891716 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:34:42.892056 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:34:42.892231 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
20:34:42.895900 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:34:42.898669 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:34:42.898844 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
20:34:42.899459 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:34:42.900904 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
20:34:42.901078 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:34:42.901219 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
20:34:42.901822 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:34:42.903568 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:34:42.903728 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
20:34:42.904063 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:34:42.905285 [debug] [Thread-1  ]: finished collecting timing info
20:34:42.905498 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
20:34:42.905919 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34c5193-02f6-4150-b7bd-3b67dd5dadc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83fb61fa0>]}
20:34:42.906295 [info ] [Thread-1  ]: 4 of 4 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
20:34:42.906713 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
20:34:42.907863 [debug] [MainThread]: Acquiring new postgres connection "master"
20:34:42.908065 [debug] [MainThread]: Using postgres connection "master"
20:34:42.908210 [debug] [MainThread]: On master: BEGIN
20:34:42.908343 [debug] [MainThread]: Opening a new connection, currently in state closed
20:34:42.918443 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:34:42.918675 [debug] [MainThread]: On master: COMMIT
20:34:42.918827 [debug] [MainThread]: Using postgres connection "master"
20:34:42.918965 [debug] [MainThread]: On master: COMMIT
20:34:42.919211 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:34:42.919380 [debug] [MainThread]: On master: Close
20:34:42.919783 [info ] [MainThread]: 
20:34:42.920050 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0.38s.
20:34:42.920293 [debug] [MainThread]: Connection 'master' was properly closed.
20:34:42.920422 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
20:34:42.927600 [info ] [MainThread]: 
20:34:42.927911 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
20:34:42.928211 [info ] [MainThread]: 
20:34:42.928513 [error] [MainThread]: [33mDatabase Error in model account_information (models/mart/account_information.sql)[0m
20:34:42.928839 [error] [MainThread]:   column "id_account" specified in USING clause does not exist in left table
20:34:42.929070 [error] [MainThread]:   compiled SQL at target/run/dbt_blog/models/mart/account_information.sql
20:34:42.929388 [info ] [MainThread]: 
20:34:42.929626 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
20:34:42.929949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83fb37f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83fb22af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83fbfd3d0>]}


============================== 2022-07-22 20:37:47.423457 | 2f7479aa-3a68-4209-8dd0-a75ce886747a ==============================
20:37:47.423486 [info ] [MainThread]: Running with dbt=1.1.1
20:37:47.424760 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:37:47.425154 [debug] [MainThread]: Tracking: tracking
20:37:47.483621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62c5dda60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62c5dd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62c5da4f0>]}
20:37:47.558933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
20:37:47.559582 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/account_information.sql
20:37:47.580687 [debug] [MainThread]: 1699: static parser successfully parsed mart/account_information.sql
20:37:47.714971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f7479aa-3a68-4209-8dd0-a75ce886747a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62c7830d0>]}
20:37:47.724488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f7479aa-3a68-4209-8dd0-a75ce886747a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62c783dc0>]}
20:37:47.724869 [info ] [MainThread]: Found 4 models, 16 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
20:37:47.725167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f7479aa-3a68-4209-8dd0-a75ce886747a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62c783df0>]}
20:37:47.727711 [info ] [MainThread]: 
20:37:47.728274 [debug] [MainThread]: Acquiring new postgres connection "master"
20:37:47.729355 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
20:37:47.743824 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
20:37:47.744221 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
20:37:47.744441 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:37:47.791000 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.05 seconds
20:37:47.792728 [debug] [ThreadPool]: On list_get_dbt: Close
20:37:47.794227 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
20:37:47.803784 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
20:37:47.804028 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
20:37:47.804182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:37:47.813794 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:37:47.814076 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
20:37:47.814271 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
20:37:47.818628 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
20:37:47.820426 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
20:37:47.820760 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
20:37:47.826005 [debug] [MainThread]: Using postgres connection "master"
20:37:47.826232 [debug] [MainThread]: On master: BEGIN
20:37:47.826381 [debug] [MainThread]: Opening a new connection, currently in state init
20:37:47.836568 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:37:47.836800 [debug] [MainThread]: Using postgres connection "master"
20:37:47.836953 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:37:47.908256 [debug] [MainThread]: SQL status: SELECT 2 in 0.07 seconds
20:37:47.910331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f7479aa-3a68-4209-8dd0-a75ce886747a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62c4ae670>]}
20:37:47.910995 [debug] [MainThread]: On master: ROLLBACK
20:37:47.911516 [debug] [MainThread]: Using postgres connection "master"
20:37:47.911806 [debug] [MainThread]: On master: BEGIN
20:37:47.912391 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:37:47.912783 [debug] [MainThread]: On master: COMMIT
20:37:47.912961 [debug] [MainThread]: Using postgres connection "master"
20:37:47.913153 [debug] [MainThread]: On master: COMMIT
20:37:47.913440 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:37:47.913695 [debug] [MainThread]: On master: Close
20:37:47.914294 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:37:47.914781 [info ] [MainThread]: 
20:37:47.921171 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
20:37:47.921517 [info ] [Thread-1  ]: 1 of 4 START table model wetube.account_information ............................ [RUN]
20:37:47.922059 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
20:37:47.922259 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
20:37:47.922427 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
20:37:47.927928 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
20:37:47.928774 [debug] [Thread-1  ]: finished collecting timing info
20:37:47.928989 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
20:37:47.979884 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
20:37:47.980547 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
20:37:47.980854 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
20:37:47.980999 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:37:47.998688 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
20:37:47.998978 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
20:37:47.999324 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (

    select * from
        "get_dbt"."wetube"."city"

),

source_state as (

    select * from
        "get_dbt"."wetube"."state"

),

source_user_address as (

    select * from
        "get_dbt"."wetube"."user_address"

),

source_account as (

    select * from
        "get_dbt"."wetube"."account"

),

account_info as (

    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name,
        state.name,
        channel.id_channel,
        channel.channel_name as channel,
        channel.creation_date as channel_creation,
        channel.id_account
    FROM source_account account
    	inner join source_channel channel on (channel.id_account = account.id_user)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
20:37:48.005116 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column channel.channel_name does not exist
LINE 50:         channel.channel_name as channel,
                 ^

20:37:48.005360 [debug] [Thread-1  ]: On model.dbt_blog.account_information: ROLLBACK
20:37:48.005751 [debug] [Thread-1  ]: finished collecting timing info
20:37:48.005937 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
20:37:48.006305 [debug] [Thread-1  ]: Database Error in model account_information (models/mart/account_information.sql)
  column channel.channel_name does not exist
  LINE 50:         channel.channel_name as channel,
                   ^
  compiled SQL at target/run/dbt_blog/models/mart/account_information.sql
20:37:48.006603 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f7479aa-3a68-4209-8dd0-a75ce886747a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62ca25850>]}
20:37:48.006970 [error] [Thread-1  ]: 1 of 4 ERROR creating table model wetube.account_information ................... [[31mERROR[0m in 0.08s]
20:37:48.007465 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
20:37:48.007859 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
20:37:48.008655 [info ] [Thread-1  ]: 2 of 4 START table model wetube.my_first_dbt_model ............................. [RUN]
20:37:48.009549 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
20:37:48.009781 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
20:37:48.009941 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
20:37:48.012632 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
20:37:48.013170 [debug] [Thread-1  ]: finished collecting timing info
20:37:48.013424 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
20:37:48.018368 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
20:37:48.019334 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:37:48.019586 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
20:37:48.019734 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:37:48.030450 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:37:48.030690 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:37:48.030843 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
20:37:48.041682 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
20:37:48.051261 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:37:48.051616 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
20:37:48.052873 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:37:48.055467 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:37:48.055639 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
20:37:48.056214 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:37:48.074033 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
20:37:48.074275 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:37:48.074426 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
20:37:48.075255 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:37:48.081717 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:37:48.082106 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
20:37:48.085517 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:37:48.086882 [debug] [Thread-1  ]: finished collecting timing info
20:37:48.087078 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
20:37:48.087552 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f7479aa-3a68-4209-8dd0-a75ce886747a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62ca4dc40>]}
20:37:48.087983 [info ] [Thread-1  ]: 2 of 4 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.08s]
20:37:48.088531 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
20:37:48.088999 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
20:37:48.089436 [info ] [Thread-1  ]: 3 of 4 START table model wetube.number_of_subs_by_channel ...................... [RUN]
20:37:48.090837 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:37:48.091152 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
20:37:48.091427 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
20:37:48.097716 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
20:37:48.098575 [debug] [Thread-1  ]: finished collecting timing info
20:37:48.098970 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
20:37:48.104172 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
20:37:48.105967 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:37:48.106516 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
20:37:48.107210 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:37:48.120461 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:37:48.121113 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:37:48.121443 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
20:37:48.136956 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.02 seconds
20:37:48.139883 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:37:48.140069 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
20:37:48.141640 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:37:48.145136 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:37:48.145375 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
20:37:48.146336 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:37:48.148205 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
20:37:48.148378 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:37:48.148534 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
20:37:48.149392 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:37:48.152965 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:37:48.153196 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
20:37:48.157077 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:37:48.158745 [debug] [Thread-1  ]: finished collecting timing info
20:37:48.158998 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
20:37:48.159463 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f7479aa-3a68-4209-8dd0-a75ce886747a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62caabfd0>]}
20:37:48.159854 [info ] [Thread-1  ]: 3 of 4 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.07s]
20:37:48.160293 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
20:37:48.160516 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
20:37:48.160851 [info ] [Thread-1  ]: 4 of 4 START view model wetube.my_second_dbt_model ............................. [RUN]
20:37:48.161326 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
20:37:48.161497 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
20:37:48.161654 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
20:37:48.165053 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
20:37:48.165743 [debug] [Thread-1  ]: finished collecting timing info
20:37:48.166078 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
20:37:48.195306 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
20:37:48.196899 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:37:48.197158 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
20:37:48.197326 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:37:48.210446 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:37:48.210748 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:37:48.210899 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
20:37:48.217048 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
20:37:48.220169 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:37:48.220700 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
20:37:48.221456 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:37:48.223862 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
20:37:48.224126 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:37:48.224274 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
20:37:48.227463 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:37:48.230529 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:37:48.230761 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
20:37:48.231213 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:37:48.232583 [debug] [Thread-1  ]: finished collecting timing info
20:37:48.232928 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
20:37:48.233366 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f7479aa-3a68-4209-8dd0-a75ce886747a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62ca4de80>]}
20:37:48.233747 [info ] [Thread-1  ]: 4 of 4 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
20:37:48.234402 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
20:37:48.235468 [debug] [MainThread]: Acquiring new postgres connection "master"
20:37:48.235662 [debug] [MainThread]: Using postgres connection "master"
20:37:48.235822 [debug] [MainThread]: On master: BEGIN
20:37:48.236096 [debug] [MainThread]: Opening a new connection, currently in state closed
20:37:48.264530 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
20:37:48.265211 [debug] [MainThread]: On master: COMMIT
20:37:48.265466 [debug] [MainThread]: Using postgres connection "master"
20:37:48.265633 [debug] [MainThread]: On master: COMMIT
20:37:48.266302 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:37:48.266578 [debug] [MainThread]: On master: Close
20:37:48.267298 [info ] [MainThread]: 
20:37:48.267810 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0.54s.
20:37:48.268087 [debug] [MainThread]: Connection 'master' was properly closed.
20:37:48.268303 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
20:37:48.275832 [info ] [MainThread]: 
20:37:48.276154 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
20:37:48.276442 [info ] [MainThread]: 
20:37:48.276730 [error] [MainThread]: [33mDatabase Error in model account_information (models/mart/account_information.sql)[0m
20:37:48.276975 [error] [MainThread]:   column channel.channel_name does not exist
20:37:48.277198 [error] [MainThread]:   LINE 50:         channel.channel_name as channel,
20:37:48.277478 [error] [MainThread]:                    ^
20:37:48.277743 [error] [MainThread]:   compiled SQL at target/run/dbt_blog/models/mart/account_information.sql
20:37:48.277989 [info ] [MainThread]: 
20:37:48.278223 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
20:37:48.278551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62c7e1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62c7e1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62ca602e0>]}


============================== 2022-07-22 20:38:46.452591 | 582fcfe8-7169-402c-b9b7-957d43b70b2b ==============================
20:38:46.452623 [info ] [MainThread]: Running with dbt=1.1.1
20:38:46.453461 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:38:46.453729 [debug] [MainThread]: Tracking: tracking
20:38:46.486552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b3ddda60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b3ddd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b3dda4f0>]}
20:38:46.558413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
20:38:46.559052 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/account_information.sql
20:38:46.584102 [debug] [MainThread]: 1699: static parser successfully parsed mart/account_information.sql
20:38:46.718970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '582fcfe8-7169-402c-b9b7-957d43b70b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b409c0d0>]}
20:38:46.728052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '582fcfe8-7169-402c-b9b7-957d43b70b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b409cdc0>]}
20:38:46.728421 [info ] [MainThread]: Found 4 models, 16 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
20:38:46.728769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '582fcfe8-7169-402c-b9b7-957d43b70b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b409cdf0>]}
20:38:46.731189 [info ] [MainThread]: 
20:38:46.731794 [debug] [MainThread]: Acquiring new postgres connection "master"
20:38:46.732900 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
20:38:46.747656 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
20:38:46.747905 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
20:38:46.748413 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:38:46.786116 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.04 seconds
20:38:46.787775 [debug] [ThreadPool]: On list_get_dbt: Close
20:38:46.789081 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
20:38:46.796888 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
20:38:46.797099 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
20:38:46.797240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:38:46.807695 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:38:46.807921 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
20:38:46.808065 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
20:38:46.811790 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
20:38:46.813419 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
20:38:46.813698 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
20:38:46.818871 [debug] [MainThread]: Using postgres connection "master"
20:38:46.819088 [debug] [MainThread]: On master: BEGIN
20:38:46.819230 [debug] [MainThread]: Opening a new connection, currently in state init
20:38:46.829107 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:38:46.829348 [debug] [MainThread]: Using postgres connection "master"
20:38:46.829498 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:38:46.875083 [debug] [MainThread]: SQL status: SELECT 2 in 0.05 seconds
20:38:46.876520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '582fcfe8-7169-402c-b9b7-957d43b70b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b3cfe100>]}
20:38:46.876833 [debug] [MainThread]: On master: ROLLBACK
20:38:46.877132 [debug] [MainThread]: Using postgres connection "master"
20:38:46.877315 [debug] [MainThread]: On master: BEGIN
20:38:46.877636 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:38:46.877797 [debug] [MainThread]: On master: COMMIT
20:38:46.877943 [debug] [MainThread]: Using postgres connection "master"
20:38:46.878072 [debug] [MainThread]: On master: COMMIT
20:38:46.878301 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:38:46.878476 [debug] [MainThread]: On master: Close
20:38:46.878840 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:38:46.879109 [info ] [MainThread]: 
20:38:46.883594 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
20:38:46.883906 [info ] [Thread-1  ]: 1 of 4 START table model wetube.account_information ............................ [RUN]
20:38:46.884383 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
20:38:46.884560 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
20:38:46.884719 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
20:38:46.890029 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
20:38:46.890736 [debug] [Thread-1  ]: finished collecting timing info
20:38:46.891016 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
20:38:46.929907 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
20:38:46.930567 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
20:38:46.930735 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
20:38:46.930873 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:38:46.942632 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:38:46.942844 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
20:38:46.942999 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (

    select * from
        "get_dbt"."wetube"."city"

),

source_state as (

    select * from
        "get_dbt"."wetube"."state"

),

source_user_address as (

    select * from
        "get_dbt"."wetube"."user_address"

),

source_account as (

    select * from
        "get_dbt"."wetube"."account"

),

account_info as (

    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name,
        state.name,
        channel.id_channel,
        channel.name as channel,
        channel.creation_date as channel_creation,
        channel.id_account
    FROM source_account account
    	inner join source_channel channel on (channel.id_account = account.id_user)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
20:38:46.952995 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "id_account" specified more than once

20:38:46.953208 [debug] [Thread-1  ]: On model.dbt_blog.account_information: ROLLBACK
20:38:46.953583 [debug] [Thread-1  ]: finished collecting timing info
20:38:46.953772 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
20:38:46.954135 [debug] [Thread-1  ]: Database Error in model account_information (models/mart/account_information.sql)
  column "id_account" specified more than once
  compiled SQL at target/run/dbt_blog/models/mart/account_information.sql
20:38:46.954424 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '582fcfe8-7169-402c-b9b7-957d43b70b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b4222850>]}
20:38:46.954925 [error] [Thread-1  ]: 1 of 4 ERROR creating table model wetube.account_information ................... [[31mERROR[0m in 0.07s]
20:38:46.955416 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
20:38:46.955622 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
20:38:46.955859 [info ] [Thread-1  ]: 2 of 4 START table model wetube.my_first_dbt_model ............................. [RUN]
20:38:46.956298 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
20:38:46.956635 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
20:38:46.956843 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
20:38:46.959483 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
20:38:46.960909 [debug] [Thread-1  ]: finished collecting timing info
20:38:46.961092 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
20:38:46.964088 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
20:38:46.964552 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:38:46.964707 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
20:38:46.964840 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:38:46.974096 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:38:46.974329 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:38:46.974486 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
20:38:46.986218 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
20:38:46.995663 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:38:46.996014 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
20:38:46.996994 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:38:47.000533 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:38:47.000768 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
20:38:47.001546 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:38:47.015970 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
20:38:47.016212 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:38:47.016360 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
20:38:47.025832 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
20:38:47.032054 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:38:47.032295 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
20:38:47.035750 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:38:47.037225 [debug] [Thread-1  ]: finished collecting timing info
20:38:47.037431 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
20:38:47.037859 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '582fcfe8-7169-402c-b9b7-957d43b70b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b4232f70>]}
20:38:47.038236 [info ] [Thread-1  ]: 2 of 4 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.08s]
20:38:47.038656 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
20:38:47.038855 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
20:38:47.039312 [info ] [Thread-1  ]: 3 of 4 START table model wetube.number_of_subs_by_channel ...................... [RUN]
20:38:47.039776 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:38:47.039938 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
20:38:47.040088 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
20:38:47.044622 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
20:38:47.045329 [debug] [Thread-1  ]: finished collecting timing info
20:38:47.045691 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
20:38:47.049056 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
20:38:47.049723 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:38:47.049963 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
20:38:47.050267 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:38:47.066070 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
20:38:47.066442 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:38:47.066614 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
20:38:47.081628 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.01 seconds
20:38:47.084535 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:38:47.084718 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
20:38:47.085265 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:38:47.087785 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:38:47.087967 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
20:38:47.088681 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:38:47.090373 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
20:38:47.090539 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:38:47.090683 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
20:38:47.091248 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:38:47.093362 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:38:47.093600 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
20:38:47.096145 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:38:47.097458 [debug] [Thread-1  ]: finished collecting timing info
20:38:47.097655 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
20:38:47.098077 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '582fcfe8-7169-402c-b9b7-957d43b70b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b4208d90>]}
20:38:47.098457 [info ] [Thread-1  ]: 3 of 4 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.06s]
20:38:47.098989 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
20:38:47.099227 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
20:38:47.099475 [info ] [Thread-1  ]: 4 of 4 START view model wetube.my_second_dbt_model ............................. [RUN]
20:38:47.099932 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
20:38:47.100187 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
20:38:47.100370 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
20:38:47.103164 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
20:38:47.104536 [debug] [Thread-1  ]: finished collecting timing info
20:38:47.104730 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
20:38:47.149552 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
20:38:47.150240 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:38:47.150452 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
20:38:47.150610 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:38:47.160222 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:38:47.160553 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:38:47.160950 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
20:38:47.164273 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:38:47.166997 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:38:47.167173 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
20:38:47.167673 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:38:47.169112 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
20:38:47.169284 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:38:47.169434 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
20:38:47.170025 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:38:47.171841 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:38:47.172000 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
20:38:47.172348 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:38:47.173607 [debug] [Thread-1  ]: finished collecting timing info
20:38:47.173828 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
20:38:47.174250 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '582fcfe8-7169-402c-b9b7-957d43b70b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b4261fd0>]}
20:38:47.174857 [info ] [Thread-1  ]: 4 of 4 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
20:38:47.175478 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
20:38:47.176655 [debug] [MainThread]: Acquiring new postgres connection "master"
20:38:47.176875 [debug] [MainThread]: Using postgres connection "master"
20:38:47.177022 [debug] [MainThread]: On master: BEGIN
20:38:47.177154 [debug] [MainThread]: Opening a new connection, currently in state closed
20:38:47.188254 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:38:47.188788 [debug] [MainThread]: On master: COMMIT
20:38:47.188974 [debug] [MainThread]: Using postgres connection "master"
20:38:47.189128 [debug] [MainThread]: On master: COMMIT
20:38:47.189426 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:38:47.189609 [debug] [MainThread]: On master: Close
20:38:47.190156 [info ] [MainThread]: 
20:38:47.190746 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0.46s.
20:38:47.191233 [debug] [MainThread]: Connection 'master' was properly closed.
20:38:47.191493 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
20:38:47.203220 [info ] [MainThread]: 
20:38:47.203615 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
20:38:47.203909 [info ] [MainThread]: 
20:38:47.204156 [error] [MainThread]: [33mDatabase Error in model account_information (models/mart/account_information.sql)[0m
20:38:47.204400 [error] [MainThread]:   column "id_account" specified more than once
20:38:47.204626 [error] [MainThread]:   compiled SQL at target/run/dbt_blog/models/mart/account_information.sql
20:38:47.204869 [info ] [MainThread]: 
20:38:47.205104 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
20:38:47.205451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b428beb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b4222af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b42c2400>]}


============================== 2022-07-22 20:39:09.638471 | 26c5cbfe-6583-419c-8305-45db900133ed ==============================
20:39:09.638496 [info ] [MainThread]: Running with dbt=1.1.1
20:39:09.639094 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:39:09.639231 [debug] [MainThread]: Tracking: tracking
20:39:09.661737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bcf31ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bcf31700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bcf70190>]}
20:39:09.729921 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
20:39:09.730485 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/account_information.sql
20:39:09.748737 [debug] [MainThread]: 1699: static parser successfully parsed mart/account_information.sql
20:39:09.856987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26c5cbfe-6583-419c-8305-45db900133ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bd0cf9a0>]}
20:39:09.865247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26c5cbfe-6583-419c-8305-45db900133ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bd0cfe80>]}
20:39:09.865663 [info ] [MainThread]: Found 4 models, 16 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
20:39:09.865995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26c5cbfe-6583-419c-8305-45db900133ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bd0cf280>]}
20:39:09.868086 [info ] [MainThread]: 
20:39:09.868586 [debug] [MainThread]: Acquiring new postgres connection "master"
20:39:09.869532 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
20:39:09.881645 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
20:39:09.881942 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
20:39:09.882100 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:39:09.927163 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.05 seconds
20:39:09.939495 [debug] [ThreadPool]: On list_get_dbt: Close
20:39:09.941067 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
20:39:09.948468 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
20:39:09.948659 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
20:39:09.948801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:39:09.959219 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:39:09.959441 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
20:39:09.959604 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
20:39:09.964260 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
20:39:09.965967 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
20:39:09.966264 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
20:39:09.971369 [debug] [MainThread]: Using postgres connection "master"
20:39:09.971556 [debug] [MainThread]: On master: BEGIN
20:39:09.971698 [debug] [MainThread]: Opening a new connection, currently in state init
20:39:09.981798 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:39:09.982006 [debug] [MainThread]: Using postgres connection "master"
20:39:09.982151 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:39:10.045358 [debug] [MainThread]: SQL status: SELECT 2 in 0.06 seconds
20:39:10.047334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26c5cbfe-6583-419c-8305-45db900133ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bcd22040>]}
20:39:10.047728 [debug] [MainThread]: On master: ROLLBACK
20:39:10.048160 [debug] [MainThread]: Using postgres connection "master"
20:39:10.048373 [debug] [MainThread]: On master: BEGIN
20:39:10.048784 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:39:10.048981 [debug] [MainThread]: On master: COMMIT
20:39:10.049222 [debug] [MainThread]: Using postgres connection "master"
20:39:10.049419 [debug] [MainThread]: On master: COMMIT
20:39:10.049781 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:39:10.050013 [debug] [MainThread]: On master: Close
20:39:10.050458 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:39:10.050821 [info ] [MainThread]: 
20:39:10.055078 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
20:39:10.055378 [info ] [Thread-1  ]: 1 of 4 START table model wetube.account_information ............................ [RUN]
20:39:10.055842 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
20:39:10.056004 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
20:39:10.056163 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
20:39:10.060575 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
20:39:10.061091 [debug] [Thread-1  ]: finished collecting timing info
20:39:10.061274 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
20:39:10.097454 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
20:39:10.098301 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
20:39:10.098503 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
20:39:10.098655 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:39:10.109799 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:39:10.110032 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
20:39:10.110182 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (

    select * from
        "get_dbt"."wetube"."city"

),

source_state as (

    select * from
        "get_dbt"."wetube"."state"

),

source_user_address as (

    select * from
        "get_dbt"."wetube"."user_address"

),

source_account as (

    select * from
        "get_dbt"."wetube"."account"

),

account_info as (

    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name,
        state.name,
        channel.id_channel,
        channel.name as channel,
        channel.creation_date as channel_creation
    FROM source_account account
    	inner join source_channel channel on (channel.id_account = account.id_user)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
20:39:10.113532 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "name" specified more than once

20:39:10.113726 [debug] [Thread-1  ]: On model.dbt_blog.account_information: ROLLBACK
20:39:10.114099 [debug] [Thread-1  ]: finished collecting timing info
20:39:10.114286 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
20:39:10.114725 [debug] [Thread-1  ]: Database Error in model account_information (models/mart/account_information.sql)
  column "name" specified more than once
  compiled SQL at target/run/dbt_blog/models/mart/account_information.sql
20:39:10.115057 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26c5cbfe-6583-419c-8305-45db900133ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bd3627f0>]}
20:39:10.115441 [error] [Thread-1  ]: 1 of 4 ERROR creating table model wetube.account_information ................... [[31mERROR[0m in 0.06s]
20:39:10.115961 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
20:39:10.116193 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
20:39:10.116627 [info ] [Thread-1  ]: 2 of 4 START table model wetube.my_first_dbt_model ............................. [RUN]
20:39:10.117115 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
20:39:10.117277 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
20:39:10.117459 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
20:39:10.120562 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
20:39:10.121098 [debug] [Thread-1  ]: finished collecting timing info
20:39:10.121301 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
20:39:10.124611 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
20:39:10.125214 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:39:10.125488 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
20:39:10.125667 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:39:10.139410 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:39:10.139660 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:39:10.139822 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
20:39:10.144839 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
20:39:10.153319 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:39:10.153795 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
20:39:10.154762 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:39:10.157922 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:39:10.158220 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
20:39:10.159281 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:39:10.174257 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
20:39:10.174483 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:39:10.174629 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
20:39:10.176415 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:39:10.182918 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
20:39:10.183423 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
20:39:10.187124 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:39:10.188539 [debug] [Thread-1  ]: finished collecting timing info
20:39:10.188735 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
20:39:10.189144 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26c5cbfe-6583-419c-8305-45db900133ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bd38cbb0>]}
20:39:10.189515 [info ] [Thread-1  ]: 2 of 4 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.07s]
20:39:10.189925 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
20:39:10.190123 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
20:39:10.190351 [info ] [Thread-1  ]: 3 of 4 START table model wetube.number_of_subs_by_channel ...................... [RUN]
20:39:10.190772 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:39:10.191171 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
20:39:10.191349 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
20:39:10.195654 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
20:39:10.196153 [debug] [Thread-1  ]: finished collecting timing info
20:39:10.196405 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
20:39:10.199673 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
20:39:10.200298 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:39:10.200479 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
20:39:10.200622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:39:10.209989 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:39:10.210216 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:39:10.210363 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
20:39:10.215088 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
20:39:10.218598 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:39:10.218828 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
20:39:10.220201 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:39:10.223572 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:39:10.223812 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
20:39:10.224638 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:39:10.226412 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
20:39:10.226655 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:39:10.226816 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
20:39:10.227679 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:39:10.230142 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
20:39:10.230368 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
20:39:10.232687 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:39:10.234201 [debug] [Thread-1  ]: finished collecting timing info
20:39:10.234450 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
20:39:10.235026 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26c5cbfe-6583-419c-8305-45db900133ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bd376490>]}
20:39:10.235469 [info ] [Thread-1  ]: 3 of 4 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.04s]
20:39:10.236221 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
20:39:10.236703 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
20:39:10.237336 [info ] [Thread-1  ]: 4 of 4 START view model wetube.my_second_dbt_model ............................. [RUN]
20:39:10.238303 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
20:39:10.238600 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
20:39:10.238926 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
20:39:10.242080 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
20:39:10.242648 [debug] [Thread-1  ]: finished collecting timing info
20:39:10.242829 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
20:39:10.271004 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
20:39:10.271692 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:39:10.271918 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
20:39:10.272111 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:39:10.282242 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:39:10.298043 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:39:10.298321 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
20:39:10.301050 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:39:10.303746 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:39:10.303930 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
20:39:10.304422 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:39:10.305826 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
20:39:10.305993 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:39:10.306134 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
20:39:10.306724 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:39:10.308648 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
20:39:10.308817 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
20:39:10.309229 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:39:10.310446 [debug] [Thread-1  ]: finished collecting timing info
20:39:10.310641 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
20:39:10.311055 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26c5cbfe-6583-419c-8305-45db900133ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bd38cdf0>]}
20:39:10.311429 [info ] [Thread-1  ]: 4 of 4 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
20:39:10.311850 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
20:39:10.313124 [debug] [MainThread]: Acquiring new postgres connection "master"
20:39:10.313332 [debug] [MainThread]: Using postgres connection "master"
20:39:10.313477 [debug] [MainThread]: On master: BEGIN
20:39:10.313686 [debug] [MainThread]: Opening a new connection, currently in state closed
20:39:10.323867 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:39:10.324114 [debug] [MainThread]: On master: COMMIT
20:39:10.324353 [debug] [MainThread]: Using postgres connection "master"
20:39:10.324523 [debug] [MainThread]: On master: COMMIT
20:39:10.324783 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:39:10.324952 [debug] [MainThread]: On master: Close
20:39:10.325471 [info ] [MainThread]: 
20:39:10.325773 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0.46s.
20:39:10.326156 [debug] [MainThread]: Connection 'master' was properly closed.
20:39:10.326304 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
20:39:10.335777 [info ] [MainThread]: 
20:39:10.336171 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
20:39:10.336527 [info ] [MainThread]: 
20:39:10.336772 [error] [MainThread]: [33mDatabase Error in model account_information (models/mart/account_information.sql)[0m
20:39:10.337011 [error] [MainThread]:   column "name" specified more than once
20:39:10.337233 [error] [MainThread]:   compiled SQL at target/run/dbt_blog/models/mart/account_information.sql
20:39:10.337494 [info ] [MainThread]: 
20:39:10.337763 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
20:39:10.338161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bd362a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bd362a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bd403820>]}


============================== 2022-07-23 22:20:33.878132 | 3362fb3a-49c2-4f25-996b-5acf8c898018 ==============================
22:20:33.878155 [info ] [MainThread]: Running with dbt=1.1.1
22:20:33.879262 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
22:20:33.879517 [debug] [MainThread]: Tracking: tracking
22:20:33.915243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9955836af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9955836340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9955831550>]}
22:20:33.986550 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
22:20:33.987345 [debug] [MainThread]: Partial parsing: update schema file: dbt_blog://models/mart/schema.yml
22:20:33.987578 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/account_information.sql
22:20:34.007243 [debug] [MainThread]: 1699: static parser successfully parsed mart/account_information.sql
22:20:34.115817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3362fb3a-49c2-4f25-996b-5acf8c898018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f995428ef70>]}
22:20:34.123895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3362fb3a-49c2-4f25-996b-5acf8c898018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f995428ebe0>]}
22:20:34.124202 [info ] [MainThread]: Found 4 models, 16 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
22:20:34.124478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3362fb3a-49c2-4f25-996b-5acf8c898018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f995428eca0>]}
22:20:34.126422 [info ] [MainThread]: 
22:20:34.126862 [debug] [MainThread]: Acquiring new postgres connection "master"
22:20:34.127736 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
22:20:34.139020 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
22:20:34.139230 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
22:20:34.139372 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:20:34.218443 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.08 seconds
22:20:34.220004 [debug] [ThreadPool]: On list_get_dbt: Close
22:20:34.221331 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
22:20:34.228531 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
22:20:34.228707 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
22:20:34.228844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:20:34.245561 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
22:20:34.245804 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
22:20:34.245965 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
22:20:34.277664 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.03 seconds
22:20:34.279680 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
22:20:34.280038 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
22:20:34.285088 [debug] [MainThread]: Using postgres connection "master"
22:20:34.285270 [debug] [MainThread]: On master: BEGIN
22:20:34.285413 [debug] [MainThread]: Opening a new connection, currently in state init
22:20:34.294839 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:20:34.295056 [debug] [MainThread]: Using postgres connection "master"
22:20:34.295207 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:20:34.353834 [debug] [MainThread]: SQL status: SELECT 2 in 0.06 seconds
22:20:34.355224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3362fb3a-49c2-4f25-996b-5acf8c898018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99552f00a0>]}
22:20:34.355503 [debug] [MainThread]: On master: ROLLBACK
22:20:34.355758 [debug] [MainThread]: Using postgres connection "master"
22:20:34.355890 [debug] [MainThread]: On master: BEGIN
22:20:34.356230 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:20:34.356380 [debug] [MainThread]: On master: COMMIT
22:20:34.356511 [debug] [MainThread]: Using postgres connection "master"
22:20:34.356628 [debug] [MainThread]: On master: COMMIT
22:20:34.356853 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:20:34.356996 [debug] [MainThread]: On master: Close
22:20:34.357301 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
22:20:34.357529 [info ] [MainThread]: 
22:20:34.361654 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
22:20:34.361962 [info ] [Thread-1  ]: 1 of 4 START table model wetube.account_information ............................ [RUN]
22:20:34.362393 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
22:20:34.362533 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
22:20:34.362672 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
22:20:34.366861 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
22:20:34.367975 [debug] [Thread-1  ]: finished collecting timing info
22:20:34.368151 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
22:20:34.404177 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
22:20:34.405319 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
22:20:34.405522 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
22:20:34.405671 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:20:34.415221 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:20:34.415442 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
22:20:34.415586 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (

    select * from
        "get_dbt"."wetube"."city"

),

source_state as (

    select * from
        "get_dbt"."wetube"."state"

),

source_user_address as (

    select * from
        "get_dbt"."wetube"."user_address"

),

source_account as (

    select * from
        "get_dbt"."wetube"."account"

),

account_info as (

    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name as city_name,
        state.name as state_name,
        channel.id_channel,
        channel.name as channel,
        channel.creation_date as channel_creation
    FROM source_account account
    	inner join source_channel channel on (channel.id_account = account.id_user)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
22:20:34.457864 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.04 seconds
22:20:34.464865 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
22:20:34.465063 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information__dbt_tmp" rename to "account_information"
22:20:34.466570 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:20:34.479684 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
22:20:34.479886 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
22:20:34.480027 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
22:20:34.481985 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:20:34.487504 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
22:20:34.487730 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
drop table if exists "get_dbt"."wetube"."account_information__dbt_backup" cascade
22:20:34.488203 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
22:20:34.489436 [debug] [Thread-1  ]: finished collecting timing info
22:20:34.489618 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
22:20:34.490050 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3362fb3a-49c2-4f25-996b-5acf8c898018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9955cb2040>]}
22:20:34.490417 [info ] [Thread-1  ]: 1 of 4 OK created table model wetube.account_information ....................... [[32mSELECT 5[0m in 0.13s]
22:20:34.490868 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
22:20:34.491068 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
22:20:34.491294 [info ] [Thread-1  ]: 2 of 4 START table model wetube.my_first_dbt_model ............................. [RUN]
22:20:34.491785 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
22:20:34.491951 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
22:20:34.492104 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
22:20:34.494888 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
22:20:34.495692 [debug] [Thread-1  ]: finished collecting timing info
22:20:34.495871 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
22:20:34.499020 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
22:20:34.499633 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
22:20:34.499808 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
22:20:34.499951 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:20:34.512148 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:20:34.512375 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
22:20:34.512519 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
22:20:34.518685 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
22:20:34.522404 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
22:20:34.522664 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
22:20:34.524468 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:20:34.527635 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
22:20:34.527978 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
22:20:34.528685 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:20:34.531964 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
22:20:34.532256 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
22:20:34.532440 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
22:20:34.534046 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:20:34.535996 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
22:20:34.536166 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
22:20:34.572170 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.04 seconds
22:20:34.573715 [debug] [Thread-1  ]: finished collecting timing info
22:20:34.573919 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
22:20:34.574334 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3362fb3a-49c2-4f25-996b-5acf8c898018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9955cd1490>]}
22:20:34.574689 [info ] [Thread-1  ]: 2 of 4 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.08s]
22:20:34.575095 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
22:20:34.575292 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
22:20:34.575517 [info ] [Thread-1  ]: 3 of 4 START table model wetube.number_of_subs_by_channel ...................... [RUN]
22:20:34.575937 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
22:20:34.576095 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
22:20:34.576251 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
22:20:34.579429 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
22:20:34.579943 [debug] [Thread-1  ]: finished collecting timing info
22:20:34.580119 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
22:20:34.583245 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
22:20:34.583866 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
22:20:34.584027 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
22:20:34.584160 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:20:34.593677 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:20:34.593918 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
22:20:34.594069 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
22:20:34.606171 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.01 seconds
22:20:34.609272 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
22:20:34.609574 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
22:20:34.617801 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
22:20:34.620472 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
22:20:34.620650 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
22:20:34.621341 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:20:34.623053 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
22:20:34.623225 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
22:20:34.623369 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
22:20:34.627905 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:20:34.629810 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
22:20:34.629975 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
22:20:34.631728 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
22:20:34.633053 [debug] [Thread-1  ]: finished collecting timing info
22:20:34.633258 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
22:20:34.633687 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3362fb3a-49c2-4f25-996b-5acf8c898018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99552e98e0>]}
22:20:34.634065 [info ] [Thread-1  ]: 3 of 4 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.06s]
22:20:34.634544 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
22:20:34.634796 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
22:20:34.635149 [info ] [Thread-1  ]: 4 of 4 START view model wetube.my_second_dbt_model ............................. [RUN]
22:20:34.635615 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
22:20:34.635773 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
22:20:34.635922 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
22:20:34.638583 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
22:20:34.639294 [debug] [Thread-1  ]: finished collecting timing info
22:20:34.639484 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
22:20:34.667286 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
22:20:34.667925 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
22:20:34.668088 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
22:20:34.668219 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:20:34.677498 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:20:34.677718 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
22:20:34.677863 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
22:20:34.682734 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
22:20:34.685377 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
22:20:34.685540 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
22:20:34.688092 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:20:34.689643 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
22:20:34.689805 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
22:20:34.689941 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
22:20:34.690687 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:20:34.692466 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
22:20:34.692622 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
22:20:34.693451 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
22:20:34.694767 [debug] [Thread-1  ]: finished collecting timing info
22:20:34.694979 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
22:20:34.695389 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3362fb3a-49c2-4f25-996b-5acf8c898018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9955ce1fa0>]}
22:20:34.695825 [info ] [Thread-1  ]: 4 of 4 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
22:20:34.696271 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
22:20:34.697434 [debug] [MainThread]: Acquiring new postgres connection "master"
22:20:34.697626 [debug] [MainThread]: Using postgres connection "master"
22:20:34.697769 [debug] [MainThread]: On master: BEGIN
22:20:34.697899 [debug] [MainThread]: Opening a new connection, currently in state closed
22:20:34.707223 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:20:34.707470 [debug] [MainThread]: On master: COMMIT
22:20:34.707617 [debug] [MainThread]: Using postgres connection "master"
22:20:34.707760 [debug] [MainThread]: On master: COMMIT
22:20:34.708023 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:20:34.708220 [debug] [MainThread]: On master: Close
22:20:34.708918 [info ] [MainThread]: 
22:20:34.709211 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0.58s.
22:20:34.709453 [debug] [MainThread]: Connection 'master' was properly closed.
22:20:34.709596 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
22:20:34.717051 [info ] [MainThread]: 
22:20:34.717463 [info ] [MainThread]: [32mCompleted successfully[0m
22:20:34.717774 [info ] [MainThread]: 
22:20:34.718010 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
22:20:34.718363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f995428ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f995428ee20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9955c36f70>]}


============================== 2022-07-23 22:35:11.556585 | 53e6a195-42d7-4b39-a87a-b98e38ddb5e1 ==============================
22:35:11.556611 [info ] [MainThread]: Running with dbt=1.1.1
22:35:11.557849 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
22:35:11.558030 [debug] [MainThread]: Tracking: tracking
22:35:11.588042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4907d41f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4907d4d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4909301c0>]}
22:35:11.657227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
22:35:11.658101 [debug] [MainThread]: Partial parsing: update schema file: dbt_blog://models/mart/schema.yml
22:35:11.658363 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/account_information.sql
22:35:11.676870 [debug] [MainThread]: 1699: static parser successfully parsed mart/account_information.sql
22:35:11.807225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53e6a195-42d7-4b39-a87a-b98e38ddb5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa490682610>]}
22:35:11.815883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e6a195-42d7-4b39-a87a-b98e38ddb5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4909eb670>]}
22:35:11.816225 [info ] [MainThread]: Found 4 models, 16 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
22:35:11.816514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53e6a195-42d7-4b39-a87a-b98e38ddb5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4903728b0>]}
22:35:11.818555 [info ] [MainThread]: 
22:35:11.819031 [debug] [MainThread]: Acquiring new postgres connection "master"
22:35:11.820041 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
22:35:11.832785 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
22:35:11.833027 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
22:35:11.833180 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:35:11.890873 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.06 seconds
22:35:11.892470 [debug] [ThreadPool]: On list_get_dbt: Close
22:35:11.893740 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
22:35:11.900904 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
22:35:11.901094 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
22:35:11.901280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:35:11.912216 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:35:11.912441 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
22:35:11.912586 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
22:35:11.921467 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.01 seconds
22:35:11.923182 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
22:35:11.923468 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
22:35:11.928997 [debug] [MainThread]: Using postgres connection "master"
22:35:11.929189 [debug] [MainThread]: On master: BEGIN
22:35:11.929333 [debug] [MainThread]: Opening a new connection, currently in state init
22:35:11.938718 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:35:11.938926 [debug] [MainThread]: Using postgres connection "master"
22:35:11.939082 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:35:11.989083 [debug] [MainThread]: SQL status: SELECT 2 in 0.05 seconds
22:35:11.990385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53e6a195-42d7-4b39-a87a-b98e38ddb5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4907d4af0>]}
22:35:11.990715 [debug] [MainThread]: On master: ROLLBACK
22:35:11.990981 [debug] [MainThread]: Using postgres connection "master"
22:35:11.991117 [debug] [MainThread]: On master: BEGIN
22:35:11.991440 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:35:11.991592 [debug] [MainThread]: On master: COMMIT
22:35:11.991721 [debug] [MainThread]: Using postgres connection "master"
22:35:11.991839 [debug] [MainThread]: On master: COMMIT
22:35:11.992053 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:35:11.992196 [debug] [MainThread]: On master: Close
22:35:11.992500 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
22:35:11.992726 [info ] [MainThread]: 
22:35:11.996860 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
22:35:11.997122 [info ] [Thread-1  ]: 1 of 4 START table model wetube.account_information ............................ [RUN]
22:35:11.997534 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
22:35:11.997673 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
22:35:11.997813 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
22:35:12.001918 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
22:35:12.003371 [debug] [Thread-1  ]: finished collecting timing info
22:35:12.003627 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
22:35:12.039309 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
22:35:12.040411 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
22:35:12.040588 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
22:35:12.040729 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:35:12.051273 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:35:12.051498 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
22:35:12.051666 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (
    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (
    select * from
        "get_dbt"."wetube"."city"
),

source_state as (
    select * from
        "get_dbt"."wetube"."state"
),

source_user_address as (
    select * from
        "get_dbt"."wetube"."user_address"
),

source_account as (
    select * from
        "get_dbt"."wetube"."account"
),

account_info as (
    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name as city_name,
        state.name as state_name,
        channel.id_channel,
        channel.name as channel,
        channel.creation_date as channel_creation
    FROM source_account account
    	inner join source_channel channel on (channel.id_account = account.id_user)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
22:35:12.066991 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.02 seconds
22:35:12.074156 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
22:35:12.074340 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information" rename to "account_information__dbt_backup"
22:35:12.075658 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:35:12.078502 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
22:35:12.078696 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information__dbt_tmp" rename to "account_information"
22:35:12.079332 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:35:12.092453 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
22:35:12.092639 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
22:35:12.092778 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
22:35:12.095260 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:35:12.101050 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
22:35:12.101234 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
drop table if exists "get_dbt"."wetube"."account_information__dbt_backup" cascade
22:35:12.107546 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
22:35:12.109091 [debug] [Thread-1  ]: finished collecting timing info
22:35:12.109326 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
22:35:12.109764 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53e6a195-42d7-4b39-a87a-b98e38ddb5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4900aa610>]}
22:35:12.110133 [info ] [Thread-1  ]: 1 of 4 OK created table model wetube.account_information ....................... [[32mSELECT 5[0m in 0.11s]
22:35:12.110594 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
22:35:12.110822 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
22:35:12.111111 [info ] [Thread-1  ]: 2 of 4 START table model wetube.my_first_dbt_model ............................. [RUN]
22:35:12.111687 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
22:35:12.111917 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
22:35:12.112079 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
22:35:12.114709 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
22:35:12.116233 [debug] [Thread-1  ]: finished collecting timing info
22:35:12.116490 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
22:35:12.119728 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
22:35:12.120298 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
22:35:12.120457 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
22:35:12.120592 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:35:12.130050 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:35:12.130316 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
22:35:12.130473 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
22:35:12.136152 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
22:35:12.138955 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
22:35:12.139159 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
22:35:12.139789 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:35:12.142885 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
22:35:12.143118 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
22:35:12.143862 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:35:12.145857 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
22:35:12.146106 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
22:35:12.146269 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
22:35:12.147188 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:35:12.150865 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
22:35:12.151097 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
22:35:12.156373 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
22:35:12.157829 [debug] [Thread-1  ]: finished collecting timing info
22:35:12.158031 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
22:35:12.158451 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53e6a195-42d7-4b39-a87a-b98e38ddb5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4906fc370>]}
22:35:12.158814 [info ] [Thread-1  ]: 2 of 4 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.05s]
22:35:12.159231 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
22:35:12.159435 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
22:35:12.159664 [info ] [Thread-1  ]: 3 of 4 START table model wetube.number_of_subs_by_channel ...................... [RUN]
22:35:12.160085 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
22:35:12.160247 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
22:35:12.160400 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
22:35:12.163515 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
22:35:12.164833 [debug] [Thread-1  ]: finished collecting timing info
22:35:12.165118 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
22:35:12.168369 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
22:35:12.168950 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
22:35:12.169115 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
22:35:12.169254 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:35:12.179699 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:35:12.179933 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
22:35:12.180085 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
22:35:12.185943 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.01 seconds
22:35:12.188979 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
22:35:12.189201 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
22:35:12.190418 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:35:12.193327 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
22:35:12.193672 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
22:35:12.194345 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:35:12.196228 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
22:35:12.196394 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
22:35:12.196535 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
22:35:12.197257 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:35:12.199217 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
22:35:12.199489 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
22:35:12.202441 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
22:35:12.204007 [debug] [Thread-1  ]: finished collecting timing info
22:35:12.204219 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
22:35:12.204659 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53e6a195-42d7-4b39-a87a-b98e38ddb5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa490c3fcd0>]}
22:35:12.205103 [info ] [Thread-1  ]: 3 of 4 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.04s]
22:35:12.205557 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
22:35:12.205765 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
22:35:12.205999 [info ] [Thread-1  ]: 4 of 4 START view model wetube.my_second_dbt_model ............................. [RUN]
22:35:12.206430 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
22:35:12.206595 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
22:35:12.206748 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
22:35:12.209323 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
22:35:12.209834 [debug] [Thread-1  ]: finished collecting timing info
22:35:12.210006 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
22:35:12.234789 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
22:35:12.235510 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
22:35:12.235682 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
22:35:12.235820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:35:12.249061 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:35:12.249287 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
22:35:12.249435 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
22:35:12.254602 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
22:35:12.257298 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
22:35:12.257484 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
22:35:12.257996 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:35:12.259346 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
22:35:12.259508 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
22:35:12.259648 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
22:35:12.260177 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:35:12.261909 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
22:35:12.262069 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
22:35:12.262382 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
22:35:12.263556 [debug] [Thread-1  ]: finished collecting timing info
22:35:12.263752 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
22:35:12.264171 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53e6a195-42d7-4b39-a87a-b98e38ddb5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4906edc70>]}
22:35:12.264544 [info ] [Thread-1  ]: 4 of 4 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
22:35:12.265030 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
22:35:12.266106 [debug] [MainThread]: Acquiring new postgres connection "master"
22:35:12.266308 [debug] [MainThread]: Using postgres connection "master"
22:35:12.266455 [debug] [MainThread]: On master: BEGIN
22:35:12.266588 [debug] [MainThread]: Opening a new connection, currently in state closed
22:35:12.275660 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:35:12.275901 [debug] [MainThread]: On master: COMMIT
22:35:12.276057 [debug] [MainThread]: Using postgres connection "master"
22:35:12.276199 [debug] [MainThread]: On master: COMMIT
22:35:12.276464 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:35:12.276672 [debug] [MainThread]: On master: Close
22:35:12.277107 [info ] [MainThread]: 
22:35:12.277390 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0.46s.
22:35:12.277638 [debug] [MainThread]: Connection 'master' was properly closed.
22:35:12.277777 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
22:35:12.285365 [info ] [MainThread]: 
22:35:12.285720 [info ] [MainThread]: [32mCompleted successfully[0m
22:35:12.286127 [info ] [MainThread]: 
22:35:12.286379 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
22:35:12.286711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4906fc310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa490c23340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa490a9a9d0>]}


============================== 2022-07-23 22:56:29.087666 | d6c00973-d824-4421-81dd-d8357ce8756d ==============================
22:56:29.087710 [info ] [MainThread]: Running with dbt=1.1.1
22:56:29.090051 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
22:56:29.090295 [debug] [MainThread]: Tracking: tracking
22:56:29.134876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9486f4a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9486f42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9486fe4f0>]}
22:56:29.209561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:56:29.209799 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:56:29.219006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6c00973-d824-4421-81dd-d8357ce8756d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94885ef40>]}
22:56:29.228607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6c00973-d824-4421-81dd-d8357ce8756d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9487caa00>]}
22:56:29.229004 [info ] [MainThread]: Found 4 models, 16 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
22:56:29.229317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6c00973-d824-4421-81dd-d8357ce8756d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9487caa60>]}
22:56:29.231859 [info ] [MainThread]: 
22:56:29.232404 [debug] [MainThread]: Acquiring new postgres connection "master"
22:56:29.233484 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
22:56:29.246290 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
22:56:29.246525 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
22:56:29.246690 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:56:29.304033 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.06 seconds
22:56:29.306093 [debug] [ThreadPool]: On list_get_dbt: Close
22:56:29.307445 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
22:56:29.314591 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
22:56:29.314826 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
22:56:29.314983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:56:29.328070 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:56:29.328305 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
22:56:29.328450 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
22:56:29.344225 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.02 seconds
22:56:29.345944 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
22:56:29.346256 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
22:56:29.352213 [debug] [MainThread]: Using postgres connection "master"
22:56:29.352425 [debug] [MainThread]: On master: BEGIN
22:56:29.352565 [debug] [MainThread]: Opening a new connection, currently in state init
22:56:29.362219 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:56:29.362438 [debug] [MainThread]: Using postgres connection "master"
22:56:29.362584 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:56:29.424499 [debug] [MainThread]: SQL status: SELECT 2 in 0.06 seconds
22:56:29.425870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6c00973-d824-4421-81dd-d8357ce8756d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94887bee0>]}
22:56:29.426150 [debug] [MainThread]: On master: ROLLBACK
22:56:29.426408 [debug] [MainThread]: Using postgres connection "master"
22:56:29.426544 [debug] [MainThread]: On master: BEGIN
22:56:29.426918 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:56:29.427084 [debug] [MainThread]: On master: COMMIT
22:56:29.427220 [debug] [MainThread]: Using postgres connection "master"
22:56:29.427340 [debug] [MainThread]: On master: COMMIT
22:56:29.427643 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:56:29.427820 [debug] [MainThread]: On master: Close
22:56:29.428168 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
22:56:29.428405 [info ] [MainThread]: 
22:56:29.468696 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
22:56:29.469145 [info ] [Thread-1  ]: 1 of 4 START table model wetube.account_information ............................ [RUN]
22:56:29.469853 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
22:56:29.470077 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
22:56:29.470275 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
22:56:29.475990 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
22:56:29.477404 [debug] [Thread-1  ]: finished collecting timing info
22:56:29.477684 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
22:56:29.517384 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
22:56:29.518240 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
22:56:29.518443 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
22:56:29.518592 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:56:29.528371 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:56:29.528597 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
22:56:29.528742 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (
    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (
    select * from
        "get_dbt"."wetube"."city"
),

source_state as (
    select * from
        "get_dbt"."wetube"."state"
),

source_user_address as (
    select * from
        "get_dbt"."wetube"."user_address"
),

source_account as (
    select * from
        "get_dbt"."wetube"."account"
),

account_info as (
    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name as city_name,
        state.name as state_name,
        channel.id_channel,
        channel.name as channel,
        channel.creation_date as channel_creation
    FROM source_account account
    	inner join source_channel channel on (channel.id_account = account.id_user)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
22:56:29.551850 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.02 seconds
22:56:29.559218 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
22:56:29.559394 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information" rename to "account_information__dbt_backup"
22:56:29.559894 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:56:29.562451 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
22:56:29.562614 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information__dbt_tmp" rename to "account_information"
22:56:29.563139 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:56:29.576569 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
22:56:29.576787 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
22:56:29.576934 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
22:56:29.579155 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:56:29.585077 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
22:56:29.585256 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
drop table if exists "get_dbt"."wetube"."account_information__dbt_backup" cascade
22:56:29.588626 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
22:56:29.590048 [debug] [Thread-1  ]: finished collecting timing info
22:56:29.590256 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
22:56:29.590680 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6c00973-d824-4421-81dd-d8357ce8756d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9484e6af0>]}
22:56:29.591055 [info ] [Thread-1  ]: 1 of 4 OK created table model wetube.account_information ....................... [[32mSELECT 5[0m in 0.12s]
22:56:29.591500 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
22:56:29.591701 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
22:56:29.592109 [info ] [Thread-1  ]: 2 of 4 START table model wetube.my_first_dbt_model ............................. [RUN]
22:56:29.592579 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
22:56:29.592743 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
22:56:29.592892 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
22:56:29.595480 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
22:56:29.598043 [debug] [Thread-1  ]: finished collecting timing info
22:56:29.598341 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
22:56:29.601628 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
22:56:29.602196 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
22:56:29.602350 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
22:56:29.602483 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:56:29.612146 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:56:29.612367 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
22:56:29.612508 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
22:56:29.615046 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
22:56:29.618073 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
22:56:29.618273 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
22:56:29.618889 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:56:29.621757 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
22:56:29.622046 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
22:56:29.622844 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:56:29.624753 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
22:56:29.624933 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
22:56:29.625079 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
22:56:29.625714 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:56:29.627731 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
22:56:29.628002 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
22:56:29.631855 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
22:56:29.633263 [debug] [Thread-1  ]: finished collecting timing info
22:56:29.633455 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
22:56:29.633876 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6c00973-d824-4421-81dd-d8357ce8756d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9488ce2e0>]}
22:56:29.634249 [info ] [Thread-1  ]: 2 of 4 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.04s]
22:56:29.634682 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
22:56:29.634909 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
22:56:29.635197 [info ] [Thread-1  ]: 3 of 4 START table model wetube.number_of_subs_by_channel ...................... [RUN]
22:56:29.635879 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
22:56:29.636210 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
22:56:29.636388 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
22:56:29.641061 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
22:56:29.642401 [debug] [Thread-1  ]: finished collecting timing info
22:56:29.642668 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
22:56:29.646006 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
22:56:29.646601 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
22:56:29.646786 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
22:56:29.646928 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:56:29.658136 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:56:29.658368 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
22:56:29.658510 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
22:56:29.665739 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.01 seconds
22:56:29.668811 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
22:56:29.669097 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
22:56:29.671334 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:56:29.674054 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
22:56:29.674224 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
22:56:29.674795 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:56:29.676446 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
22:56:29.676664 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
22:56:29.676807 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
22:56:29.677657 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:56:29.679872 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
22:56:29.680069 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
22:56:29.682921 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
22:56:29.684274 [debug] [Thread-1  ]: finished collecting timing info
22:56:29.684459 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
22:56:29.684922 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6c00973-d824-4421-81dd-d8357ce8756d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd948a03f70>]}
22:56:29.685316 [info ] [Thread-1  ]: 3 of 4 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.05s]
22:56:29.685729 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
22:56:29.685923 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
22:56:29.686145 [info ] [Thread-1  ]: 4 of 4 START view model wetube.my_second_dbt_model ............................. [RUN]
22:56:29.686564 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
22:56:29.686722 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
22:56:29.686868 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
22:56:29.689517 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
22:56:29.690125 [debug] [Thread-1  ]: finished collecting timing info
22:56:29.690304 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
22:56:29.711794 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
22:56:29.712537 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
22:56:29.712710 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
22:56:29.712845 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:56:29.723571 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:56:29.723808 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
22:56:29.723952 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
22:56:29.728549 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
22:56:29.731469 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
22:56:29.731734 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
22:56:29.732442 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:56:29.734256 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
22:56:29.734479 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
22:56:29.734619 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
22:56:29.735376 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:56:29.737232 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
22:56:29.737389 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
22:56:29.737776 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
22:56:29.739194 [debug] [Thread-1  ]: finished collecting timing info
22:56:29.739506 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
22:56:29.740079 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6c00973-d824-4421-81dd-d8357ce8756d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9488a0910>]}
22:56:29.740577 [info ] [Thread-1  ]: 4 of 4 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
22:56:29.741108 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
22:56:29.742256 [debug] [MainThread]: Acquiring new postgres connection "master"
22:56:29.742456 [debug] [MainThread]: Using postgres connection "master"
22:56:29.742596 [debug] [MainThread]: On master: BEGIN
22:56:29.742723 [debug] [MainThread]: Opening a new connection, currently in state closed
22:56:29.757550 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:56:29.757924 [debug] [MainThread]: On master: COMMIT
22:56:29.758074 [debug] [MainThread]: Using postgres connection "master"
22:56:29.758211 [debug] [MainThread]: On master: COMMIT
22:56:29.758470 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:56:29.758649 [debug] [MainThread]: On master: Close
22:56:29.759096 [info ] [MainThread]: 
22:56:29.759375 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0.53s.
22:56:29.759624 [debug] [MainThread]: Connection 'master' was properly closed.
22:56:29.759750 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
22:56:29.767992 [info ] [MainThread]: 
22:56:29.768662 [info ] [MainThread]: [32mCompleted successfully[0m
22:56:29.769124 [info ] [MainThread]: 
22:56:29.769505 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
22:56:29.770229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94887b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94887b280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94883fbe0>]}


============================== 2022-07-23 23:03:15.286096 | 54a257ca-a577-4a39-8577-c00704c151d2 ==============================
23:03:15.286143 [info ] [MainThread]: Running with dbt=1.1.1
23:03:15.287354 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
23:03:15.287578 [debug] [MainThread]: Tracking: tracking
23:03:15.311521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8069eef700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8069eeff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8069efe670>]}
23:03:15.383446 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
23:03:15.383671 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
23:03:15.392225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54a257ca-a577-4a39-8577-c00704c151d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806a05df40>]}
23:03:15.400752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54a257ca-a577-4a39-8577-c00704c151d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8069fc9a30>]}
23:03:15.401101 [info ] [MainThread]: Found 4 models, 16 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
23:03:15.401393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54a257ca-a577-4a39-8577-c00704c151d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8069fc9a90>]}
23:03:15.403627 [info ] [MainThread]: 
23:03:15.404130 [debug] [MainThread]: Acquiring new postgres connection "master"
23:03:15.405130 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
23:03:15.416795 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
23:03:15.416987 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
23:03:15.417128 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:03:15.460571 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.04 seconds
23:03:15.462331 [debug] [ThreadPool]: On list_get_dbt: Close
23:03:15.463602 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
23:03:15.470832 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
23:03:15.471026 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
23:03:15.471164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
23:03:15.480944 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:03:15.481147 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
23:03:15.481304 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
23:03:15.484795 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
23:03:15.486440 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
23:03:15.486714 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
23:03:15.492388 [debug] [MainThread]: Using postgres connection "master"
23:03:15.492574 [debug] [MainThread]: On master: BEGIN
23:03:15.492715 [debug] [MainThread]: Opening a new connection, currently in state init
23:03:15.502098 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:03:15.502294 [debug] [MainThread]: Using postgres connection "master"
23:03:15.502435 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
23:03:15.543678 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
23:03:15.544979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54a257ca-a577-4a39-8577-c00704c151d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8069f511f0>]}
23:03:15.545255 [debug] [MainThread]: On master: ROLLBACK
23:03:15.545503 [debug] [MainThread]: Using postgres connection "master"
23:03:15.545633 [debug] [MainThread]: On master: BEGIN
23:03:15.545912 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
23:03:15.546055 [debug] [MainThread]: On master: COMMIT
23:03:15.546183 [debug] [MainThread]: Using postgres connection "master"
23:03:15.546296 [debug] [MainThread]: On master: COMMIT
23:03:15.546499 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
23:03:15.546638 [debug] [MainThread]: On master: Close
23:03:15.546952 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
23:03:15.547182 [info ] [MainThread]: 
23:03:15.591341 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
23:03:15.591750 [info ] [Thread-1  ]: 1 of 4 START table model wetube.account_information ............................ [RUN]
23:03:15.592450 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
23:03:15.592655 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
23:03:15.592849 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
23:03:15.598051 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
23:03:15.598667 [debug] [Thread-1  ]: finished collecting timing info
23:03:15.598861 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
23:03:15.637943 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
23:03:15.638593 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
23:03:15.638767 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
23:03:15.638905 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:03:15.648277 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
23:03:15.648482 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
23:03:15.648631 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (
    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (
    select * from
        "get_dbt"."wetube"."city"
),

source_state as (
    select * from
        "get_dbt"."wetube"."state"
),

source_user_address as (
    select * from
        "get_dbt"."wetube"."user_address"
),

source_account as (
    select * from
        "get_dbt"."wetube"."account"
),

account_info as (
    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name as city_name,
        state.name as state_name,
        channel.id_channel,
        channel.name as channel,
        channel.creation_date as channel_creation
    FROM source_account account
    	inner join source_channel channel on (channel.id_account = account.id_user)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
23:03:15.672341 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.02 seconds
23:03:15.679562 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
23:03:15.679748 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information" rename to "account_information__dbt_backup"
23:03:15.680879 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
23:03:15.683412 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
23:03:15.683575 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information__dbt_tmp" rename to "account_information"
23:03:15.684069 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
23:03:15.697144 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
23:03:15.697340 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
23:03:15.697485 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
23:03:15.698168 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
23:03:15.703509 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
23:03:15.703675 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
drop table if exists "get_dbt"."wetube"."account_information__dbt_backup" cascade
23:03:15.706489 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
23:03:15.707808 [debug] [Thread-1  ]: finished collecting timing info
23:03:15.707997 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
23:03:15.708403 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54a257ca-a577-4a39-8577-c00704c151d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806a0a1070>]}
23:03:15.708777 [info ] [Thread-1  ]: 1 of 4 OK created table model wetube.account_information ....................... [[32mSELECT 5[0m in 0.12s]
23:03:15.709248 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
23:03:15.709459 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
23:03:15.709695 [info ] [Thread-1  ]: 2 of 4 START table model wetube.my_first_dbt_model ............................. [RUN]
23:03:15.710123 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
23:03:15.710289 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
23:03:15.710449 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
23:03:15.713040 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
23:03:15.713642 [debug] [Thread-1  ]: finished collecting timing info
23:03:15.713818 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
23:03:15.717117 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
23:03:15.717747 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
23:03:15.717906 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
23:03:15.718040 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:03:15.729241 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
23:03:15.729547 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
23:03:15.729712 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
23:03:15.745006 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.02 seconds
23:03:15.748099 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
23:03:15.748296 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
23:03:15.749517 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
23:03:15.752159 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
23:03:15.752456 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
23:03:15.753299 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
23:03:15.755232 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
23:03:15.755428 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
23:03:15.755570 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
23:03:15.756250 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
23:03:15.758286 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
23:03:15.758454 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
23:03:15.761445 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
23:03:15.763254 [debug] [Thread-1  ]: finished collecting timing info
23:03:15.763567 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
23:03:15.764087 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54a257ca-a577-4a39-8577-c00704c151d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806a0b5c70>]}
23:03:15.764485 [info ] [Thread-1  ]: 2 of 4 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.05s]
23:03:15.764999 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
23:03:15.765272 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
23:03:15.765586 [info ] [Thread-1  ]: 3 of 4 START table model wetube.number_of_subs_by_channel ...................... [RUN]
23:03:15.766221 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
23:03:15.766662 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
23:03:15.767085 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
23:03:15.772190 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
23:03:15.773057 [debug] [Thread-1  ]: finished collecting timing info
23:03:15.773411 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
23:03:15.776940 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
23:03:15.777592 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
23:03:15.777761 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
23:03:15.777899 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:03:15.788589 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
23:03:15.789103 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
23:03:15.789538 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
23:03:15.795848 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.01 seconds
23:03:15.799247 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
23:03:15.799616 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
23:03:15.800589 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
23:03:15.803259 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
23:03:15.803455 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
23:03:15.804445 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
23:03:15.806982 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
23:03:15.807211 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
23:03:15.807363 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
23:03:15.813446 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
23:03:15.815697 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
23:03:15.815954 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
23:03:15.819479 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
23:03:15.820892 [debug] [Thread-1  ]: finished collecting timing info
23:03:15.821153 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
23:03:15.821616 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54a257ca-a577-4a39-8577-c00704c151d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806a13dee0>]}
23:03:15.821994 [info ] [Thread-1  ]: 3 of 4 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.06s]
23:03:15.822433 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
23:03:15.822644 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
23:03:15.822882 [info ] [Thread-1  ]: 4 of 4 START view model wetube.my_second_dbt_model ............................. [RUN]
23:03:15.823324 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
23:03:15.823494 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
23:03:15.823664 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
23:03:15.826374 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
23:03:15.827024 [debug] [Thread-1  ]: finished collecting timing info
23:03:15.827216 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
23:03:15.851688 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
23:03:15.852489 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
23:03:15.852705 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
23:03:15.852853 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:03:15.862842 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
23:03:15.863073 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
23:03:15.863222 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
23:03:15.867546 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
23:03:15.870387 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
23:03:15.870596 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
23:03:15.871113 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
23:03:15.872515 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
23:03:15.872680 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
23:03:15.872817 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
23:03:15.875033 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
23:03:15.876786 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
23:03:15.876942 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
23:03:15.877321 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
23:03:15.878511 [debug] [Thread-1  ]: finished collecting timing info
23:03:15.878699 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
23:03:15.879102 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54a257ca-a577-4a39-8577-c00704c151d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80689cf9a0>]}
23:03:15.879463 [info ] [Thread-1  ]: 4 of 4 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
23:03:15.879969 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
23:03:15.881026 [debug] [MainThread]: Acquiring new postgres connection "master"
23:03:15.881228 [debug] [MainThread]: Using postgres connection "master"
23:03:15.881374 [debug] [MainThread]: On master: BEGIN
23:03:15.881506 [debug] [MainThread]: Opening a new connection, currently in state closed
23:03:15.891119 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:03:15.891351 [debug] [MainThread]: On master: COMMIT
23:03:15.891500 [debug] [MainThread]: Using postgres connection "master"
23:03:15.891641 [debug] [MainThread]: On master: COMMIT
23:03:15.891900 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
23:03:15.892079 [debug] [MainThread]: On master: Close
23:03:15.892606 [info ] [MainThread]: 
23:03:15.892885 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0.49s.
23:03:15.893151 [debug] [MainThread]: Connection 'master' was properly closed.
23:03:15.893292 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
23:03:15.900381 [info ] [MainThread]: 
23:03:15.900737 [info ] [MainThread]: [32mCompleted successfully[0m
23:03:15.901192 [info ] [MainThread]: 
23:03:15.901867 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
23:03:15.902386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806a0ccc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806a0cc7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80695fea00>]}


============================== 2022-07-23 23:07:17.211870 | 9038f559-ecf2-4797-bb23-55186fdfd00e ==============================
23:07:17.211893 [info ] [MainThread]: Running with dbt=1.1.1
23:07:17.212857 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
23:07:17.213002 [debug] [MainThread]: Tracking: tracking
23:07:17.235238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811def3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811def3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811def1550>]}
23:07:17.306778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
23:07:17.307015 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
23:07:17.315867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9038f559-ecf2-4797-bb23-55186fdfd00e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811e15efd0>]}
23:07:17.324528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9038f559-ecf2-4797-bb23-55186fdfd00e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811df639d0>]}
23:07:17.324869 [info ] [MainThread]: Found 4 models, 16 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
23:07:17.325156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9038f559-ecf2-4797-bb23-55186fdfd00e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811df63a30>]}
23:07:17.327470 [info ] [MainThread]: 
23:07:17.328023 [debug] [MainThread]: Acquiring new postgres connection "master"
23:07:17.329071 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
23:07:17.341634 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
23:07:17.341865 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
23:07:17.342019 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:07:17.375454 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.03 seconds
23:07:17.377240 [debug] [ThreadPool]: On list_get_dbt: Close
23:07:17.378522 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
23:07:17.385441 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
23:07:17.385625 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
23:07:17.385782 [debug] [ThreadPool]: Opening a new connection, currently in state closed
23:07:17.395118 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:07:17.395348 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
23:07:17.395497 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
23:07:17.399021 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
23:07:17.400682 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
23:07:17.400991 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
23:07:17.406682 [debug] [MainThread]: Using postgres connection "master"
23:07:17.406873 [debug] [MainThread]: On master: BEGIN
23:07:17.407013 [debug] [MainThread]: Opening a new connection, currently in state init
23:07:17.416267 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:07:17.416459 [debug] [MainThread]: Using postgres connection "master"
23:07:17.416608 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
23:07:17.458354 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
23:07:17.480365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9038f559-ecf2-4797-bb23-55186fdfd00e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811df51d90>]}
23:07:17.480868 [debug] [MainThread]: On master: ROLLBACK
23:07:17.481340 [debug] [MainThread]: Using postgres connection "master"
23:07:17.481561 [debug] [MainThread]: On master: BEGIN
23:07:17.482072 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
23:07:17.482301 [debug] [MainThread]: On master: COMMIT
23:07:17.482489 [debug] [MainThread]: Using postgres connection "master"
23:07:17.482656 [debug] [MainThread]: On master: COMMIT
23:07:17.482948 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
23:07:17.483149 [debug] [MainThread]: On master: Close
23:07:17.483572 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
23:07:17.483893 [info ] [MainThread]: 
23:07:17.524883 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
23:07:17.525308 [info ] [Thread-1  ]: 1 of 4 START table model wetube.account_information ............................ [RUN]
23:07:17.525925 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
23:07:17.526127 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
23:07:17.526334 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
23:07:17.531553 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
23:07:17.532198 [debug] [Thread-1  ]: finished collecting timing info
23:07:17.532408 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
23:07:17.571849 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
23:07:17.572544 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
23:07:17.572724 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
23:07:17.572864 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:07:17.582087 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
23:07:17.582284 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
23:07:17.582429 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (
    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (
    select * from
        "get_dbt"."wetube"."city"
),

source_state as (
    select * from
        "get_dbt"."wetube"."state"
),

source_user_address as (
    select * from
        "get_dbt"."wetube"."user_address"
),

source_account as (
    select * from
        "get_dbt"."wetube"."account"
),

account_info as (
    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name as city_name,
        state.name as state_name,
        channel.id_channel,
        channel.name as channel,
        channel.creation_date as channel_creation
    FROM source_account account
    	inner join source_channel channel on (channel.id_account = account.id_user)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
23:07:17.590804 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
23:07:17.597987 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
23:07:17.598165 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information" rename to "account_information__dbt_backup"
23:07:17.599419 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
23:07:17.602161 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
23:07:17.602335 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information__dbt_tmp" rename to "account_information"
23:07:17.602927 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
23:07:17.616219 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
23:07:17.616412 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
23:07:17.616559 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
23:07:17.617198 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
23:07:17.622600 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
23:07:17.622762 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
drop table if exists "get_dbt"."wetube"."account_information__dbt_backup" cascade
23:07:17.626236 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
23:07:17.627615 [debug] [Thread-1  ]: finished collecting timing info
23:07:17.627804 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
23:07:17.628238 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9038f559-ecf2-4797-bb23-55186fdfd00e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811e14af40>]}
23:07:17.628615 [info ] [Thread-1  ]: 1 of 4 OK created table model wetube.account_information ....................... [[32mSELECT 5[0m in 0.10s]
23:07:17.629070 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
23:07:17.629278 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
23:07:17.629520 [info ] [Thread-1  ]: 2 of 4 START table model wetube.my_first_dbt_model ............................. [RUN]
23:07:17.629974 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
23:07:17.630241 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
23:07:17.630423 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
23:07:17.633047 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
23:07:17.633574 [debug] [Thread-1  ]: finished collecting timing info
23:07:17.633755 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
23:07:17.636707 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
23:07:17.637268 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
23:07:17.637438 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
23:07:17.637577 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:07:17.647535 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
23:07:17.647919 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
23:07:17.648124 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
23:07:17.652698 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
23:07:17.655742 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
23:07:17.655967 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
23:07:17.656534 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
23:07:17.659232 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
23:07:17.659424 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
23:07:17.660152 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
23:07:17.662320 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
23:07:17.662581 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
23:07:17.662731 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
23:07:17.663472 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
23:07:17.665437 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
23:07:17.665602 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
23:07:17.668934 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
23:07:17.670594 [debug] [Thread-1  ]: finished collecting timing info
23:07:17.670844 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
23:07:17.671283 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9038f559-ecf2-4797-bb23-55186fdfd00e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811e1b6fa0>]}
23:07:17.671650 [info ] [Thread-1  ]: 2 of 4 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.04s]
23:07:17.672059 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
23:07:17.672259 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
23:07:17.672487 [info ] [Thread-1  ]: 3 of 4 START table model wetube.number_of_subs_by_channel ...................... [RUN]
23:07:17.672906 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
23:07:17.673069 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
23:07:17.673393 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
23:07:17.677664 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
23:07:17.678159 [debug] [Thread-1  ]: finished collecting timing info
23:07:17.678339 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
23:07:17.681393 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
23:07:17.681907 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
23:07:17.682067 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
23:07:17.682206 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:07:17.691899 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
23:07:17.692122 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
23:07:17.692274 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
23:07:17.701517 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.01 seconds
23:07:17.704450 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
23:07:17.704643 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
23:07:17.706341 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
23:07:17.709262 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
23:07:17.709502 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
23:07:17.710176 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
23:07:17.712005 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
23:07:17.712181 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
23:07:17.712328 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
23:07:17.714384 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
23:07:17.716675 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
23:07:17.716897 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
23:07:17.719639 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
23:07:17.721002 [debug] [Thread-1  ]: finished collecting timing info
23:07:17.721196 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
23:07:17.721619 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9038f559-ecf2-4797-bb23-55186fdfd00e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811e24bf40>]}
23:07:17.722163 [info ] [Thread-1  ]: 3 of 4 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.05s]
23:07:17.722609 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
23:07:17.722818 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
23:07:17.723175 [info ] [Thread-1  ]: 4 of 4 START view model wetube.my_second_dbt_model ............................. [RUN]
23:07:17.723632 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
23:07:17.723794 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
23:07:17.723944 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
23:07:17.726485 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
23:07:17.727008 [debug] [Thread-1  ]: finished collecting timing info
23:07:17.727246 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
23:07:17.751609 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
23:07:17.752345 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
23:07:17.752523 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
23:07:17.752662 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:07:17.762610 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
23:07:17.762838 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
23:07:17.762988 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
23:07:17.767548 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
23:07:17.770342 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
23:07:17.770523 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
23:07:17.771036 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
23:07:17.772405 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
23:07:17.772571 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
23:07:17.772716 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
23:07:17.773264 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
23:07:17.774962 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
23:07:17.775253 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
23:07:17.775619 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
23:07:17.776806 [debug] [Thread-1  ]: finished collecting timing info
23:07:17.776988 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
23:07:17.777396 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9038f559-ecf2-4797-bb23-55186fdfd00e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811e1e7160>]}
23:07:17.777763 [info ] [Thread-1  ]: 4 of 4 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
23:07:17.778181 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
23:07:17.779354 [debug] [MainThread]: Acquiring new postgres connection "master"
23:07:17.779565 [debug] [MainThread]: Using postgres connection "master"
23:07:17.779715 [debug] [MainThread]: On master: BEGIN
23:07:17.779880 [debug] [MainThread]: Opening a new connection, currently in state closed
23:07:17.789099 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:07:17.789335 [debug] [MainThread]: On master: COMMIT
23:07:17.789487 [debug] [MainThread]: Using postgres connection "master"
23:07:17.789624 [debug] [MainThread]: On master: COMMIT
23:07:17.789875 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
23:07:17.790063 [debug] [MainThread]: On master: Close
23:07:17.790487 [info ] [MainThread]: 
23:07:17.790753 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0.46s.
23:07:17.790997 [debug] [MainThread]: Connection 'master' was properly closed.
23:07:17.791276 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
23:07:17.798263 [info ] [MainThread]: 
23:07:17.798575 [info ] [MainThread]: [32mCompleted successfully[0m
23:07:17.798955 [info ] [MainThread]: 
23:07:17.799207 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
23:07:17.799537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811e1cdca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811e1cd0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811e14aeb0>]}


============================== 2022-07-24 15:13:15.591462 | 0c424865-a5ea-4e87-99f7-c3868e4b960a ==============================
15:13:15.591484 [info ] [MainThread]: Running with dbt=1.1.1
15:13:15.593139 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:13:15.593299 [debug] [MainThread]: Tracking: tracking
15:13:15.634374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9dfef700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9dfeff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9dff2670>]}
15:13:15.707373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
15:13:15.707812 [debug] [MainThread]: Partial parsing: added file: dbt_blog://models/mart/total_likes_by_video.sql
15:13:15.708281 [debug] [MainThread]: Partial parsing: update schema file: dbt_blog://models/mart/schema.yml
15:13:15.727704 [debug] [MainThread]: 1699: static parser successfully parsed mart/total_likes_by_video.sql
15:13:15.826813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c424865-a5ea-4e87-99f7-c3868e4b960a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9dfe8400>]}
15:13:15.837046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c424865-a5ea-4e87-99f7-c3868e4b960a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9e227e80>]}
15:13:15.837396 [info ] [MainThread]: Found 5 models, 21 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
15:13:15.837688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c424865-a5ea-4e87-99f7-c3868e4b960a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9e227df0>]}
15:13:15.840006 [info ] [MainThread]: 
15:13:15.840501 [debug] [MainThread]: Acquiring new postgres connection "master"
15:13:15.841525 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
15:13:15.853633 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
15:13:15.853899 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
15:13:15.854089 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:13:15.890925 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.04 seconds
15:13:15.892537 [debug] [ThreadPool]: On list_get_dbt: Close
15:13:15.893906 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
15:13:15.901394 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:13:15.901577 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
15:13:15.901719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:13:15.912795 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:13:15.913058 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:13:15.913246 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
15:13:15.923607 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.01 seconds
15:13:15.925380 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
15:13:15.925813 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
15:13:15.931173 [debug] [MainThread]: Using postgres connection "master"
15:13:15.931365 [debug] [MainThread]: On master: BEGIN
15:13:15.931505 [debug] [MainThread]: Opening a new connection, currently in state init
15:13:15.940953 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:13:15.941163 [debug] [MainThread]: Using postgres connection "master"
15:13:15.941307 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:13:16.007211 [debug] [MainThread]: SQL status: SELECT 2 in 0.07 seconds
15:13:16.008565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c424865-a5ea-4e87-99f7-c3868e4b960a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9e14e070>]}
15:13:16.008852 [debug] [MainThread]: On master: ROLLBACK
15:13:16.009105 [debug] [MainThread]: Using postgres connection "master"
15:13:16.009234 [debug] [MainThread]: On master: BEGIN
15:13:16.009546 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:13:16.009697 [debug] [MainThread]: On master: COMMIT
15:13:16.009827 [debug] [MainThread]: Using postgres connection "master"
15:13:16.009943 [debug] [MainThread]: On master: COMMIT
15:13:16.010195 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:13:16.010335 [debug] [MainThread]: On master: Close
15:13:16.010641 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:13:16.010867 [info ] [MainThread]: 
15:13:16.015358 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
15:13:16.015664 [info ] [Thread-1  ]: 1 of 5 START table model wetube.account_information ............................ [RUN]
15:13:16.016118 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
15:13:16.016273 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
15:13:16.016422 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
15:13:16.020656 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
15:13:16.022427 [debug] [Thread-1  ]: finished collecting timing info
15:13:16.022684 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
15:13:16.060925 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
15:13:16.061550 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:13:16.061708 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
15:13:16.061845 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:13:16.071250 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:13:16.071444 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:13:16.071589 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (
    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (
    select * from
        "get_dbt"."wetube"."city"
),

source_state as (
    select * from
        "get_dbt"."wetube"."state"
),

source_user_address as (
    select * from
        "get_dbt"."wetube"."user_address"
),

source_account as (
    select * from
        "get_dbt"."wetube"."account"
),

account_info as (
    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name as city_name,
        state.name as state_name,
        channel.id_channel,
        channel.name as channel,
        channel.creation_date as channel_creation
    FROM source_account account
    	inner join source_channel channel on (channel.id_account = account.id_user)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
15:13:16.098337 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.03 seconds
15:13:16.105325 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:13:16.105508 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information" rename to "account_information__dbt_backup"
15:13:16.106432 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:13:16.108751 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:13:16.108906 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information__dbt_tmp" rename to "account_information"
15:13:16.110312 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:13:16.123177 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:13:16.123368 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:13:16.123503 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:13:16.126179 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:13:16.132040 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:13:16.132228 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
drop table if exists "get_dbt"."wetube"."account_information__dbt_backup" cascade
15:13:16.141444 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
15:13:16.142820 [debug] [Thread-1  ]: finished collecting timing info
15:13:16.143015 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
15:13:16.143448 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c424865-a5ea-4e87-99f7-c3868e4b960a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9e418040>]}
15:13:16.143825 [info ] [Thread-1  ]: 1 of 5 OK created table model wetube.account_information ....................... [[32mSELECT 5[0m in 0.13s]
15:13:16.144279 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
15:13:16.144483 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
15:13:16.144890 [info ] [Thread-1  ]: 2 of 5 START table model wetube.my_first_dbt_model ............................. [RUN]
15:13:16.145344 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
15:13:16.145504 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
15:13:16.145654 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
15:13:16.148320 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
15:13:16.149524 [debug] [Thread-1  ]: finished collecting timing info
15:13:16.149758 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
15:13:16.152996 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
15:13:16.153522 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:13:16.153678 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
15:13:16.153814 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:13:16.163796 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:13:16.164081 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:13:16.164238 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:13:16.170344 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
15:13:16.173463 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:13:16.173691 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:13:16.175482 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:13:16.180086 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:13:16.180306 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:13:16.180942 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:13:16.182642 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:13:16.182814 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:13:16.182964 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:13:16.183716 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:13:16.186240 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:13:16.186505 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
15:13:16.193768 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
15:13:16.195317 [debug] [Thread-1  ]: finished collecting timing info
15:13:16.195543 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
15:13:16.195978 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c424865-a5ea-4e87-99f7-c3868e4b960a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9e4a12e0>]}
15:13:16.196354 [info ] [Thread-1  ]: 2 of 5 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.05s]
15:13:16.196961 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
15:13:16.197209 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
15:13:16.197453 [info ] [Thread-1  ]: 3 of 5 START table model wetube.number_of_subs_by_channel ...................... [RUN]
15:13:16.198102 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:13:16.198275 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
15:13:16.198432 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
15:13:16.201617 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:13:16.202497 [debug] [Thread-1  ]: finished collecting timing info
15:13:16.202682 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
15:13:16.205854 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:13:16.206463 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:13:16.206629 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
15:13:16.206784 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:13:16.219690 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:13:16.219963 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:13:16.220123 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
15:13:16.229167 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.01 seconds
15:13:16.232000 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:13:16.232172 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
15:13:16.233449 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:13:16.236166 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:13:16.236431 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
15:13:16.237182 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:13:16.239189 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:13:16.239372 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:13:16.239516 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:13:16.240752 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:13:16.242512 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:13:16.242674 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
15:13:16.245904 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:13:16.247523 [debug] [Thread-1  ]: finished collecting timing info
15:13:16.247711 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
15:13:16.248160 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c424865-a5ea-4e87-99f7-c3868e4b960a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9e490040>]}
15:13:16.248621 [info ] [Thread-1  ]: 3 of 5 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.05s]
15:13:16.249074 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
15:13:16.249276 [debug] [Thread-1  ]: Began running node model.dbt_blog.total_likes_by_video
15:13:16.249510 [info ] [Thread-1  ]: 4 of 5 START table model wetube.total_likes_by_video ........................... [RUN]
15:13:16.249949 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.total_likes_by_video"
15:13:16.250111 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.total_likes_by_video
15:13:16.250269 [debug] [Thread-1  ]: Compiling model.dbt_blog.total_likes_by_video
15:13:16.253632 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.total_likes_by_video"
15:13:16.254225 [debug] [Thread-1  ]: finished collecting timing info
15:13:16.254402 [debug] [Thread-1  ]: Began executing node model.dbt_blog.total_likes_by_video
15:13:16.257355 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.total_likes_by_video"
15:13:16.257822 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:13:16.257975 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: BEGIN
15:13:16.258109 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:13:16.272240 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:13:16.272581 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:13:16.272740 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */


  create  table "get_dbt"."wetube"."total_likes_by_video__dbt_tmp"
  as (
    with source_account_info as (

    select * from
        "get_dbt"."wetube"."account_information"
),

source_video as (

    select * from
        "get_dbt"."wetube"."video"

),


source_video_like as (

    select * from
        "get_dbt"."wetube"."video_like"

),

source_total_like_by_video (

    select
        source_account_info.id_channel, id_channel.channel,
        source_video.id_video, source_video.title, count(*) as total_likes
    FROM source_video_like
        inner join source_video using (id_video)
        inner join source_account_info using (id_channel)
    GROUP BY source_account_info.id_channel,
             source_account_info.ai_channel,
             source_video.id_video
             source_video.title
)

select * from source_total_like_by_video
  );
15:13:16.273417 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 29:     select
             ^

15:13:16.273600 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: ROLLBACK
15:13:16.273966 [debug] [Thread-1  ]: finished collecting timing info
15:13:16.274148 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: Close
15:13:16.274576 [debug] [Thread-1  ]: Database Error in model total_likes_by_video (models/mart/total_likes_by_video.sql)
  syntax error at or near "select"
  LINE 29:     select
               ^
  compiled SQL at target/run/dbt_blog/models/mart/total_likes_by_video.sql
15:13:16.274859 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c424865-a5ea-4e87-99f7-c3868e4b960a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9e4d8d60>]}
15:13:16.275331 [error] [Thread-1  ]: 4 of 5 ERROR creating table model wetube.total_likes_by_video .................. [[31mERROR[0m in 0.03s]
15:13:16.275827 [debug] [Thread-1  ]: Finished running node model.dbt_blog.total_likes_by_video
15:13:16.276059 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
15:13:16.276624 [info ] [Thread-1  ]: 5 of 5 START view model wetube.my_second_dbt_model ............................. [RUN]
15:13:16.277100 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
15:13:16.277257 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
15:13:16.277408 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
15:13:16.279969 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
15:13:16.280520 [debug] [Thread-1  ]: finished collecting timing info
15:13:16.280766 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
15:13:16.307634 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
15:13:16.308824 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:13:16.309179 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
15:13:16.309336 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:13:16.343395 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
15:13:16.343623 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:13:16.343775 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
15:13:16.350342 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
15:13:16.353035 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:13:16.353202 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:13:16.353671 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:13:16.355056 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:13:16.355265 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:13:16.355435 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:13:16.356007 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:13:16.358826 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:13:16.358987 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
15:13:16.359929 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:13:16.361477 [debug] [Thread-1  ]: finished collecting timing info
15:13:16.361712 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
15:13:16.362130 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c424865-a5ea-4e87-99f7-c3868e4b960a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9e4d8c70>]}
15:13:16.362488 [info ] [Thread-1  ]: 5 of 5 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.09s]
15:13:16.362894 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
15:13:16.364161 [debug] [MainThread]: Acquiring new postgres connection "master"
15:13:16.364358 [debug] [MainThread]: Using postgres connection "master"
15:13:16.364500 [debug] [MainThread]: On master: BEGIN
15:13:16.364632 [debug] [MainThread]: Opening a new connection, currently in state closed
15:13:16.374150 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:13:16.374397 [debug] [MainThread]: On master: COMMIT
15:13:16.374550 [debug] [MainThread]: Using postgres connection "master"
15:13:16.374688 [debug] [MainThread]: On master: COMMIT
15:13:16.374963 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:13:16.375157 [debug] [MainThread]: On master: Close
15:13:16.375590 [info ] [MainThread]: 
15:13:16.375865 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0.54s.
15:13:16.376115 [debug] [MainThread]: Connection 'master' was properly closed.
15:13:16.376253 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
15:13:16.384700 [info ] [MainThread]: 
15:13:16.385247 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:13:16.385631 [info ] [MainThread]: 
15:13:16.386039 [error] [MainThread]: [33mDatabase Error in model total_likes_by_video (models/mart/total_likes_by_video.sql)[0m
15:13:16.386348 [error] [MainThread]:   syntax error at or near "select"
15:13:16.386579 [error] [MainThread]:   LINE 29:     select
15:13:16.386794 [error] [MainThread]:                ^
15:13:16.387005 [error] [MainThread]:   compiled SQL at target/run/dbt_blog/models/mart/total_likes_by_video.sql
15:13:16.387448 [info ] [MainThread]: 
15:13:16.387704 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
15:13:16.388043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9e51dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9e145c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9e511250>]}


============================== 2022-07-24 15:14:42.232997 | 23a70cfc-7c2c-4643-9b51-b9d895508878 ==============================
15:14:42.233064 [info ] [MainThread]: Running with dbt=1.1.1
15:14:42.233754 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:14:42.233926 [debug] [MainThread]: Tracking: tracking
15:14:42.256542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb62d7f35b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb62d7f3d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb62d7f24f0>]}
15:14:42.326560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:14:42.327122 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/total_likes_by_video.sql
15:14:42.344247 [debug] [MainThread]: 1699: static parser successfully parsed mart/total_likes_by_video.sql
15:14:42.436958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23a70cfc-7c2c-4643-9b51-b9d895508878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb62d6d9fd0>]}
15:14:42.446328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23a70cfc-7c2c-4643-9b51-b9d895508878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb62d8fc310>]}
15:14:42.446666 [info ] [MainThread]: Found 5 models, 21 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
15:14:42.446955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23a70cfc-7c2c-4643-9b51-b9d895508878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb62d6c66d0>]}
15:14:42.449179 [info ] [MainThread]: 
15:14:42.449659 [debug] [MainThread]: Acquiring new postgres connection "master"
15:14:42.450648 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
15:14:42.461895 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
15:14:42.462074 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
15:14:42.462224 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:14:42.496811 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.03 seconds
15:14:42.498441 [debug] [ThreadPool]: On list_get_dbt: Close
15:14:42.499852 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
15:14:42.507382 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:14:42.507603 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
15:14:42.507753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:14:42.517300 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:14:42.517523 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:14:42.517682 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
15:14:42.522501 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
15:14:42.524257 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
15:14:42.524549 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
15:14:42.529790 [debug] [MainThread]: Using postgres connection "master"
15:14:42.529979 [debug] [MainThread]: On master: BEGIN
15:14:42.530122 [debug] [MainThread]: Opening a new connection, currently in state init
15:14:42.539439 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:14:42.539645 [debug] [MainThread]: Using postgres connection "master"
15:14:42.539801 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:14:42.582333 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
15:14:42.583645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23a70cfc-7c2c-4643-9b51-b9d895508878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb62d955040>]}
15:14:42.583918 [debug] [MainThread]: On master: ROLLBACK
15:14:42.584168 [debug] [MainThread]: Using postgres connection "master"
15:14:42.584305 [debug] [MainThread]: On master: BEGIN
15:14:42.584606 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:14:42.584772 [debug] [MainThread]: On master: COMMIT
15:14:42.584906 [debug] [MainThread]: Using postgres connection "master"
15:14:42.585028 [debug] [MainThread]: On master: COMMIT
15:14:42.585257 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:14:42.585424 [debug] [MainThread]: On master: Close
15:14:42.585752 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:14:42.585988 [info ] [MainThread]: 
15:14:42.590921 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
15:14:42.591251 [info ] [Thread-1  ]: 1 of 5 START table model wetube.account_information ............................ [RUN]
15:14:42.591735 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
15:14:42.591903 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
15:14:42.592059 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
15:14:42.596639 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
15:14:42.597644 [debug] [Thread-1  ]: finished collecting timing info
15:14:42.597848 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
15:14:42.637311 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
15:14:42.638239 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:14:42.638524 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
15:14:42.638713 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:14:42.649762 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:14:42.650067 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:14:42.650248 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (
    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (
    select * from
        "get_dbt"."wetube"."city"
),

source_state as (
    select * from
        "get_dbt"."wetube"."state"
),

source_user_address as (
    select * from
        "get_dbt"."wetube"."user_address"
),

source_account as (
    select * from
        "get_dbt"."wetube"."account"
),

account_info as (
    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name as city_name,
        state.name as state_name,
        channel.id_channel,
        channel.name as channel,
        channel.creation_date as channel_creation
    FROM source_account account
    	inner join source_channel channel on (channel.id_account = account.id_user)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
15:14:42.659078 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
15:14:42.666238 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:14:42.666500 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information" rename to "account_information__dbt_backup"
15:14:42.667034 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:14:42.669440 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:14:42.669605 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information__dbt_tmp" rename to "account_information"
15:14:42.670130 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:14:42.683510 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:14:42.683705 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:14:42.683855 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:14:42.684526 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:14:42.689971 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:14:42.690134 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
drop table if exists "get_dbt"."wetube"."account_information__dbt_backup" cascade
15:14:42.692603 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:14:42.693936 [debug] [Thread-1  ]: finished collecting timing info
15:14:42.694128 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
15:14:42.694555 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23a70cfc-7c2c-4643-9b51-b9d895508878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb62d8f4df0>]}
15:14:42.694922 [info ] [Thread-1  ]: 1 of 5 OK created table model wetube.account_information ....................... [[32mSELECT 5[0m in 0.10s]
15:14:42.695395 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
15:14:42.695627 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
15:14:42.696036 [info ] [Thread-1  ]: 2 of 5 START table model wetube.my_first_dbt_model ............................. [RUN]
15:14:42.696688 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
15:14:42.696857 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
15:14:42.697011 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
15:14:42.699796 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
15:14:42.700315 [debug] [Thread-1  ]: finished collecting timing info
15:14:42.700497 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
15:14:42.703525 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
15:14:42.704005 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:14:42.704162 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
15:14:42.704297 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:14:42.713501 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:14:42.713710 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:14:42.713857 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:14:42.716665 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
15:14:42.719456 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:14:42.719766 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:14:42.720334 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:14:42.724184 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:14:42.724407 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:14:42.725339 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:14:42.727651 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:14:42.727892 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:14:42.728052 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:14:42.728679 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:14:42.731037 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:14:42.731440 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
15:14:42.739341 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
15:14:42.740983 [debug] [Thread-1  ]: finished collecting timing info
15:14:42.741527 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
15:14:42.742072 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23a70cfc-7c2c-4643-9b51-b9d895508878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb62d2aa880>]}
15:14:42.742507 [info ] [Thread-1  ]: 2 of 5 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.05s]
15:14:42.742940 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
15:14:42.743286 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
15:14:42.743908 [info ] [Thread-1  ]: 3 of 5 START table model wetube.number_of_subs_by_channel ...................... [RUN]
15:14:42.744701 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:14:42.745006 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
15:14:42.745200 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
15:14:42.748894 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:14:42.749549 [debug] [Thread-1  ]: finished collecting timing info
15:14:42.749761 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
15:14:42.753517 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:14:42.754174 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:14:42.754346 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
15:14:42.754493 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:14:42.764591 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:14:42.764846 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:14:42.764999 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
15:14:42.771264 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.01 seconds
15:14:42.775261 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:14:42.775515 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
15:14:42.776113 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:14:42.780083 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:14:42.780339 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
15:14:42.781053 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:14:42.783063 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:14:42.783298 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:14:42.783478 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:14:42.785320 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:14:42.787268 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:14:42.787446 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
15:14:42.789245 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:14:42.790673 [debug] [Thread-1  ]: finished collecting timing info
15:14:42.790869 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
15:14:42.791294 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23a70cfc-7c2c-4643-9b51-b9d895508878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb62db8d2b0>]}
15:14:42.791670 [info ] [Thread-1  ]: 3 of 5 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.05s]
15:14:42.792254 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
15:14:42.792555 [debug] [Thread-1  ]: Began running node model.dbt_blog.total_likes_by_video
15:14:42.792942 [info ] [Thread-1  ]: 4 of 5 START table model wetube.total_likes_by_video ........................... [RUN]
15:14:42.793595 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.total_likes_by_video"
15:14:42.793773 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.total_likes_by_video
15:14:42.793933 [debug] [Thread-1  ]: Compiling model.dbt_blog.total_likes_by_video
15:14:42.797450 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.total_likes_by_video"
15:14:42.797967 [debug] [Thread-1  ]: finished collecting timing info
15:14:42.798148 [debug] [Thread-1  ]: Began executing node model.dbt_blog.total_likes_by_video
15:14:42.801220 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.total_likes_by_video"
15:14:42.801734 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:14:42.801895 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: BEGIN
15:14:42.802035 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:14:42.813552 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:14:42.813809 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:14:42.813964 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */


  create  table "get_dbt"."wetube"."total_likes_by_video__dbt_tmp"
  as (
    with source_account_info as (

    select * from
        "get_dbt"."wetube"."account_information"
),

source_video as (

    select * from
        "get_dbt"."wetube"."video"

),


source_video_like as (

    select * from
        "get_dbt"."wetube"."video_like"

),

source_total_like_by_video (

    select source_account_info.id_channel, id_channel.channel,
        source_video.id_video, source_video.title, count(*) as total_likes
    FROM source_video_like
        inner join source_video using (id_video)
        inner join source_account_info using (id_channel)
    GROUP BY source_account_info.id_channel,
             source_account_info.ai_channel,
             source_video.id_video
             source_video.title
)

select * from source_total_like_by_video
  );
15:14:42.814364 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 29:     select source_account_info.id_channel, id_channel.channe...
             ^

15:14:42.814555 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: ROLLBACK
15:14:42.815003 [debug] [Thread-1  ]: finished collecting timing info
15:14:42.815230 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: Close
15:14:42.815875 [debug] [Thread-1  ]: Database Error in model total_likes_by_video (models/mart/total_likes_by_video.sql)
  syntax error at or near "select"
  LINE 29:     select source_account_info.id_channel, id_channel.channe...
               ^
  compiled SQL at target/run/dbt_blog/models/mart/total_likes_by_video.sql
15:14:42.816779 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23a70cfc-7c2c-4643-9b51-b9d895508878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb62dbe0d00>]}
15:14:42.817637 [error] [Thread-1  ]: 4 of 5 ERROR creating table model wetube.total_likes_by_video .................. [[31mERROR[0m in 0.02s]
15:14:42.818208 [debug] [Thread-1  ]: Finished running node model.dbt_blog.total_likes_by_video
15:14:42.818429 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
15:14:42.818837 [info ] [Thread-1  ]: 5 of 5 START view model wetube.my_second_dbt_model ............................. [RUN]
15:14:42.819549 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
15:14:42.819726 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
15:14:42.819883 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
15:14:42.823128 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
15:14:42.823992 [debug] [Thread-1  ]: finished collecting timing info
15:14:42.824228 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
15:14:42.852594 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
15:14:42.853604 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:14:42.853921 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
15:14:42.854108 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:14:42.865041 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:14:42.865288 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:14:42.865443 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
15:14:42.868571 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:14:42.871397 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:14:42.871582 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:14:42.872093 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:14:42.873456 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:14:42.873625 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:14:42.873770 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:14:42.874305 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:14:42.877305 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:14:42.877493 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
15:14:42.877892 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:14:42.879127 [debug] [Thread-1  ]: finished collecting timing info
15:14:42.879320 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
15:14:42.879792 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23a70cfc-7c2c-4643-9b51-b9d895508878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb62d851550>]}
15:14:42.880205 [info ] [Thread-1  ]: 5 of 5 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
15:14:42.880706 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
15:14:42.881846 [debug] [MainThread]: Acquiring new postgres connection "master"
15:14:42.882053 [debug] [MainThread]: Using postgres connection "master"
15:14:42.882203 [debug] [MainThread]: On master: BEGIN
15:14:42.882338 [debug] [MainThread]: Opening a new connection, currently in state closed
15:14:42.891872 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:14:42.892141 [debug] [MainThread]: On master: COMMIT
15:14:42.892297 [debug] [MainThread]: Using postgres connection "master"
15:14:42.892437 [debug] [MainThread]: On master: COMMIT
15:14:42.892703 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:14:42.892907 [debug] [MainThread]: On master: Close
15:14:42.893342 [info ] [MainThread]: 
15:14:42.893621 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0.44s.
15:14:42.893992 [debug] [MainThread]: Connection 'master' was properly closed.
15:14:42.894272 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
15:14:42.903901 [info ] [MainThread]: 
15:14:42.904241 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:14:42.904528 [info ] [MainThread]: 
15:14:42.904772 [error] [MainThread]: [33mDatabase Error in model total_likes_by_video (models/mart/total_likes_by_video.sql)[0m
15:14:42.905011 [error] [MainThread]:   syntax error at or near "select"
15:14:42.905234 [error] [MainThread]:   LINE 29:     select source_account_info.id_channel, id_channel.channe...
15:14:42.905451 [error] [MainThread]:                ^
15:14:42.905668 [error] [MainThread]:   compiled SQL at target/run/dbt_blog/models/mart/total_likes_by_video.sql
15:14:42.905905 [info ] [MainThread]: 
15:14:42.906140 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
15:14:42.906626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb62cf014c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb62dc1ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb62dbf9c10>]}


============================== 2022-07-24 15:15:19.274160 | aa502b80-dcd1-4bb1-bcc9-15cf26afa953 ==============================
15:15:19.274180 [info ] [MainThread]: Running with dbt=1.1.1
15:15:19.275176 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:15:19.275336 [debug] [MainThread]: Tracking: tracking
15:15:19.298669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f4ddbee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f4ddb700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f4e1b190>]}
15:15:19.356542 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:15:19.357101 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/total_likes_by_video.sql
15:15:19.374696 [debug] [MainThread]: 1699: static parser successfully parsed mart/total_likes_by_video.sql
15:15:19.464728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa502b80-dcd1-4bb1-bcc9-15cf26afa953', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f4cc36d0>]}
15:15:19.474215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa502b80-dcd1-4bb1-bcc9-15cf26afa953', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f4ee6280>]}
15:15:19.474538 [info ] [MainThread]: Found 5 models, 21 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
15:15:19.474815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa502b80-dcd1-4bb1-bcc9-15cf26afa953', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f4cb0640>]}
15:15:19.476886 [info ] [MainThread]: 
15:15:19.477439 [debug] [MainThread]: Acquiring new postgres connection "master"
15:15:19.478508 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
15:15:19.489948 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
15:15:19.490236 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
15:15:19.490391 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:15:19.533726 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.04 seconds
15:15:19.535380 [debug] [ThreadPool]: On list_get_dbt: Close
15:15:19.536810 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
15:15:19.544247 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:15:19.544439 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
15:15:19.544583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:15:19.554417 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:15:19.554624 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:15:19.554768 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
15:15:19.558439 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
15:15:19.560105 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
15:15:19.560376 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
15:15:19.565529 [debug] [MainThread]: Using postgres connection "master"
15:15:19.565716 [debug] [MainThread]: On master: BEGIN
15:15:19.565858 [debug] [MainThread]: Opening a new connection, currently in state init
15:15:19.575085 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:15:19.575285 [debug] [MainThread]: Using postgres connection "master"
15:15:19.575427 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:15:19.615894 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
15:15:19.617171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa502b80-dcd1-4bb1-bcc9-15cf26afa953', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f4edfb20>]}
15:15:19.617443 [debug] [MainThread]: On master: ROLLBACK
15:15:19.617688 [debug] [MainThread]: Using postgres connection "master"
15:15:19.617821 [debug] [MainThread]: On master: BEGIN
15:15:19.618101 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:15:19.618239 [debug] [MainThread]: On master: COMMIT
15:15:19.618364 [debug] [MainThread]: Using postgres connection "master"
15:15:19.618478 [debug] [MainThread]: On master: COMMIT
15:15:19.618683 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:15:19.618827 [debug] [MainThread]: On master: Close
15:15:19.619133 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:15:19.619361 [info ] [MainThread]: 
15:15:19.622006 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
15:15:19.622253 [info ] [Thread-1  ]: 1 of 5 START table model wetube.account_information ............................ [RUN]
15:15:19.622651 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
15:15:19.622788 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
15:15:19.622922 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
15:15:19.626868 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
15:15:19.627394 [debug] [Thread-1  ]: finished collecting timing info
15:15:19.627555 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
15:15:19.660502 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
15:15:19.661149 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:15:19.661307 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
15:15:19.661445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:15:19.674074 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:15:19.674296 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:15:19.674529 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (
    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (
    select * from
        "get_dbt"."wetube"."city"
),

source_state as (
    select * from
        "get_dbt"."wetube"."state"
),

source_user_address as (
    select * from
        "get_dbt"."wetube"."user_address"
),

source_account as (
    select * from
        "get_dbt"."wetube"."account"
),

account_info as (
    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name as city_name,
        state.name as state_name,
        channel.id_channel,
        channel.name as channel,
        channel.creation_date as channel_creation
    FROM source_account account
    	inner join source_channel channel on (channel.id_account = account.id_user)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
15:15:19.680460 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
15:15:19.687532 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:15:19.687720 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information" rename to "account_information__dbt_backup"
15:15:19.688167 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:15:19.690561 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:15:19.690728 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information__dbt_tmp" rename to "account_information"
15:15:19.691270 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:15:19.703559 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:15:19.703732 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:15:19.703862 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:15:19.704488 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:15:19.709598 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:15:19.709773 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
drop table if exists "get_dbt"."wetube"."account_information__dbt_backup" cascade
15:15:19.714240 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:15:19.715624 [debug] [Thread-1  ]: finished collecting timing info
15:15:19.715811 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
15:15:19.716260 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa502b80-dcd1-4bb1-bcc9-15cf26afa953', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f5046f40>]}
15:15:19.716635 [info ] [Thread-1  ]: 1 of 5 OK created table model wetube.account_information ....................... [[32mSELECT 5[0m in 0.09s]
15:15:19.717123 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
15:15:19.717362 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
15:15:19.717602 [info ] [Thread-1  ]: 2 of 5 START table model wetube.my_first_dbt_model ............................. [RUN]
15:15:19.718353 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
15:15:19.718537 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
15:15:19.718689 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
15:15:19.721253 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
15:15:19.721755 [debug] [Thread-1  ]: finished collecting timing info
15:15:19.721921 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
15:15:19.724952 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
15:15:19.725492 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:15:19.725646 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
15:15:19.725780 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:15:19.735516 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:15:19.735837 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:15:19.735985 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:15:19.739590 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
15:15:19.742544 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:15:19.742739 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:15:19.743265 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:15:19.748051 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:15:19.748264 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:15:19.748905 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:15:19.750991 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:15:19.751268 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:15:19.751423 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:15:19.752258 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:15:19.754300 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:15:19.754654 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
15:15:19.757482 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:15:19.759094 [debug] [Thread-1  ]: finished collecting timing info
15:15:19.759357 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
15:15:19.759959 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa502b80-dcd1-4bb1-bcc9-15cf26afa953', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f4dcd790>]}
15:15:19.760375 [info ] [Thread-1  ]: 2 of 5 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.04s]
15:15:19.760812 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
15:15:19.761016 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
15:15:19.761354 [info ] [Thread-1  ]: 3 of 5 START table model wetube.number_of_subs_by_channel ...................... [RUN]
15:15:19.761791 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:15:19.762046 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
15:15:19.762261 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
15:15:19.765729 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:15:19.766469 [debug] [Thread-1  ]: finished collecting timing info
15:15:19.766726 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
15:15:19.769823 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:15:19.770338 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:15:19.770546 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
15:15:19.770695 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:15:19.780609 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:15:19.780842 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:15:19.781117 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
15:15:19.785444 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
15:15:19.788950 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:15:19.789170 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
15:15:19.789708 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:15:19.792278 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:15:19.792545 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
15:15:19.794223 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:15:19.796470 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:15:19.796696 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:15:19.796845 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:15:19.797589 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:15:19.799435 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:15:19.799728 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
15:15:19.801839 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:15:19.803640 [debug] [Thread-1  ]: finished collecting timing info
15:15:19.803876 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
15:15:19.804328 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa502b80-dcd1-4bb1-bcc9-15cf26afa953', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f52a67c0>]}
15:15:19.804709 [info ] [Thread-1  ]: 3 of 5 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.04s]
15:15:19.805143 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
15:15:19.805346 [debug] [Thread-1  ]: Began running node model.dbt_blog.total_likes_by_video
15:15:19.805694 [info ] [Thread-1  ]: 4 of 5 START table model wetube.total_likes_by_video ........................... [RUN]
15:15:19.806162 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.total_likes_by_video"
15:15:19.806323 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.total_likes_by_video
15:15:19.806472 [debug] [Thread-1  ]: Compiling model.dbt_blog.total_likes_by_video
15:15:19.810392 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.total_likes_by_video"
15:15:19.810966 [debug] [Thread-1  ]: finished collecting timing info
15:15:19.811157 [debug] [Thread-1  ]: Began executing node model.dbt_blog.total_likes_by_video
15:15:19.814322 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.total_likes_by_video"
15:15:19.814834 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:15:19.814990 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: BEGIN
15:15:19.815126 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:15:19.824392 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:15:19.824614 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:15:19.824760 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */


  create  table "get_dbt"."wetube"."total_likes_by_video__dbt_tmp"
  as (
    with source_account_info as (

    select * from
        "get_dbt"."wetube"."account_information"
),

source_video as (

    select * from
        "get_dbt"."wetube"."video"

),


source_video_like as (

    select * from
        "get_dbt"."wetube"."video_like"

),

source_total_like_by_video (

    select source_account_info.id_channel, source_account_info.channel,
        source_video.id_video, source_video.title, count(*) as total_likes
    FROM source_video_like
        inner join source_video using (id_video)
        inner join source_account_info using (id_channel)
    GROUP BY source_account_info.id_channel,
             source_account_info.ai_channel,
             source_video.id_video
             source_video.title
)

select * from source_total_like_by_video
  );
15:15:19.825196 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 29:     select source_account_info.id_channel, source_account_in...
             ^

15:15:19.825387 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: ROLLBACK
15:15:19.825745 [debug] [Thread-1  ]: finished collecting timing info
15:15:19.825939 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: Close
15:15:19.826302 [debug] [Thread-1  ]: Database Error in model total_likes_by_video (models/mart/total_likes_by_video.sql)
  syntax error at or near "select"
  LINE 29:     select source_account_info.id_channel, source_account_in...
               ^
  compiled SQL at target/run/dbt_blog/models/mart/total_likes_by_video.sql
15:15:19.826606 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa502b80-dcd1-4bb1-bcc9-15cf26afa953', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f52d5c70>]}
15:15:19.827024 [error] [Thread-1  ]: 4 of 5 ERROR creating table model wetube.total_likes_by_video .................. [[31mERROR[0m in 0.02s]
15:15:19.827755 [debug] [Thread-1  ]: Finished running node model.dbt_blog.total_likes_by_video
15:15:19.828004 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
15:15:19.828393 [info ] [Thread-1  ]: 5 of 5 START view model wetube.my_second_dbt_model ............................. [RUN]
15:15:19.829139 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
15:15:19.829353 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
15:15:19.829512 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
15:15:19.832567 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
15:15:19.833201 [debug] [Thread-1  ]: finished collecting timing info
15:15:19.833423 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
15:15:19.857839 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
15:15:19.858497 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:15:19.858655 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
15:15:19.858792 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:15:19.869701 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:15:19.870071 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:15:19.870263 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
15:15:19.877836 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
15:15:19.880624 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:15:19.880797 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:15:19.881335 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:15:19.882844 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:15:19.883018 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:15:19.883161 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:15:19.883770 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:15:19.886648 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:15:19.886813 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
15:15:19.887177 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:15:19.888452 [debug] [Thread-1  ]: finished collecting timing info
15:15:19.888641 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
15:15:19.889047 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa502b80-dcd1-4bb1-bcc9-15cf26afa953', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f4dcd3a0>]}
15:15:19.889429 [info ] [Thread-1  ]: 5 of 5 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
15:15:19.889841 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
15:15:19.890891 [debug] [MainThread]: Acquiring new postgres connection "master"
15:15:19.891092 [debug] [MainThread]: Using postgres connection "master"
15:15:19.891235 [debug] [MainThread]: On master: BEGIN
15:15:19.891366 [debug] [MainThread]: Opening a new connection, currently in state closed
15:15:19.900865 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:15:19.901095 [debug] [MainThread]: On master: COMMIT
15:15:19.901245 [debug] [MainThread]: Using postgres connection "master"
15:15:19.901380 [debug] [MainThread]: On master: COMMIT
15:15:19.901628 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:15:19.901792 [debug] [MainThread]: On master: Close
15:15:19.902202 [info ] [MainThread]: 
15:15:19.902463 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0.42s.
15:15:19.902701 [debug] [MainThread]: Connection 'master' was properly closed.
15:15:19.902828 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
15:15:19.910374 [info ] [MainThread]: 
15:15:19.910682 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:15:19.910956 [info ] [MainThread]: 
15:15:19.911185 [error] [MainThread]: [33mDatabase Error in model total_likes_by_video (models/mart/total_likes_by_video.sql)[0m
15:15:19.911414 [error] [MainThread]:   syntax error at or near "select"
15:15:19.911625 [error] [MainThread]:   LINE 29:     select source_account_info.id_channel, source_account_in...
15:15:19.911835 [error] [MainThread]:                ^
15:15:19.912042 [error] [MainThread]:   compiled SQL at target/run/dbt_blog/models/mart/total_likes_by_video.sql
15:15:19.912269 [info ] [MainThread]: 
15:15:19.912596 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
15:15:19.912930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f5054250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f5054280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f5309130>]}


============================== 2022-07-24 15:15:53.717966 | 5d36c566-1700-4281-828a-4fb3b51a8da9 ==============================
15:15:53.717999 [info ] [MainThread]: Running with dbt=1.1.1
15:15:53.718634 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:15:53.718775 [debug] [MainThread]: Tracking: tracking
15:15:53.736360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7486f17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7486f12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7487321c0>]}
15:15:53.794360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:15:53.794965 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/total_likes_by_video.sql
15:15:53.815779 [debug] [MainThread]: 1699: static parser successfully parsed mart/total_likes_by_video.sql
15:15:53.917410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d36c566-1700-4281-828a-4fb3b51a8da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7484c1ca0>]}
15:15:53.927027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d36c566-1700-4281-828a-4fb3b51a8da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7487fd2b0>]}
15:15:53.927356 [info ] [MainThread]: Found 5 models, 21 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
15:15:53.927640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d36c566-1700-4281-828a-4fb3b51a8da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7484af670>]}
15:15:53.929760 [info ] [MainThread]: 
15:15:53.930212 [debug] [MainThread]: Acquiring new postgres connection "master"
15:15:53.931212 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
15:15:53.942506 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
15:15:53.942716 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
15:15:53.942858 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:15:53.973720 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.03 seconds
15:15:53.975321 [debug] [ThreadPool]: On list_get_dbt: Close
15:15:53.976723 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
15:15:53.984237 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:15:53.984441 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
15:15:53.984589 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:15:53.994203 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:15:53.994487 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:15:53.994651 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
15:15:53.998156 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
15:15:53.999895 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
15:15:54.000203 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
15:15:54.005337 [debug] [MainThread]: Using postgres connection "master"
15:15:54.005523 [debug] [MainThread]: On master: BEGIN
15:15:54.005668 [debug] [MainThread]: Opening a new connection, currently in state init
15:15:54.015259 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:15:54.015462 [debug] [MainThread]: Using postgres connection "master"
15:15:54.015606 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:15:54.055614 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
15:15:54.056883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d36c566-1700-4281-828a-4fb3b51a8da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7486f1580>]}
15:15:54.057156 [debug] [MainThread]: On master: ROLLBACK
15:15:54.057431 [debug] [MainThread]: Using postgres connection "master"
15:15:54.057580 [debug] [MainThread]: On master: BEGIN
15:15:54.057888 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:15:54.058041 [debug] [MainThread]: On master: COMMIT
15:15:54.058171 [debug] [MainThread]: Using postgres connection "master"
15:15:54.058287 [debug] [MainThread]: On master: COMMIT
15:15:54.058592 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:15:54.058752 [debug] [MainThread]: On master: Close
15:15:54.059065 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:15:54.059301 [info ] [MainThread]: 
15:15:54.062007 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
15:15:54.062266 [info ] [Thread-1  ]: 1 of 5 START table model wetube.account_information ............................ [RUN]
15:15:54.062676 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
15:15:54.062817 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
15:15:54.062957 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
15:15:54.066958 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
15:15:54.067418 [debug] [Thread-1  ]: finished collecting timing info
15:15:54.067568 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
15:15:54.100428 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
15:15:54.101115 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:15:54.101309 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
15:15:54.101452 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:15:54.110727 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:15:54.110926 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:15:54.111068 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (
    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (
    select * from
        "get_dbt"."wetube"."city"
),

source_state as (
    select * from
        "get_dbt"."wetube"."state"
),

source_user_address as (
    select * from
        "get_dbt"."wetube"."user_address"
),

source_account as (
    select * from
        "get_dbt"."wetube"."account"
),

account_info as (
    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name as city_name,
        state.name as state_name,
        channel.id_channel,
        channel.name as channel,
        channel.creation_date as channel_creation
    FROM source_account account
    	inner join source_channel channel on (channel.id_account = account.id_user)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
15:15:54.118864 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
15:15:54.126057 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:15:54.126241 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information" rename to "account_information__dbt_backup"
15:15:54.126679 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:15:54.129031 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:15:54.129192 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information__dbt_tmp" rename to "account_information"
15:15:54.129741 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:15:54.141792 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:15:54.141962 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:15:54.142094 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:15:54.143644 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:15:54.149141 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:15:54.149317 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
drop table if exists "get_dbt"."wetube"."account_information__dbt_backup" cascade
15:15:54.151218 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:15:54.152462 [debug] [Thread-1  ]: finished collecting timing info
15:15:54.152641 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
15:15:54.153049 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d36c566-1700-4281-828a-4fb3b51a8da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7481b5ac0>]}
15:15:54.153453 [info ] [Thread-1  ]: 1 of 5 OK created table model wetube.account_information ....................... [[32mSELECT 5[0m in 0.09s]
15:15:54.153953 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
15:15:54.154172 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
15:15:54.154661 [info ] [Thread-1  ]: 2 of 5 START table model wetube.my_first_dbt_model ............................. [RUN]
15:15:54.155114 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
15:15:54.155271 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
15:15:54.155417 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
15:15:54.157923 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
15:15:54.158432 [debug] [Thread-1  ]: finished collecting timing info
15:15:54.158598 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
15:15:54.161703 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
15:15:54.162215 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:15:54.162362 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
15:15:54.162489 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:15:54.173432 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:15:54.173740 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:15:54.173915 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:15:54.177105 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
15:15:54.179992 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:15:54.180321 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:15:54.181386 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:15:54.185774 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:15:54.186046 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:15:54.187893 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:15:54.189962 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:15:54.190169 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:15:54.190327 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:15:54.190971 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:15:54.192948 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:15:54.193118 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
15:15:54.195082 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:15:54.196317 [debug] [Thread-1  ]: finished collecting timing info
15:15:54.196511 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
15:15:54.196935 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d36c566-1700-4281-828a-4fb3b51a8da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff748ab7ca0>]}
15:15:54.197312 [info ] [Thread-1  ]: 2 of 5 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.04s]
15:15:54.197742 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
15:15:54.197943 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
15:15:54.198312 [info ] [Thread-1  ]: 3 of 5 START table model wetube.number_of_subs_by_channel ...................... [RUN]
15:15:54.198966 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:15:54.199152 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
15:15:54.199307 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
15:15:54.202462 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:15:54.202974 [debug] [Thread-1  ]: finished collecting timing info
15:15:54.203147 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
15:15:54.206142 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:15:54.206621 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:15:54.206776 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
15:15:54.206913 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:15:54.218057 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:15:54.218313 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:15:54.218603 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
15:15:54.223217 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
15:15:54.226146 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:15:54.226331 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
15:15:54.227000 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:15:54.229922 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:15:54.230210 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
15:15:54.230964 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:15:54.233072 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:15:54.233299 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:15:54.233474 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:15:54.235035 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:15:54.237434 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:15:54.237654 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
15:15:54.241815 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:15:54.243774 [debug] [Thread-1  ]: finished collecting timing info
15:15:54.244027 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
15:15:54.244480 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d36c566-1700-4281-828a-4fb3b51a8da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff748847c40>]}
15:15:54.244861 [info ] [Thread-1  ]: 3 of 5 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.05s]
15:15:54.245416 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
15:15:54.245642 [debug] [Thread-1  ]: Began running node model.dbt_blog.total_likes_by_video
15:15:54.245887 [info ] [Thread-1  ]: 4 of 5 START table model wetube.total_likes_by_video ........................... [RUN]
15:15:54.246349 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.total_likes_by_video"
15:15:54.246520 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.total_likes_by_video
15:15:54.246763 [debug] [Thread-1  ]: Compiling model.dbt_blog.total_likes_by_video
15:15:54.250238 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.total_likes_by_video"
15:15:54.250812 [debug] [Thread-1  ]: finished collecting timing info
15:15:54.250987 [debug] [Thread-1  ]: Began executing node model.dbt_blog.total_likes_by_video
15:15:54.254325 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.total_likes_by_video"
15:15:54.254935 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:15:54.255098 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: BEGIN
15:15:54.255237 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:15:54.266956 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:15:54.267198 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:15:54.267358 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */


  create  table "get_dbt"."wetube"."total_likes_by_video__dbt_tmp"
  as (
    with source_account_info as (

    select * from
        "get_dbt"."wetube"."account_information"
),

source_video as (

    select * from
        "get_dbt"."wetube"."video"

),


source_video_like as (

    select * from
        "get_dbt"."wetube"."video_like"

),

source_total_like_by_video (

    select source_account_info.id_channel, source_account_info.channel,
        source_video.id_video, source_video.title, count(*) as total_likes
    FROM source_video_like
        inner join source_video using (id_video)
        inner join source_account_info using (id_channel)
    GROUP BY source_account_info.id_channel,
             source_account_info.channel,
             source_video.id_video
             source_video.title
)

select * from source_total_like_by_video
  );
15:15:54.267852 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 29:     select source_account_info.id_channel, source_account_in...
             ^

15:15:54.268060 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: ROLLBACK
15:15:54.268471 [debug] [Thread-1  ]: finished collecting timing info
15:15:54.268656 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: Close
15:15:54.269090 [debug] [Thread-1  ]: Database Error in model total_likes_by_video (models/mart/total_likes_by_video.sql)
  syntax error at or near "select"
  LINE 29:     select source_account_info.id_channel, source_account_in...
               ^
  compiled SQL at target/run/dbt_blog/models/mart/total_likes_by_video.sql
15:15:54.269398 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d36c566-1700-4281-828a-4fb3b51a8da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff748ad5ca0>]}
15:15:54.269776 [error] [Thread-1  ]: 4 of 5 ERROR creating table model wetube.total_likes_by_video .................. [[31mERROR[0m in 0.02s]
15:15:54.270367 [debug] [Thread-1  ]: Finished running node model.dbt_blog.total_likes_by_video
15:15:54.270649 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
15:15:54.271174 [info ] [Thread-1  ]: 5 of 5 START view model wetube.my_second_dbt_model ............................. [RUN]
15:15:54.272519 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
15:15:54.272896 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
15:15:54.273082 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
15:15:54.275944 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
15:15:54.276596 [debug] [Thread-1  ]: finished collecting timing info
15:15:54.276838 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
15:15:54.304889 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
15:15:54.305621 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:15:54.305834 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
15:15:54.305994 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:15:54.317287 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:15:54.317635 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:15:54.317817 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
15:15:54.320621 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:15:54.324321 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:15:54.324555 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:15:54.325147 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:15:54.326650 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:15:54.326813 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:15:54.326954 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:15:54.328881 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:15:54.332137 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:15:54.332322 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
15:15:54.332717 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:15:54.333938 [debug] [Thread-1  ]: finished collecting timing info
15:15:54.334119 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
15:15:54.334528 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d36c566-1700-4281-828a-4fb3b51a8da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff748ad5fd0>]}
15:15:54.334889 [info ] [Thread-1  ]: 5 of 5 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
15:15:54.335306 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
15:15:54.336504 [debug] [MainThread]: Acquiring new postgres connection "master"
15:15:54.336707 [debug] [MainThread]: Using postgres connection "master"
15:15:54.336854 [debug] [MainThread]: On master: BEGIN
15:15:54.336989 [debug] [MainThread]: Opening a new connection, currently in state closed
15:15:54.346239 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:15:54.346576 [debug] [MainThread]: On master: COMMIT
15:15:54.346736 [debug] [MainThread]: Using postgres connection "master"
15:15:54.346878 [debug] [MainThread]: On master: COMMIT
15:15:54.347140 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:15:54.347346 [debug] [MainThread]: On master: Close
15:15:54.347783 [info ] [MainThread]: 
15:15:54.348066 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0.42s.
15:15:54.348322 [debug] [MainThread]: Connection 'master' was properly closed.
15:15:54.348455 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
15:15:54.355507 [info ] [MainThread]: 
15:15:54.355800 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:15:54.356080 [info ] [MainThread]: 
15:15:54.356317 [error] [MainThread]: [33mDatabase Error in model total_likes_by_video (models/mart/total_likes_by_video.sql)[0m
15:15:54.356551 [error] [MainThread]:   syntax error at or near "select"
15:15:54.356766 [error] [MainThread]:   LINE 29:     select source_account_info.id_channel, source_account_in...
15:15:54.356987 [error] [MainThread]:                ^
15:15:54.357445 [error] [MainThread]:   compiled SQL at target/run/dbt_blog/models/mart/total_likes_by_video.sql
15:15:54.357954 [info ] [MainThread]: 
15:15:54.358394 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
15:15:54.358782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff747e0f070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff747e0f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff748b062b0>]}


============================== 2022-07-24 15:16:20.132802 | a06c8239-a265-43f6-8afb-1796f51f3549 ==============================
15:16:20.132835 [info ] [MainThread]: Running with dbt=1.1.1
15:16:20.133539 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:16:20.133691 [debug] [MainThread]: Tracking: tracking
15:16:20.152520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f526dcaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f526dc340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f526d7550>]}
15:16:20.208343 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:16:20.208826 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/total_likes_by_video.sql
15:16:20.222992 [debug] [MainThread]: 1699: static parser successfully parsed mart/total_likes_by_video.sql
15:16:20.305124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a06c8239-a265-43f6-8afb-1796f51f3549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f525bfdf0>]}
15:16:20.312679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a06c8239-a265-43f6-8afb-1796f51f3549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f527e12e0>]}
15:16:20.312932 [info ] [MainThread]: Found 5 models, 21 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
15:16:20.313151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a06c8239-a265-43f6-8afb-1796f51f3549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f525ac6a0>]}
15:16:20.314896 [info ] [MainThread]: 
15:16:20.315269 [debug] [MainThread]: Acquiring new postgres connection "master"
15:16:20.316060 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
15:16:20.325301 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
15:16:20.325582 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
15:16:20.325718 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:16:20.359601 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.03 seconds
15:16:20.361155 [debug] [ThreadPool]: On list_get_dbt: Close
15:16:20.362697 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
15:16:20.369825 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:16:20.369990 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
15:16:20.370112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:16:20.378737 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:16:20.378912 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:16:20.379033 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
15:16:20.382408 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
15:16:20.383822 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
15:16:20.384048 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
15:16:20.387934 [debug] [MainThread]: Using postgres connection "master"
15:16:20.388064 [debug] [MainThread]: On master: BEGIN
15:16:20.388166 [debug] [MainThread]: Opening a new connection, currently in state init
15:16:20.395291 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:16:20.395446 [debug] [MainThread]: Using postgres connection "master"
15:16:20.395553 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:16:20.429758 [debug] [MainThread]: SQL status: SELECT 2 in 0.03 seconds
15:16:20.430885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a06c8239-a265-43f6-8afb-1796f51f3549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5229fe20>]}
15:16:20.431128 [debug] [MainThread]: On master: ROLLBACK
15:16:20.431334 [debug] [MainThread]: Using postgres connection "master"
15:16:20.431468 [debug] [MainThread]: On master: BEGIN
15:16:20.431867 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:16:20.432003 [debug] [MainThread]: On master: COMMIT
15:16:20.432113 [debug] [MainThread]: Using postgres connection "master"
15:16:20.432212 [debug] [MainThread]: On master: COMMIT
15:16:20.432399 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:16:20.432532 [debug] [MainThread]: On master: Close
15:16:20.432853 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:16:20.433087 [info ] [MainThread]: 
15:16:20.435631 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
15:16:20.435856 [info ] [Thread-1  ]: 1 of 5 START table model wetube.account_information ............................ [RUN]
15:16:20.436214 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
15:16:20.436336 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
15:16:20.436455 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
15:16:20.439896 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
15:16:20.440305 [debug] [Thread-1  ]: finished collecting timing info
15:16:20.440434 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
15:16:20.469978 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
15:16:20.470719 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:16:20.470894 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
15:16:20.471007 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:16:20.479028 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:16:20.479230 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:16:20.479344 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (
    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (
    select * from
        "get_dbt"."wetube"."city"
),

source_state as (
    select * from
        "get_dbt"."wetube"."state"
),

source_user_address as (
    select * from
        "get_dbt"."wetube"."user_address"
),

source_account as (
    select * from
        "get_dbt"."wetube"."account"
),

account_info as (
    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name as city_name,
        state.name as state_name,
        channel.id_channel,
        channel.name as channel,
        channel.creation_date as channel_creation
    FROM source_account account
    	inner join source_channel channel on (channel.id_account = account.id_user)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
15:16:20.483493 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.0 seconds
15:16:20.489580 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:16:20.489746 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information" rename to "account_information__dbt_backup"
15:16:20.490179 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:16:20.492396 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:16:20.492531 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information__dbt_tmp" rename to "account_information"
15:16:20.493006 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:16:20.503371 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:16:20.503511 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:16:20.503615 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:16:20.504065 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:16:20.508269 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:16:20.508395 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
drop table if exists "get_dbt"."wetube"."account_information__dbt_backup" cascade
15:16:20.509704 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:16:20.510632 [debug] [Thread-1  ]: finished collecting timing info
15:16:20.510769 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
15:16:20.511088 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a06c8239-a265-43f6-8afb-1796f51f3549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f522b6b50>]}
15:16:20.511383 [info ] [Thread-1  ]: 1 of 5 OK created table model wetube.account_information ....................... [[32mSELECT 5[0m in 0.07s]
15:16:20.511816 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
15:16:20.511986 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
15:16:20.512320 [info ] [Thread-1  ]: 2 of 5 START table model wetube.my_first_dbt_model ............................. [RUN]
15:16:20.512681 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
15:16:20.512805 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
15:16:20.512917 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
15:16:20.514875 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
15:16:20.515246 [debug] [Thread-1  ]: finished collecting timing info
15:16:20.515373 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
15:16:20.517743 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
15:16:20.518112 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:16:20.518229 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
15:16:20.518328 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:16:20.526522 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:16:20.526729 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:16:20.526840 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:16:20.528881 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
15:16:20.531623 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:16:20.531804 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:16:20.532251 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:16:20.535647 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:16:20.535910 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:16:20.536717 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:16:20.538307 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:16:20.538579 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:16:20.538710 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:16:20.539222 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:16:20.541278 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:16:20.541566 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
15:16:20.543923 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:16:20.545291 [debug] [Thread-1  ]: finished collecting timing info
15:16:20.545477 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
15:16:20.545898 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a06c8239-a265-43f6-8afb-1796f51f3549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f52a9dcd0>]}
15:16:20.546271 [info ] [Thread-1  ]: 2 of 5 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.03s]
15:16:20.546712 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
15:16:20.546931 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
15:16:20.547301 [info ] [Thread-1  ]: 3 of 5 START table model wetube.number_of_subs_by_channel ...................... [RUN]
15:16:20.548014 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:16:20.548218 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
15:16:20.548381 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
15:16:20.551937 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:16:20.552497 [debug] [Thread-1  ]: finished collecting timing info
15:16:20.552668 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
15:16:20.555753 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:16:20.556229 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:16:20.556376 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
15:16:20.556519 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:16:20.565599 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:16:20.565792 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:16:20.565923 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
15:16:20.569250 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
15:16:20.572038 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:16:20.572205 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
15:16:20.572667 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:16:20.574847 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:16:20.574990 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
15:16:20.575483 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:16:20.577358 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:16:20.577706 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:16:20.577907 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:16:20.578564 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:16:20.580262 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:16:20.580423 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
15:16:20.593339 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
15:16:20.595043 [debug] [Thread-1  ]: finished collecting timing info
15:16:20.595328 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
15:16:20.595889 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a06c8239-a265-43f6-8afb-1796f51f3549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f526c6b80>]}
15:16:20.596385 [info ] [Thread-1  ]: 3 of 5 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.05s]
15:16:20.596943 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
15:16:20.597494 [debug] [Thread-1  ]: Began running node model.dbt_blog.total_likes_by_video
15:16:20.598057 [info ] [Thread-1  ]: 4 of 5 START table model wetube.total_likes_by_video ........................... [RUN]
15:16:20.598585 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.total_likes_by_video"
15:16:20.598749 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.total_likes_by_video
15:16:20.598897 [debug] [Thread-1  ]: Compiling model.dbt_blog.total_likes_by_video
15:16:20.602423 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.total_likes_by_video"
15:16:20.602955 [debug] [Thread-1  ]: finished collecting timing info
15:16:20.603124 [debug] [Thread-1  ]: Began executing node model.dbt_blog.total_likes_by_video
15:16:20.606208 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.total_likes_by_video"
15:16:20.606692 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:16:20.606846 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: BEGIN
15:16:20.606979 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:16:20.617639 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:16:20.617865 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:16:20.618011 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */


  create  table "get_dbt"."wetube"."total_likes_by_video__dbt_tmp"
  as (
    with source_account_info as (

    select * from
        "get_dbt"."wetube"."account_information"
),

source_video as (

    select * from
        "get_dbt"."wetube"."video"

),


source_video_like as (

    select * from
        "get_dbt"."wetube"."video_like"

),

source_total_like_by_video as (

    select source_account_info.id_channel, source_account_info.channel,
        source_video.id_video, source_video.title, count(*) as total_likes
    FROM source_video_like
        inner join source_video using (id_video)
        inner join source_account_info using (id_channel)
    GROUP BY source_account_info.id_channel,
             source_account_info.channel,
             source_video.id_video
             source_video.title
)

select * from source_total_like_by_video
  );
15:16:20.618752 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "source_video"
LINE 37:              source_video.title
                      ^

15:16:20.618944 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: ROLLBACK
15:16:20.619332 [debug] [Thread-1  ]: finished collecting timing info
15:16:20.619561 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: Close
15:16:20.620200 [debug] [Thread-1  ]: Database Error in model total_likes_by_video (models/mart/total_likes_by_video.sql)
  syntax error at or near "source_video"
  LINE 37:              source_video.title
                        ^
  compiled SQL at target/run/dbt_blog/models/mart/total_likes_by_video.sql
15:16:20.620718 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a06c8239-a265-43f6-8afb-1796f51f3549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f52abbcd0>]}
15:16:20.621162 [error] [Thread-1  ]: 4 of 5 ERROR creating table model wetube.total_likes_by_video .................. [[31mERROR[0m in 0.02s]
15:16:20.621647 [debug] [Thread-1  ]: Finished running node model.dbt_blog.total_likes_by_video
15:16:20.621849 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
15:16:20.622229 [info ] [Thread-1  ]: 5 of 5 START view model wetube.my_second_dbt_model ............................. [RUN]
15:16:20.622880 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
15:16:20.623039 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
15:16:20.623188 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
15:16:20.626279 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
15:16:20.627032 [debug] [Thread-1  ]: finished collecting timing info
15:16:20.627239 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
15:16:20.654196 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
15:16:20.655205 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:16:20.655419 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
15:16:20.655642 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:16:20.666081 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:16:20.666514 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:16:20.666781 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
15:16:20.669406 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:16:20.672173 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:16:20.672382 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:16:20.672880 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:16:20.674239 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:16:20.674415 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:16:20.674545 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:16:20.675097 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:16:20.678590 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:16:20.678787 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
15:16:20.679191 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:16:20.680457 [debug] [Thread-1  ]: finished collecting timing info
15:16:20.680638 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
15:16:20.681048 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a06c8239-a265-43f6-8afb-1796f51f3549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f52abbfd0>]}
15:16:20.681428 [info ] [Thread-1  ]: 5 of 5 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
15:16:20.681846 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
15:16:20.682998 [debug] [MainThread]: Acquiring new postgres connection "master"
15:16:20.683198 [debug] [MainThread]: Using postgres connection "master"
15:16:20.683342 [debug] [MainThread]: On master: BEGIN
15:16:20.683469 [debug] [MainThread]: Opening a new connection, currently in state closed
15:16:20.692275 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:16:20.692474 [debug] [MainThread]: On master: COMMIT
15:16:20.692630 [debug] [MainThread]: Using postgres connection "master"
15:16:20.692755 [debug] [MainThread]: On master: COMMIT
15:16:20.693043 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:16:20.693217 [debug] [MainThread]: On master: Close
15:16:20.693601 [info ] [MainThread]: 
15:16:20.693848 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0.38s.
15:16:20.694080 [debug] [MainThread]: Connection 'master' was properly closed.
15:16:20.694201 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
15:16:20.700907 [info ] [MainThread]: 
15:16:20.701212 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:16:20.701488 [info ] [MainThread]: 
15:16:20.701708 [error] [MainThread]: [33mDatabase Error in model total_likes_by_video (models/mart/total_likes_by_video.sql)[0m
15:16:20.701926 [error] [MainThread]:   syntax error at or near "source_video"
15:16:20.702123 [error] [MainThread]:   LINE 37:              source_video.title
15:16:20.702318 [error] [MainThread]:                         ^
15:16:20.702511 [error] [MainThread]:   compiled SQL at target/run/dbt_blog/models/mart/total_likes_by_video.sql
15:16:20.702737 [info ] [MainThread]: 
15:16:20.702943 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
15:16:20.703237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f52b09e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f526c9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f52adedc0>]}


============================== 2022-07-24 15:18:30.141731 | fabf2cc0-86ea-48b0-bcde-382219f97417 ==============================
15:18:30.141752 [info ] [MainThread]: Running with dbt=1.1.1
15:18:30.142552 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:18:30.142751 [debug] [MainThread]: Tracking: tracking
15:18:30.161412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54f6ef1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54f6efd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54f8301c0>]}
15:18:30.221624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:18:30.222206 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/total_likes_by_video.sql
15:18:30.240127 [debug] [MainThread]: 1699: static parser successfully parsed mart/total_likes_by_video.sql
15:18:30.337026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fabf2cc0-86ea-48b0-bcde-382219f97417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54f5d9ca0>]}
15:18:30.346774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fabf2cc0-86ea-48b0-bcde-382219f97417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54f8fc2b0>]}
15:18:30.347107 [info ] [MainThread]: Found 5 models, 21 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
15:18:30.347391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fabf2cc0-86ea-48b0-bcde-382219f97417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54f5c6670>]}
15:18:30.349554 [info ] [MainThread]: 
15:18:30.350014 [debug] [MainThread]: Acquiring new postgres connection "master"
15:18:30.350986 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
15:18:30.363432 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
15:18:30.363829 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
15:18:30.363992 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:18:30.398773 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.03 seconds
15:18:30.400467 [debug] [ThreadPool]: On list_get_dbt: Close
15:18:30.401883 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
15:18:30.409334 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:18:30.409522 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
15:18:30.409662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:18:30.419785 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:18:30.420013 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:18:30.420162 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
15:18:30.424158 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
15:18:30.425789 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
15:18:30.426074 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
15:18:30.431290 [debug] [MainThread]: Using postgres connection "master"
15:18:30.431480 [debug] [MainThread]: On master: BEGIN
15:18:30.431622 [debug] [MainThread]: Opening a new connection, currently in state init
15:18:30.440786 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:18:30.440985 [debug] [MainThread]: Using postgres connection "master"
15:18:30.441131 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:18:30.483362 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
15:18:30.484649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fabf2cc0-86ea-48b0-bcde-382219f97417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54f6efaf0>]}
15:18:30.484929 [debug] [MainThread]: On master: ROLLBACK
15:18:30.485210 [debug] [MainThread]: Using postgres connection "master"
15:18:30.485344 [debug] [MainThread]: On master: BEGIN
15:18:30.485684 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:18:30.485835 [debug] [MainThread]: On master: COMMIT
15:18:30.485964 [debug] [MainThread]: Using postgres connection "master"
15:18:30.486080 [debug] [MainThread]: On master: COMMIT
15:18:30.486308 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:18:30.486470 [debug] [MainThread]: On master: Close
15:18:30.486794 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:18:30.487024 [info ] [MainThread]: 
15:18:30.489689 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
15:18:30.489942 [info ] [Thread-1  ]: 1 of 5 START table model wetube.account_information ............................ [RUN]
15:18:30.490372 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
15:18:30.490518 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
15:18:30.490658 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
15:18:30.494640 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
15:18:30.495097 [debug] [Thread-1  ]: finished collecting timing info
15:18:30.495252 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
15:18:30.526160 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
15:18:30.527032 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:18:30.527302 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
15:18:30.527464 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:18:30.537376 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:18:30.537603 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:18:30.537748 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (
    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (
    select * from
        "get_dbt"."wetube"."city"
),

source_state as (
    select * from
        "get_dbt"."wetube"."state"
),

source_user_address as (
    select * from
        "get_dbt"."wetube"."user_address"
),

source_account as (
    select * from
        "get_dbt"."wetube"."account"
),

account_info as (
    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name as city_name,
        state.name as state_name,
        channel.id_channel,
        channel.name as channel,
        channel.creation_date as channel_creation
    FROM source_account account
    	inner join source_channel channel on (channel.id_account = account.id_user)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
15:18:30.545861 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
15:18:30.553002 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:18:30.553177 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information" rename to "account_information__dbt_backup"
15:18:30.554520 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:18:30.557219 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:18:30.557403 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information__dbt_tmp" rename to "account_information"
15:18:30.558041 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:18:30.570945 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:18:30.571122 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:18:30.571261 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:18:30.572903 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:18:30.578750 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:18:30.578948 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
drop table if exists "get_dbt"."wetube"."account_information__dbt_backup" cascade
15:18:30.580845 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:18:30.582181 [debug] [Thread-1  ]: finished collecting timing info
15:18:30.582373 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
15:18:30.582814 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabf2cc0-86ea-48b0-bcde-382219f97417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54f2e8d30>]}
15:18:30.583190 [info ] [Thread-1  ]: 1 of 5 OK created table model wetube.account_information ....................... [[32mSELECT 5[0m in 0.09s]
15:18:30.583654 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
15:18:30.583895 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
15:18:30.584250 [info ] [Thread-1  ]: 2 of 5 START table model wetube.my_first_dbt_model ............................. [RUN]
15:18:30.584874 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
15:18:30.585053 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
15:18:30.585203 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
15:18:30.587856 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
15:18:30.588536 [debug] [Thread-1  ]: finished collecting timing info
15:18:30.588730 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
15:18:30.591744 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
15:18:30.592220 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:18:30.592373 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
15:18:30.592505 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:18:30.601936 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:18:30.602186 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:18:30.602626 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:18:30.606437 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
15:18:30.610394 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:18:30.610657 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:18:30.613767 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:18:30.618997 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:18:30.619329 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:18:30.620210 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:18:30.622398 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:18:30.622607 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:18:30.622752 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:18:30.624296 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:18:30.626354 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:18:30.626518 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
15:18:30.629499 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:18:30.630885 [debug] [Thread-1  ]: finished collecting timing info
15:18:30.631083 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
15:18:30.631501 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabf2cc0-86ea-48b0-bcde-382219f97417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54fbb5ca0>]}
15:18:30.631860 [info ] [Thread-1  ]: 2 of 5 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.05s]
15:18:30.632268 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
15:18:30.632467 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
15:18:30.632694 [info ] [Thread-1  ]: 3 of 5 START table model wetube.number_of_subs_by_channel ...................... [RUN]
15:18:30.633115 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:18:30.633477 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
15:18:30.633654 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
15:18:30.637023 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:18:30.637532 [debug] [Thread-1  ]: finished collecting timing info
15:18:30.637710 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
15:18:30.640778 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:18:30.641318 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:18:30.641478 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
15:18:30.641616 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:18:30.652203 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:18:30.652447 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:18:30.652601 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
15:18:30.657651 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
15:18:30.660498 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:18:30.660673 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
15:18:30.661463 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:18:30.664595 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:18:30.664835 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
15:18:30.665500 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:18:30.668710 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:18:30.669109 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:18:30.669338 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:18:30.675136 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
15:18:30.677230 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:18:30.677417 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
15:18:30.679308 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:18:30.680765 [debug] [Thread-1  ]: finished collecting timing info
15:18:30.680963 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
15:18:30.681398 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabf2cc0-86ea-48b0-bcde-382219f97417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54fb9e8b0>]}
15:18:30.681785 [info ] [Thread-1  ]: 3 of 5 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.05s]
15:18:30.682234 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
15:18:30.682447 [debug] [Thread-1  ]: Began running node model.dbt_blog.total_likes_by_video
15:18:30.682777 [info ] [Thread-1  ]: 4 of 5 START table model wetube.total_likes_by_video ........................... [RUN]
15:18:30.683255 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.total_likes_by_video"
15:18:30.683421 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.total_likes_by_video
15:18:30.683574 [debug] [Thread-1  ]: Compiling model.dbt_blog.total_likes_by_video
15:18:30.687066 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.total_likes_by_video"
15:18:30.687541 [debug] [Thread-1  ]: finished collecting timing info
15:18:30.687769 [debug] [Thread-1  ]: Began executing node model.dbt_blog.total_likes_by_video
15:18:30.690872 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.total_likes_by_video"
15:18:30.691375 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:18:30.691530 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: BEGIN
15:18:30.691664 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:18:30.701137 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:18:30.701357 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:18:30.701500 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */


  create  table "get_dbt"."wetube"."total_likes_by_video__dbt_tmp"
  as (
    source_video as (

    select * from
        "get_dbt"."wetube"."video"

),


source_video_like as (

    select * from
        "get_dbt"."wetube"."video_like"

),

with source_account_info as (

    select * from
        "get_dbt"."wetube"."account_information"
),

source_total_like_by_video as (

    select source_account_info.id_channel, source_account_info.channel,
        source_video.id_video, source_video.title, count(*) as total_likes
    FROM source_video_like
        inner join source_video using (id_video)
        inner join source_account_info using (id_channel)
    GROUP BY source_account_info.id_channel,
             source_account_info.channel,
             source_video.id_video
             source_video.title
)

select * from source_total_like_by_video
  );
15:18:30.701953 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "source_video"
LINE 6:     source_video as (
            ^

15:18:30.702127 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: ROLLBACK
15:18:30.702477 [debug] [Thread-1  ]: finished collecting timing info
15:18:30.702648 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: Close
15:18:30.703016 [debug] [Thread-1  ]: Database Error in model total_likes_by_video (models/mart/total_likes_by_video.sql)
  syntax error at or near "source_video"
  LINE 6:     source_video as (
              ^
  compiled SQL at target/run/dbt_blog/models/mart/total_likes_by_video.sql
15:18:30.703291 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabf2cc0-86ea-48b0-bcde-382219f97417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54fbe0ca0>]}
15:18:30.703682 [error] [Thread-1  ]: 4 of 5 ERROR creating table model wetube.total_likes_by_video .................. [[31mERROR[0m in 0.02s]
15:18:30.704192 [debug] [Thread-1  ]: Finished running node model.dbt_blog.total_likes_by_video
15:18:30.704411 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
15:18:30.704794 [info ] [Thread-1  ]: 5 of 5 START view model wetube.my_second_dbt_model ............................. [RUN]
15:18:30.705455 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
15:18:30.705625 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
15:18:30.705777 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
15:18:30.708339 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
15:18:30.708899 [debug] [Thread-1  ]: finished collecting timing info
15:18:30.709133 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
15:18:30.735144 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
15:18:30.736210 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:18:30.736425 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
15:18:30.736569 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:18:30.746654 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:18:30.747219 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:18:30.747516 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
15:18:30.750450 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:18:30.755051 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:18:30.755318 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:18:30.755993 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:18:30.757708 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:18:30.758005 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:18:30.758234 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:18:30.759477 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:18:30.763395 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:18:30.763628 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
15:18:30.764079 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:18:30.765367 [debug] [Thread-1  ]: finished collecting timing info
15:18:30.765554 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
15:18:30.765968 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabf2cc0-86ea-48b0-bcde-382219f97417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54fbe0fd0>]}
15:18:30.766344 [info ] [Thread-1  ]: 5 of 5 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
15:18:30.766766 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
15:18:30.767844 [debug] [MainThread]: Acquiring new postgres connection "master"
15:18:30.768175 [debug] [MainThread]: Using postgres connection "master"
15:18:30.768349 [debug] [MainThread]: On master: BEGIN
15:18:30.768490 [debug] [MainThread]: Opening a new connection, currently in state closed
15:18:30.777676 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:18:30.777917 [debug] [MainThread]: On master: COMMIT
15:18:30.778070 [debug] [MainThread]: Using postgres connection "master"
15:18:30.778209 [debug] [MainThread]: On master: COMMIT
15:18:30.778550 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:18:30.778719 [debug] [MainThread]: On master: Close
15:18:30.779139 [info ] [MainThread]: 
15:18:30.779405 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0.43s.
15:18:30.779652 [debug] [MainThread]: Connection 'master' was properly closed.
15:18:30.779782 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
15:18:30.786981 [info ] [MainThread]: 
15:18:30.787285 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:18:30.787562 [info ] [MainThread]: 
15:18:30.787797 [error] [MainThread]: [33mDatabase Error in model total_likes_by_video (models/mart/total_likes_by_video.sql)[0m
15:18:30.788029 [error] [MainThread]:   syntax error at or near "source_video"
15:18:30.788249 [error] [MainThread]:   LINE 6:     source_video as (
15:18:30.788464 [error] [MainThread]:               ^
15:18:30.788680 [error] [MainThread]:   compiled SQL at target/run/dbt_blog/models/mart/total_likes_by_video.sql
15:18:30.788909 [info ] [MainThread]: 
15:18:30.789228 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
15:18:30.789638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54ef4d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54ef4d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54fbf3d60>]}


============================== 2022-07-24 15:21:50.099707 | 0ad338b1-4771-4a8b-a898-b7edebc4f078 ==============================
15:21:50.099729 [info ] [MainThread]: Running with dbt=1.1.1
15:21:50.100688 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:21:50.100839 [debug] [MainThread]: Tracking: tracking
15:21:50.126055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e44ff35b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e44ff3d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e44ff24f0>]}
15:21:50.195979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:21:50.196215 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:21:50.205680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ad338b1-4771-4a8b-a898-b7edebc4f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e451670d0>]}
15:21:50.215609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ad338b1-4771-4a8b-a898-b7edebc4f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e45072580>]}
15:21:50.215948 [info ] [MainThread]: Found 5 models, 21 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
15:21:50.216238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ad338b1-4771-4a8b-a898-b7edebc4f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e450728b0>]}
15:21:50.218662 [info ] [MainThread]: 
15:21:50.219183 [debug] [MainThread]: Acquiring new postgres connection "master"
15:21:50.220257 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
15:21:50.234099 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
15:21:50.234585 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
15:21:50.234794 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:21:50.276461 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.04 seconds
15:21:50.278293 [debug] [ThreadPool]: On list_get_dbt: Close
15:21:50.279657 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
15:21:50.314884 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:21:50.315102 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
15:21:50.315247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:21:50.325067 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:21:50.325299 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:21:50.325466 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
15:21:50.329395 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
15:21:50.331135 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
15:21:50.331427 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
15:21:50.336438 [debug] [MainThread]: Using postgres connection "master"
15:21:50.336610 [debug] [MainThread]: On master: BEGIN
15:21:50.336744 [debug] [MainThread]: Opening a new connection, currently in state init
15:21:50.346111 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:21:50.346372 [debug] [MainThread]: Using postgres connection "master"
15:21:50.346521 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:21:50.391546 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
15:21:50.392925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ad338b1-4771-4a8b-a898-b7edebc4f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4504e640>]}
15:21:50.393208 [debug] [MainThread]: On master: ROLLBACK
15:21:50.393469 [debug] [MainThread]: Using postgres connection "master"
15:21:50.393606 [debug] [MainThread]: On master: BEGIN
15:21:50.393944 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:21:50.394100 [debug] [MainThread]: On master: COMMIT
15:21:50.394246 [debug] [MainThread]: Using postgres connection "master"
15:21:50.394369 [debug] [MainThread]: On master: COMMIT
15:21:50.394593 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:21:50.394742 [debug] [MainThread]: On master: Close
15:21:50.395079 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:21:50.395318 [info ] [MainThread]: 
15:21:50.399712 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
15:21:50.399998 [info ] [Thread-1  ]: 1 of 5 START table model wetube.account_information ............................ [RUN]
15:21:50.400443 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
15:21:50.400593 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
15:21:50.400746 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
15:21:50.405016 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
15:21:50.405473 [debug] [Thread-1  ]: finished collecting timing info
15:21:50.405634 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
15:21:50.441621 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
15:21:50.442345 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:21:50.442508 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
15:21:50.442642 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:21:50.451886 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:21:50.452069 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:21:50.452208 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (
    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (
    select * from
        "get_dbt"."wetube"."city"
),

source_state as (
    select * from
        "get_dbt"."wetube"."state"
),

source_user_address as (
    select * from
        "get_dbt"."wetube"."user_address"
),

source_account as (
    select * from
        "get_dbt"."wetube"."account"
),

account_info as (
    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name as city_name,
        state.name as state_name,
        channel.id_channel,
        channel.name as channel,
        channel.creation_date as channel_creation
    FROM source_account account
    	inner join source_channel channel on (channel.id_account = account.id_user)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
15:21:50.459908 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
15:21:50.467129 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:21:50.467309 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information" rename to "account_information__dbt_backup"
15:21:50.468679 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:50.471462 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:21:50.471668 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information__dbt_tmp" rename to "account_information"
15:21:50.472278 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:50.485460 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:21:50.485640 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:21:50.485775 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:21:50.487159 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:21:50.493049 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:21:50.493233 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
drop table if exists "get_dbt"."wetube"."account_information__dbt_backup" cascade
15:21:50.495856 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:21:50.497225 [debug] [Thread-1  ]: finished collecting timing info
15:21:50.497414 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
15:21:50.497838 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ad338b1-4771-4a8b-a898-b7edebc4f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e45159820>]}
15:21:50.498207 [info ] [Thread-1  ]: 1 of 5 OK created table model wetube.account_information ....................... [[32mSELECT 5[0m in 0.10s]
15:21:50.498654 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
15:21:50.498857 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
15:21:50.499282 [info ] [Thread-1  ]: 2 of 5 START table model wetube.my_first_dbt_model ............................. [RUN]
15:21:50.499746 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
15:21:50.499898 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
15:21:50.500041 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
15:21:50.502789 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
15:21:50.503367 [debug] [Thread-1  ]: finished collecting timing info
15:21:50.503541 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
15:21:50.506830 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
15:21:50.507403 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:21:50.507618 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
15:21:50.507815 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:21:50.518583 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:21:50.518843 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:21:50.518997 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:21:50.522988 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
15:21:50.526164 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:21:50.526393 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:21:50.527038 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:50.530917 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:21:50.531176 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:21:50.531942 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:50.533999 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:21:50.534215 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:21:50.534361 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:21:50.535211 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:21:50.537169 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:21:50.537323 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
15:21:50.540253 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:21:50.541501 [debug] [Thread-1  ]: finished collecting timing info
15:21:50.541681 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
15:21:50.542083 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ad338b1-4771-4a8b-a898-b7edebc4f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e451d3eb0>]}
15:21:50.542443 [info ] [Thread-1  ]: 2 of 5 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.04s]
15:21:50.542851 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
15:21:50.543048 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
15:21:50.543270 [info ] [Thread-1  ]: 3 of 5 START table model wetube.number_of_subs_by_channel ...................... [RUN]
15:21:50.543936 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:21:50.544101 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
15:21:50.544254 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
15:21:50.547368 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:21:50.547933 [debug] [Thread-1  ]: finished collecting timing info
15:21:50.548101 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
15:21:50.551321 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:21:50.551941 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:21:50.552172 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
15:21:50.552324 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:21:50.562650 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:21:50.562987 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:21:50.563153 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
15:21:50.567626 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
15:21:50.571069 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:21:50.571357 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
15:21:50.572548 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:50.575162 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:21:50.575332 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
15:21:50.576156 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:50.578264 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:21:50.578537 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:21:50.578692 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:21:50.579460 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:21:50.581439 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:21:50.581631 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
15:21:50.583443 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:21:50.584820 [debug] [Thread-1  ]: finished collecting timing info
15:21:50.585000 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
15:21:50.585398 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ad338b1-4771-4a8b-a898-b7edebc4f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e45049790>]}
15:21:50.585753 [info ] [Thread-1  ]: 3 of 5 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.04s]
15:21:50.586168 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
15:21:50.586495 [debug] [Thread-1  ]: Began running node model.dbt_blog.total_likes_by_video
15:21:50.586741 [info ] [Thread-1  ]: 4 of 5 START table model wetube.total_likes_by_video ........................... [RUN]
15:21:50.587195 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.total_likes_by_video"
15:21:50.587428 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.total_likes_by_video
15:21:50.587602 [debug] [Thread-1  ]: Compiling model.dbt_blog.total_likes_by_video
15:21:50.591000 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.total_likes_by_video"
15:21:50.591480 [debug] [Thread-1  ]: finished collecting timing info
15:21:50.591691 [debug] [Thread-1  ]: Began executing node model.dbt_blog.total_likes_by_video
15:21:50.594853 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.total_likes_by_video"
15:21:50.595469 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:21:50.595624 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: BEGIN
15:21:50.595757 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:21:50.607097 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:21:50.607347 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:21:50.607495 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */


  create  table "get_dbt"."wetube"."total_likes_by_video__dbt_tmp"
  as (
    source_video as (

    select * from
        "get_dbt"."wetube"."video"

),


source_video_like as (

    select * from
        "get_dbt"."wetube"."video_like"

),

with source_account_info as (

    select * from
        "get_dbt"."wetube"."account_information"
),

source_total_like_by_video as (

    select source_account_info.id_channel, source_account_info.channel,
        source_video.id_video, source_video.title, count(*) as total_likes
    FROM source_video_like
        inner join source_video using (id_video)
        inner join source_account_info using (id_channel)
    GROUP BY source_account_info.id_channel,
             source_account_info.channel,
             source_video.id_video
             source_video.title
)

select * from source_total_like_by_video
  );
15:21:50.608237 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "source_video"
LINE 6:     source_video as (
            ^

15:21:50.608634 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: ROLLBACK
15:21:50.609316 [debug] [Thread-1  ]: finished collecting timing info
15:21:50.609690 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: Close
15:21:50.610318 [debug] [Thread-1  ]: Database Error in model total_likes_by_video (models/mart/total_likes_by_video.sql)
  syntax error at or near "source_video"
  LINE 6:     source_video as (
              ^
  compiled SQL at target/run/dbt_blog/models/mart/total_likes_by_video.sql
15:21:50.610880 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ad338b1-4771-4a8b-a898-b7edebc4f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e451ff370>]}
15:21:50.611274 [error] [Thread-1  ]: 4 of 5 ERROR creating table model wetube.total_likes_by_video .................. [[31mERROR[0m in 0.02s]
15:21:50.611760 [debug] [Thread-1  ]: Finished running node model.dbt_blog.total_likes_by_video
15:21:50.611970 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
15:21:50.612519 [info ] [Thread-1  ]: 5 of 5 START view model wetube.my_second_dbt_model ............................. [RUN]
15:21:50.613049 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
15:21:50.613210 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
15:21:50.613360 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
15:21:50.616487 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
15:21:50.617355 [debug] [Thread-1  ]: finished collecting timing info
15:21:50.617583 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
15:21:50.644649 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
15:21:50.646270 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:21:50.646594 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
15:21:50.646786 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:21:50.658341 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:21:50.658706 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:21:50.658896 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
15:21:50.662029 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:21:50.664875 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:21:50.665051 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:21:50.665552 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:50.667006 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:21:50.667173 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:21:50.667311 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:21:50.667855 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:21:50.670746 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:21:50.670901 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
15:21:50.671256 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:21:50.672529 [debug] [Thread-1  ]: finished collecting timing info
15:21:50.672708 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
15:21:50.673113 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ad338b1-4771-4a8b-a898-b7edebc4f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e44eed130>]}
15:21:50.673471 [info ] [Thread-1  ]: 5 of 5 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
15:21:50.673881 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
15:21:50.674996 [debug] [MainThread]: Acquiring new postgres connection "master"
15:21:50.675190 [debug] [MainThread]: Using postgres connection "master"
15:21:50.675332 [debug] [MainThread]: On master: BEGIN
15:21:50.675456 [debug] [MainThread]: Opening a new connection, currently in state closed
15:21:50.685270 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:21:50.685510 [debug] [MainThread]: On master: COMMIT
15:21:50.685667 [debug] [MainThread]: Using postgres connection "master"
15:21:50.685820 [debug] [MainThread]: On master: COMMIT
15:21:50.686082 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:21:50.686270 [debug] [MainThread]: On master: Close
15:21:50.686785 [info ] [MainThread]: 
15:21:50.687124 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0.47s.
15:21:50.687519 [debug] [MainThread]: Connection 'master' was properly closed.
15:21:50.687806 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
15:21:50.696140 [info ] [MainThread]: 
15:21:50.696471 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:21:50.696768 [info ] [MainThread]: 
15:21:50.697019 [error] [MainThread]: [33mDatabase Error in model total_likes_by_video (models/mart/total_likes_by_video.sql)[0m
15:21:50.697272 [error] [MainThread]:   syntax error at or near "source_video"
15:21:50.697495 [error] [MainThread]:   LINE 6:     source_video as (
15:21:50.697707 [error] [MainThread]:               ^
15:21:50.697918 [error] [MainThread]:   compiled SQL at target/run/dbt_blog/models/mart/total_likes_by_video.sql
15:21:50.698183 [info ] [MainThread]: 
15:21:50.698676 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
15:21:50.699126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e44f16a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e44f16130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e44eed5e0>]}


============================== 2022-07-24 15:27:40.585793 | cc2a091c-633e-4705-afed-e176902db78d ==============================
15:27:40.585816 [info ] [MainThread]: Running with dbt=1.1.1
15:27:40.587174 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:27:40.587320 [debug] [MainThread]: Tracking: tracking
15:27:40.608723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ffed0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ffed0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ffecb550>]}
15:27:40.697893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:27:40.698659 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/total_likes_by_video.sql
15:27:40.718622 [debug] [MainThread]: 1699: static parser successfully parsed mart/total_likes_by_video.sql
15:27:40.832120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc2a091c-633e-4705-afed-e176902db78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ffdb3df0>]}
15:27:40.845027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc2a091c-633e-4705-afed-e176902db78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3000fd2e0>]}
15:27:40.845614 [info ] [MainThread]: Found 5 models, 21 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
15:27:40.846508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc2a091c-633e-4705-afed-e176902db78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ffda06a0>]}
15:27:40.849643 [info ] [MainThread]: 
15:27:40.850511 [debug] [MainThread]: Acquiring new postgres connection "master"
15:27:40.852061 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
15:27:40.867421 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
15:27:40.867702 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
15:27:40.867920 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:27:40.935352 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.07 seconds
15:27:40.936923 [debug] [ThreadPool]: On list_get_dbt: Close
15:27:40.938318 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
15:27:40.945914 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:27:40.946134 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
15:27:40.946286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:27:40.956098 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:27:40.956331 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:27:40.956485 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
15:27:40.961865 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.01 seconds
15:27:40.963468 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
15:27:40.963746 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
15:27:40.968942 [debug] [MainThread]: Using postgres connection "master"
15:27:40.969149 [debug] [MainThread]: On master: BEGIN
15:27:40.969308 [debug] [MainThread]: Opening a new connection, currently in state init
15:27:40.978433 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:27:40.978696 [debug] [MainThread]: Using postgres connection "master"
15:27:40.978854 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:27:41.027585 [debug] [MainThread]: SQL status: SELECT 2 in 0.05 seconds
15:27:41.029084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc2a091c-633e-4705-afed-e176902db78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ffebc670>]}
15:27:41.029432 [debug] [MainThread]: On master: ROLLBACK
15:27:41.029737 [debug] [MainThread]: Using postgres connection "master"
15:27:41.029888 [debug] [MainThread]: On master: BEGIN
15:27:41.030273 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:27:41.030442 [debug] [MainThread]: On master: COMMIT
15:27:41.030589 [debug] [MainThread]: Using postgres connection "master"
15:27:41.030721 [debug] [MainThread]: On master: COMMIT
15:27:41.030948 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:27:41.031115 [debug] [MainThread]: On master: Close
15:27:41.031469 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:27:41.031726 [info ] [MainThread]: 
15:27:41.035930 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
15:27:41.036212 [info ] [Thread-1  ]: 1 of 5 START table model wetube.account_information ............................ [RUN]
15:27:41.036662 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
15:27:41.036812 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
15:27:41.036959 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
15:27:41.041341 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
15:27:41.042143 [debug] [Thread-1  ]: finished collecting timing info
15:27:41.042329 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
15:27:41.082495 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
15:27:41.083329 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:27:41.083510 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
15:27:41.083656 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:27:41.093478 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:27:41.093711 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:27:41.093879 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (
    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (
    select * from
        "get_dbt"."wetube"."city"
),

source_state as (
    select * from
        "get_dbt"."wetube"."state"
),

source_user_address as (
    select * from
        "get_dbt"."wetube"."user_address"
),

source_account as (
    select * from
        "get_dbt"."wetube"."account"
),

account_info as (
    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name as city_name,
        state.name as state_name,
        channel.id_channel,
        channel.name as channel,
        channel.creation_date as channel_creation
    FROM source_account account
    	inner join source_channel channel on (channel.id_account = account.id_user)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
15:27:41.103354 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
15:27:41.111816 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:27:41.112097 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information" rename to "account_information__dbt_backup"
15:27:41.112678 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:27:41.115747 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:27:41.115942 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information__dbt_tmp" rename to "account_information"
15:27:41.116532 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:27:41.130214 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:27:41.130451 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:27:41.130612 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:27:41.131211 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:27:41.136984 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:27:41.137197 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
drop table if exists "get_dbt"."wetube"."account_information__dbt_backup" cascade
15:27:41.140858 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:27:41.142131 [debug] [Thread-1  ]: finished collecting timing info
15:27:41.142322 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
15:27:41.142747 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2a091c-633e-4705-afed-e176902db78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3001602b0>]}
15:27:41.143122 [info ] [Thread-1  ]: 1 of 5 OK created table model wetube.account_information ....................... [[32mSELECT 5[0m in 0.11s]
15:27:41.143578 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
15:27:41.143782 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
15:27:41.144189 [info ] [Thread-1  ]: 2 of 5 START table model wetube.my_first_dbt_model ............................. [RUN]
15:27:41.144795 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
15:27:41.144964 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
15:27:41.145124 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
15:27:41.147993 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
15:27:41.149234 [debug] [Thread-1  ]: finished collecting timing info
15:27:41.149415 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
15:27:41.152544 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
15:27:41.153030 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:27:41.153183 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
15:27:41.153317 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:27:41.162801 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:27:41.163021 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:27:41.163169 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:27:41.165465 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
15:27:41.168574 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:27:41.168812 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:27:41.169412 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:27:41.174156 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:27:41.174452 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:27:41.175191 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:27:41.177016 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:27:41.177190 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:27:41.177334 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:27:41.178101 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:27:41.180903 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:27:41.181149 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
15:27:41.184266 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:27:41.186024 [debug] [Thread-1  ]: finished collecting timing info
15:27:41.186376 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
15:27:41.186966 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2a091c-633e-4705-afed-e176902db78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3003b8cd0>]}
15:27:41.187410 [info ] [Thread-1  ]: 2 of 5 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.04s]
15:27:41.187859 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
15:27:41.188074 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
15:27:41.188329 [info ] [Thread-1  ]: 3 of 5 START table model wetube.number_of_subs_by_channel ...................... [RUN]
15:27:41.189084 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:27:41.189282 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
15:27:41.189455 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
15:27:41.193409 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:27:41.194441 [debug] [Thread-1  ]: finished collecting timing info
15:27:41.194665 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
15:27:41.197754 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:27:41.198258 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:27:41.198479 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
15:27:41.198632 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:27:41.207807 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:27:41.208049 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:27:41.208232 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
15:27:41.213893 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.01 seconds
15:27:41.216881 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:27:41.217333 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
15:27:41.217953 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:27:41.221038 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:27:41.221779 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
15:27:41.222923 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:27:41.225212 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:27:41.225405 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:27:41.225549 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:27:41.226297 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:27:41.228056 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:27:41.228296 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
15:27:41.231118 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:27:41.232886 [debug] [Thread-1  ]: finished collecting timing info
15:27:41.233111 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
15:27:41.233558 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2a091c-633e-4705-afed-e176902db78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3003a0520>]}
15:27:41.233970 [info ] [Thread-1  ]: 3 of 5 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.04s]
15:27:41.234559 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
15:27:41.234916 [debug] [Thread-1  ]: Began running node model.dbt_blog.total_likes_by_video
15:27:41.235510 [info ] [Thread-1  ]: 4 of 5 START table model wetube.total_likes_by_video ........................... [RUN]
15:27:41.236467 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.total_likes_by_video"
15:27:41.236930 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.total_likes_by_video
15:27:41.237295 [debug] [Thread-1  ]: Compiling model.dbt_blog.total_likes_by_video
15:27:41.241086 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.total_likes_by_video"
15:27:41.241743 [debug] [Thread-1  ]: finished collecting timing info
15:27:41.241981 [debug] [Thread-1  ]: Began executing node model.dbt_blog.total_likes_by_video
15:27:41.245761 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.total_likes_by_video"
15:27:41.246440 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:27:41.246611 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: BEGIN
15:27:41.246763 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:27:41.257047 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:27:41.257285 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:27:41.257444 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */


  create  table "get_dbt"."wetube"."total_likes_by_video__dbt_tmp"
  as (
    with source_video as (

    select * from
        "get_dbt"."wetube"."video"

),


source_video_like as (

    select * from
        "get_dbt"."wetube"."video_like"

),

source_account_info as (

    select * from
        "get_dbt"."wetube"."account_information"
),

source_total_like_by_video as (

    select source_account_info.id_channel, source_account_info.channel,
        source_video.id_video, source_video.title, count(*) as total_likes
    FROM source_video_like
        inner join source_video using (id_video)
        inner join source_account_info using (id_channel)
    GROUP BY source_account_info.id_channel,
             source_account_info.channel,
             source_video.id_video
             source_video.title
)

select * from source_total_like_by_video
  );
15:27:41.258002 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "source_video"
LINE 37:              source_video.title
                      ^

15:27:41.258390 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: ROLLBACK
15:27:41.258840 [debug] [Thread-1  ]: finished collecting timing info
15:27:41.259025 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: Close
15:27:41.259431 [debug] [Thread-1  ]: Database Error in model total_likes_by_video (models/mart/total_likes_by_video.sql)
  syntax error at or near "source_video"
  LINE 37:              source_video.title
                        ^
  compiled SQL at target/run/dbt_blog/models/mart/total_likes_by_video.sql
15:27:41.259709 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2a091c-633e-4705-afed-e176902db78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3003e2cd0>]}
15:27:41.260091 [error] [Thread-1  ]: 4 of 5 ERROR creating table model wetube.total_likes_by_video .................. [[31mERROR[0m in 0.02s]
15:27:41.260554 [debug] [Thread-1  ]: Finished running node model.dbt_blog.total_likes_by_video
15:27:41.260756 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
15:27:41.261146 [info ] [Thread-1  ]: 5 of 5 START view model wetube.my_second_dbt_model ............................. [RUN]
15:27:41.262200 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
15:27:41.262492 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
15:27:41.262712 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
15:27:41.266437 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
15:27:41.267540 [debug] [Thread-1  ]: finished collecting timing info
15:27:41.267806 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
15:27:41.295505 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
15:27:41.296180 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:27:41.296354 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
15:27:41.296497 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:27:41.307876 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:27:41.308402 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:27:41.308664 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
15:27:41.312048 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:27:41.315469 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:27:41.315700 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:27:41.316309 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:27:41.317952 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:27:41.318146 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:27:41.318320 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:27:41.318963 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:27:41.321931 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:27:41.322168 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
15:27:41.322573 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:27:41.323852 [debug] [Thread-1  ]: finished collecting timing info
15:27:41.324061 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
15:27:41.324504 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2a091c-633e-4705-afed-e176902db78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3003e2fa0>]}
15:27:41.324909 [info ] [Thread-1  ]: 5 of 5 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
15:27:41.325371 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
15:27:41.326527 [debug] [MainThread]: Acquiring new postgres connection "master"
15:27:41.326741 [debug] [MainThread]: Using postgres connection "master"
15:27:41.326895 [debug] [MainThread]: On master: BEGIN
15:27:41.327039 [debug] [MainThread]: Opening a new connection, currently in state closed
15:27:41.337934 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:27:41.338220 [debug] [MainThread]: On master: COMMIT
15:27:41.338388 [debug] [MainThread]: Using postgres connection "master"
15:27:41.338531 [debug] [MainThread]: On master: COMMIT
15:27:41.338794 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:27:41.338995 [debug] [MainThread]: On master: Close
15:27:41.339426 [info ] [MainThread]: 
15:27:41.339692 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0.49s.
15:27:41.339936 [debug] [MainThread]: Connection 'master' was properly closed.
15:27:41.340066 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
15:27:41.347995 [info ] [MainThread]: 
15:27:41.348474 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:27:41.348980 [info ] [MainThread]: 
15:27:41.349407 [error] [MainThread]: [33mDatabase Error in model total_likes_by_video (models/mart/total_likes_by_video.sql)[0m
15:27:41.349656 [error] [MainThread]:   syntax error at or near "source_video"
15:27:41.349873 [error] [MainThread]:   LINE 37:              source_video.title
15:27:41.350087 [error] [MainThread]:                         ^
15:27:41.350297 [error] [MainThread]:   compiled SQL at target/run/dbt_blog/models/mart/total_likes_by_video.sql
15:27:41.350528 [info ] [MainThread]: 
15:27:41.350763 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
15:27:41.351288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff30041ee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ffebd490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff30040b040>]}


============================== 2022-07-24 15:33:43.097753 | b5e8cb05-c5fb-48c7-9090-58f597f95205 ==============================
15:33:43.097777 [info ] [MainThread]: Running with dbt=1.1.1
15:33:43.098447 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:33:43.098602 [debug] [MainThread]: Tracking: tracking
15:33:43.122729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd0ed45b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd0ed4d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd0ed84f0>]}
15:33:43.187207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:33:43.187750 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/total_likes_by_video.sql
15:33:43.203270 [debug] [MainThread]: 1699: static parser successfully parsed mart/total_likes_by_video.sql
15:33:43.297240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5e8cb05-c5fb-48c7-9090-58f597f95205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd0dbffd0>]}
15:33:43.306932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5e8cb05-c5fb-48c7-9090-58f597f95205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd10fc310>]}
15:33:43.307291 [info ] [MainThread]: Found 5 models, 21 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
15:33:43.307585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5e8cb05-c5fb-48c7-9090-58f597f95205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd0dad6d0>]}
15:33:43.309742 [info ] [MainThread]: 
15:33:43.310214 [debug] [MainThread]: Acquiring new postgres connection "master"
15:33:43.311190 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
15:33:43.322569 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
15:33:43.322767 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
15:33:43.322917 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:33:43.361611 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.04 seconds
15:33:43.363187 [debug] [ThreadPool]: On list_get_dbt: Close
15:33:43.364559 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
15:33:43.372023 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:33:43.372215 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
15:33:43.372359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:33:43.381598 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:33:43.381803 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:33:43.381952 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
15:33:43.386049 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
15:33:43.387733 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
15:33:43.388010 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
15:33:43.393152 [debug] [MainThread]: Using postgres connection "master"
15:33:43.393328 [debug] [MainThread]: On master: BEGIN
15:33:43.393468 [debug] [MainThread]: Opening a new connection, currently in state init
15:33:43.402780 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:33:43.402973 [debug] [MainThread]: Using postgres connection "master"
15:33:43.403102 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:33:43.444204 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
15:33:43.445539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5e8cb05-c5fb-48c7-9090-58f597f95205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd104fb50>]}
15:33:43.445798 [debug] [MainThread]: On master: ROLLBACK
15:33:43.446038 [debug] [MainThread]: Using postgres connection "master"
15:33:43.446163 [debug] [MainThread]: On master: BEGIN
15:33:43.446461 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:33:43.446609 [debug] [MainThread]: On master: COMMIT
15:33:43.446736 [debug] [MainThread]: Using postgres connection "master"
15:33:43.446848 [debug] [MainThread]: On master: COMMIT
15:33:43.447049 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:33:43.447186 [debug] [MainThread]: On master: Close
15:33:43.447484 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:33:43.447705 [info ] [MainThread]: 
15:33:43.452673 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
15:33:43.452983 [info ] [Thread-1  ]: 1 of 5 START table model wetube.account_information ............................ [RUN]
15:33:43.453425 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
15:33:43.453573 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
15:33:43.453712 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
15:33:43.457866 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
15:33:43.458421 [debug] [Thread-1  ]: finished collecting timing info
15:33:43.458591 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
15:33:43.494118 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
15:33:43.494758 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:33:43.494918 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
15:33:43.495051 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:33:43.504862 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:33:43.505074 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:33:43.505228 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (
    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (
    select * from
        "get_dbt"."wetube"."city"
),

source_state as (
    select * from
        "get_dbt"."wetube"."state"
),

source_user_address as (
    select * from
        "get_dbt"."wetube"."user_address"
),

source_account as (
    select * from
        "get_dbt"."wetube"."account"
),

account_info as (
    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name as city_name,
        state.name as state_name,
        channel.id_channel,
        channel.name as channel,
        channel.creation_date as channel_creation
    FROM source_account account
    	inner join source_channel channel on (channel.id_account = account.id_user)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
15:33:43.518691 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
15:33:43.526008 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:33:43.526194 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information" rename to "account_information__dbt_backup"
15:33:43.526740 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:33:43.529045 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:33:43.529206 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information__dbt_tmp" rename to "account_information"
15:33:43.529710 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:33:43.542627 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:33:43.542831 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:33:43.542969 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:33:43.543732 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:33:43.549158 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:33:43.549324 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
drop table if exists "get_dbt"."wetube"."account_information__dbt_backup" cascade
15:33:43.552641 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:33:43.553979 [debug] [Thread-1  ]: finished collecting timing info
15:33:43.554163 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
15:33:43.554572 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5e8cb05-c5fb-48c7-9090-58f597f95205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd1318040>]}
15:33:43.554924 [info ] [Thread-1  ]: 1 of 5 OK created table model wetube.account_information ....................... [[32mSELECT 5[0m in 0.10s]
15:33:43.555353 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
15:33:43.555545 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
15:33:43.555763 [info ] [Thread-1  ]: 2 of 5 START table model wetube.my_first_dbt_model ............................. [RUN]
15:33:43.556174 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
15:33:43.556327 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
15:33:43.556487 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
15:33:43.559242 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
15:33:43.559768 [debug] [Thread-1  ]: finished collecting timing info
15:33:43.559933 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
15:33:43.562910 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
15:33:43.563423 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:33:43.563578 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
15:33:43.563707 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:33:43.572579 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:33:43.572788 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:33:43.572921 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:33:43.576753 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
15:33:43.579501 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:33:43.579678 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:33:43.580789 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:33:43.584912 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:33:43.585153 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:33:43.585824 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:33:43.587534 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:33:43.587757 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:33:43.587905 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:33:43.594979 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
15:33:43.597573 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:33:43.597805 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
15:33:43.601079 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:33:43.602502 [debug] [Thread-1  ]: finished collecting timing info
15:33:43.602781 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
15:33:43.603332 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5e8cb05-c5fb-48c7-9090-58f597f95205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd13b5d00>]}
15:33:43.603790 [info ] [Thread-1  ]: 2 of 5 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.05s]
15:33:43.604287 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
15:33:43.604544 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
15:33:43.605009 [info ] [Thread-1  ]: 3 of 5 START table model wetube.number_of_subs_by_channel ...................... [RUN]
15:33:43.605709 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:33:43.605883 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
15:33:43.606035 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
15:33:43.609141 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:33:43.609677 [debug] [Thread-1  ]: finished collecting timing info
15:33:43.609848 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
15:33:43.612880 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:33:43.613388 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:33:43.613542 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
15:33:43.613675 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:33:43.629074 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
15:33:43.629434 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:33:43.629648 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
15:33:43.635162 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.01 seconds
15:33:43.638430 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:33:43.638712 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
15:33:43.639464 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:33:43.642109 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:33:43.642321 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
15:33:43.642979 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:33:43.644815 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:33:43.645006 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:33:43.645157 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:33:43.646091 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:33:43.648620 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:33:43.648841 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
15:33:43.651013 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:33:43.652539 [debug] [Thread-1  ]: finished collecting timing info
15:33:43.652761 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
15:33:43.653193 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5e8cb05-c5fb-48c7-9090-58f597f95205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd138ce80>]}
15:33:43.653558 [info ] [Thread-1  ]: 3 of 5 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.05s]
15:33:43.653987 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
15:33:43.654266 [debug] [Thread-1  ]: Began running node model.dbt_blog.total_likes_by_video
15:33:43.654536 [info ] [Thread-1  ]: 4 of 5 START table model wetube.total_likes_by_video ........................... [RUN]
15:33:43.655098 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.total_likes_by_video"
15:33:43.655265 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.total_likes_by_video
15:33:43.655412 [debug] [Thread-1  ]: Compiling model.dbt_blog.total_likes_by_video
15:33:43.659060 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.total_likes_by_video"
15:33:43.659594 [debug] [Thread-1  ]: finished collecting timing info
15:33:43.659767 [debug] [Thread-1  ]: Began executing node model.dbt_blog.total_likes_by_video
15:33:43.663499 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.total_likes_by_video"
15:33:43.664218 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:33:43.664393 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: BEGIN
15:33:43.664600 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:33:43.679325 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:33:43.679621 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:33:43.679778 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */


  create  table "get_dbt"."wetube"."total_likes_by_video__dbt_tmp"
  as (
    with source_video as (

    select * from
        "get_dbt"."wetube"."video"

),


source_video_like as (

    select * from
        "get_dbt"."wetube"."video_like"

),

source_account_info as (

    select * from
        "get_dbt"."wetube"."account_information"
),

source_total_like_by_video as (

    select source_account_info.id_channel, source_account_info.channel,
        source_video.id_video, source_video.title, count(*) as total_likes
    FROM source_video_like
        inner join source_video using (id_video)
        inner join source_account_info using (id_channel)
    GROUP BY source_account_info.id_channel,
             source_account_info.channel,
             source_video.id_video,
             source_video.title
)

select * from source_total_like_by_video
  );
15:33:43.689165 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.01 seconds
15:33:43.692432 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:33:43.692663 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */
alter table "get_dbt"."wetube"."total_likes_by_video__dbt_tmp" rename to "total_likes_by_video"
15:33:43.693354 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:33:43.695130 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: COMMIT
15:33:43.695562 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:33:43.695768 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: COMMIT
15:33:43.696744 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:33:43.698784 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:33:43.698951 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */
drop table if exists "get_dbt"."wetube"."total_likes_by_video__dbt_backup" cascade
15:33:43.699337 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:33:43.700579 [debug] [Thread-1  ]: finished collecting timing info
15:33:43.700782 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: Close
15:33:43.701195 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5e8cb05-c5fb-48c7-9090-58f597f95205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd13c0e20>]}
15:33:43.701565 [info ] [Thread-1  ]: 4 of 5 OK created table model wetube.total_likes_by_video ...................... [[32mSELECT 12[0m in 0.05s]
15:33:43.702023 [debug] [Thread-1  ]: Finished running node model.dbt_blog.total_likes_by_video
15:33:43.702224 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
15:33:43.702572 [info ] [Thread-1  ]: 5 of 5 START view model wetube.my_second_dbt_model ............................. [RUN]
15:33:43.703065 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
15:33:43.703231 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
15:33:43.703383 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
15:33:43.705908 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
15:33:43.706481 [debug] [Thread-1  ]: finished collecting timing info
15:33:43.706653 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
15:33:43.728448 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
15:33:43.729089 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:33:43.729259 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
15:33:43.729394 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:33:43.740425 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:33:43.740682 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:33:43.740838 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
15:33:43.744881 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:33:43.749470 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:33:43.749806 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:33:43.750533 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:33:43.752333 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:33:43.752546 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:33:43.752690 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:33:43.753413 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:33:43.755288 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:33:43.755462 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
15:33:43.755847 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:33:43.757100 [debug] [Thread-1  ]: finished collecting timing info
15:33:43.757285 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
15:33:43.757714 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5e8cb05-c5fb-48c7-9090-58f597f95205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd13d7700>]}
15:33:43.758096 [info ] [Thread-1  ]: 5 of 5 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
15:33:43.758505 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
15:33:43.759559 [debug] [MainThread]: Acquiring new postgres connection "master"
15:33:43.759759 [debug] [MainThread]: Using postgres connection "master"
15:33:43.759902 [debug] [MainThread]: On master: BEGIN
15:33:43.760040 [debug] [MainThread]: Opening a new connection, currently in state closed
15:33:43.769442 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:33:43.769684 [debug] [MainThread]: On master: COMMIT
15:33:43.769832 [debug] [MainThread]: Using postgres connection "master"
15:33:43.770090 [debug] [MainThread]: On master: COMMIT
15:33:43.770402 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:33:43.770595 [debug] [MainThread]: On master: Close
15:33:43.771017 [info ] [MainThread]: 
15:33:43.771288 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0.46s.
15:33:43.771616 [debug] [MainThread]: Connection 'master' was properly closed.
15:33:43.771752 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
15:33:43.780885 [info ] [MainThread]: 
15:33:43.781516 [info ] [MainThread]: [32mCompleted successfully[0m
15:33:43.781842 [info ] [MainThread]: 
15:33:43.782077 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
15:33:43.782407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd1044c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd1155340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd1436b80>]}


============================== 2022-07-24 15:35:29.401712 | 0a254568-17f3-42e0-af4d-eaf7793ea2ff ==============================
15:35:29.401744 [info ] [MainThread]: Running with dbt=1.1.1
15:35:29.403186 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:35:29.403370 [debug] [MainThread]: Tracking: tracking
15:35:29.427524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb69f2b520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb69f2bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb69f29550>]}
15:35:29.497367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:35:29.497993 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/total_likes_by_video.sql
15:35:29.536319 [debug] [MainThread]: 1699: static parser successfully parsed mart/total_likes_by_video.sql
15:35:29.740228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a254568-17f3-42e0-af4d-eaf7793ea2ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb69e11df0>]}
15:35:29.758245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a254568-17f3-42e0-af4d-eaf7793ea2ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb6a13c2e0>]}
15:35:29.758711 [info ] [MainThread]: Found 5 models, 21 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
15:35:29.759082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a254568-17f3-42e0-af4d-eaf7793ea2ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb69dfe6a0>]}
15:35:29.767760 [info ] [MainThread]: 
15:35:29.769935 [debug] [MainThread]: Acquiring new postgres connection "master"
15:35:29.771980 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
15:35:29.794706 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
15:35:29.795066 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
15:35:29.795284 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:35:29.879947 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.08 seconds
15:35:29.883529 [debug] [ThreadPool]: On list_get_dbt: Close
15:35:29.886452 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
15:35:29.900865 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:35:29.901161 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
15:35:29.901368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:35:29.921793 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
15:35:29.922176 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:35:29.922395 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
15:35:29.929227 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
15:35:29.932544 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
15:35:29.937369 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
15:35:29.946193 [debug] [MainThread]: Using postgres connection "master"
15:35:29.946438 [debug] [MainThread]: On master: BEGIN
15:35:29.946589 [debug] [MainThread]: Opening a new connection, currently in state init
15:35:29.956947 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:35:29.957189 [debug] [MainThread]: Using postgres connection "master"
15:35:29.957342 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:35:30.008821 [debug] [MainThread]: SQL status: SELECT 2 in 0.05 seconds
15:35:30.010547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a254568-17f3-42e0-af4d-eaf7793ea2ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb69f29250>]}
15:35:30.010894 [debug] [MainThread]: On master: ROLLBACK
15:35:30.011228 [debug] [MainThread]: Using postgres connection "master"
15:35:30.011409 [debug] [MainThread]: On master: BEGIN
15:35:30.011795 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:35:30.011958 [debug] [MainThread]: On master: COMMIT
15:35:30.012101 [debug] [MainThread]: Using postgres connection "master"
15:35:30.012231 [debug] [MainThread]: On master: COMMIT
15:35:30.012476 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:35:30.012655 [debug] [MainThread]: On master: Close
15:35:30.013024 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:35:30.013502 [info ] [MainThread]: 
15:35:30.018634 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
15:35:30.018969 [info ] [Thread-1  ]: 1 of 5 START table model wetube.account_information ............................ [RUN]
15:35:30.019515 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
15:35:30.019682 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
15:35:30.019841 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
15:35:30.025151 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
15:35:30.028993 [debug] [Thread-1  ]: finished collecting timing info
15:35:30.029328 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
15:35:30.071021 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
15:35:30.071688 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:35:30.071848 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
15:35:30.071983 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:35:30.082012 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:35:30.082243 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:35:30.082389 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (
    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (
    select * from
        "get_dbt"."wetube"."city"
),

source_state as (
    select * from
        "get_dbt"."wetube"."state"
),

source_user_address as (
    select * from
        "get_dbt"."wetube"."user_address"
),

source_account as (
    select * from
        "get_dbt"."wetube"."account"
),

account_info as (
    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name as city_name,
        state.name as state_name,
        channel.id_channel,
        channel.name as channel,
        channel.creation_date as channel_creation
    FROM source_account account
    	inner join source_channel channel on (channel.id_account = account.id_user)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
15:35:30.098315 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.02 seconds
15:35:30.105690 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:35:30.105918 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information" rename to "account_information__dbt_backup"
15:35:30.106568 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:35:30.109233 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:35:30.109429 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information__dbt_tmp" rename to "account_information"
15:35:30.110031 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:35:30.124729 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:35:30.124959 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:35:30.125110 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:35:30.126316 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:35:30.132133 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:35:30.132347 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
drop table if exists "get_dbt"."wetube"."account_information__dbt_backup" cascade
15:35:30.143498 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
15:35:30.145756 [debug] [Thread-1  ]: finished collecting timing info
15:35:30.146094 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
15:35:30.146706 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a254568-17f3-42e0-af4d-eaf7793ea2ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb6975f3d0>]}
15:35:30.147249 [info ] [Thread-1  ]: 1 of 5 OK created table model wetube.account_information ....................... [[32mSELECT 5[0m in 0.13s]
15:35:30.147933 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
15:35:30.148251 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
15:35:30.148930 [info ] [Thread-1  ]: 2 of 5 START table model wetube.my_first_dbt_model ............................. [RUN]
15:35:30.149690 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
15:35:30.149865 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
15:35:30.150022 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
15:35:30.154177 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
15:35:30.155243 [debug] [Thread-1  ]: finished collecting timing info
15:35:30.155580 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
15:35:30.161647 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
15:35:30.162442 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:35:30.162615 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
15:35:30.162764 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:35:30.176696 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:35:30.176986 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:35:30.177325 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:35:30.181527 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
15:35:30.185153 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:35:30.185606 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:35:30.186570 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:35:30.192193 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:35:30.192430 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:35:30.193227 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:35:30.195058 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:35:30.195266 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:35:30.195436 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:35:30.196582 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:35:30.199473 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:35:30.199726 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
15:35:30.202583 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:35:30.204463 [debug] [Thread-1  ]: finished collecting timing info
15:35:30.204733 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
15:35:30.205190 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a254568-17f3-42e0-af4d-eaf7793ea2ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb69f1a580>]}
15:35:30.205574 [info ] [Thread-1  ]: 2 of 5 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.06s]
15:35:30.205994 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
15:35:30.206268 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
15:35:30.206779 [info ] [Thread-1  ]: 3 of 5 START table model wetube.number_of_subs_by_channel ...................... [RUN]
15:35:30.207235 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:35:30.207474 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
15:35:30.207632 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
15:35:30.210857 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:35:30.211389 [debug] [Thread-1  ]: finished collecting timing info
15:35:30.211565 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
15:35:30.214805 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:35:30.215548 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:35:30.215718 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
15:35:30.215858 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:35:30.227455 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:35:30.227824 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:35:30.228023 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
15:35:30.233327 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.01 seconds
15:35:30.236904 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:35:30.237146 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
15:35:30.237704 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:35:30.240889 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:35:30.241149 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
15:35:30.241787 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:35:30.243776 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:35:30.243951 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:35:30.244094 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:35:30.244750 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:35:30.246526 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:35:30.246704 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
15:35:30.248429 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:35:30.249860 [debug] [Thread-1  ]: finished collecting timing info
15:35:30.250126 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
15:35:30.250570 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a254568-17f3-42e0-af4d-eaf7793ea2ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb6a3c7250>]}
15:35:30.250959 [info ] [Thread-1  ]: 3 of 5 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.04s]
15:35:30.251397 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
15:35:30.251604 [debug] [Thread-1  ]: Began running node model.dbt_blog.total_likes_by_video
15:35:30.251840 [info ] [Thread-1  ]: 4 of 5 START table model wetube.total_likes_by_video ........................... [RUN]
15:35:30.252277 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.total_likes_by_video"
15:35:30.252442 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.total_likes_by_video
15:35:30.252599 [debug] [Thread-1  ]: Compiling model.dbt_blog.total_likes_by_video
15:35:30.256193 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.total_likes_by_video"
15:35:30.257199 [debug] [Thread-1  ]: finished collecting timing info
15:35:30.257390 [debug] [Thread-1  ]: Began executing node model.dbt_blog.total_likes_by_video
15:35:30.260908 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.total_likes_by_video"
15:35:30.261475 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:35:30.261641 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: BEGIN
15:35:30.261783 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:35:30.275291 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:35:30.275766 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:35:30.276034 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */


  create  table "get_dbt"."wetube"."total_likes_by_video__dbt_tmp"
  as (
    with source_video as (

    select * from
        "get_dbt"."wetube"."video"

),


source_video_like as (

    select * from
        "get_dbt"."wetube"."video_like"

),

source_account_info as (

    select * from
        "get_dbt"."wetube"."account_information"
),

source_total_like_by_video as (

    select source_account_info.id_channel, source_account_info.channel,
        source_video.id_video, source_video.title, count(*) as total_likes
    FROM source_video_like
        inner join source_video using (id_video)
        inner join source_account_info using (id_channel)
    GROUP BY source_account_info.id_channel,
             source_account_info.channel,
             source_video.id_video,
             source_video.title
    ORDER BY source_account_info.id_channel, total_likes DESC
)

select * from source_total_like_by_video
  );
15:35:30.283633 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.01 seconds
15:35:30.286904 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:35:30.287103 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */
alter table "get_dbt"."wetube"."total_likes_by_video" rename to "total_likes_by_video__dbt_backup"
15:35:30.287881 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:35:30.291225 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:35:30.291469 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */
alter table "get_dbt"."wetube"."total_likes_by_video__dbt_tmp" rename to "total_likes_by_video"
15:35:30.292179 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:35:30.294063 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: COMMIT
15:35:30.294244 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:35:30.294392 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: COMMIT
15:35:30.295009 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:35:30.296928 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:35:30.297096 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */
drop table if exists "get_dbt"."wetube"."total_likes_by_video__dbt_backup" cascade
15:35:30.299030 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:35:30.300328 [debug] [Thread-1  ]: finished collecting timing info
15:35:30.300525 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: Close
15:35:30.300954 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a254568-17f3-42e0-af4d-eaf7793ea2ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb6a3cc7f0>]}
15:35:30.301331 [info ] [Thread-1  ]: 4 of 5 OK created table model wetube.total_likes_by_video ...................... [[32mSELECT 12[0m in 0.05s]
15:35:30.301783 [debug] [Thread-1  ]: Finished running node model.dbt_blog.total_likes_by_video
15:35:30.302013 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
15:35:30.302349 [info ] [Thread-1  ]: 5 of 5 START view model wetube.my_second_dbt_model ............................. [RUN]
15:35:30.302828 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
15:35:30.302997 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
15:35:30.303166 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
15:35:30.306813 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
15:35:30.307437 [debug] [Thread-1  ]: finished collecting timing info
15:35:30.307624 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
15:35:30.339868 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
15:35:30.340744 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:35:30.341100 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
15:35:30.341342 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:35:30.358992 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
15:35:30.359338 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:35:30.359527 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
15:35:30.365415 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
15:35:30.369845 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:35:30.370242 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:35:30.371351 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:35:30.373607 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:35:30.373886 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:35:30.374104 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:35:30.379721 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
15:35:30.381792 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:35:30.381975 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
15:35:30.382375 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:35:30.383758 [debug] [Thread-1  ]: finished collecting timing info
15:35:30.383987 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
15:35:30.384436 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a254568-17f3-42e0-af4d-eaf7793ea2ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb6a454fa0>]}
15:35:30.384839 [info ] [Thread-1  ]: 5 of 5 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.08s]
15:35:30.385347 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
15:35:30.386860 [debug] [MainThread]: Acquiring new postgres connection "master"
15:35:30.387096 [debug] [MainThread]: Using postgres connection "master"
15:35:30.387252 [debug] [MainThread]: On master: BEGIN
15:35:30.387469 [debug] [MainThread]: Opening a new connection, currently in state closed
15:35:30.402222 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:35:30.402812 [debug] [MainThread]: On master: COMMIT
15:35:30.403030 [debug] [MainThread]: Using postgres connection "master"
15:35:30.403219 [debug] [MainThread]: On master: COMMIT
15:35:30.403661 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:35:30.404079 [debug] [MainThread]: On master: Close
15:35:30.405071 [info ] [MainThread]: 
15:35:30.405600 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0.64s.
15:35:30.405883 [debug] [MainThread]: Connection 'master' was properly closed.
15:35:30.406021 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
15:35:30.417082 [info ] [MainThread]: 
15:35:30.417607 [info ] [MainThread]: [32mCompleted successfully[0m
15:35:30.418090 [info ] [MainThread]: 
15:35:30.418346 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
15:35:30.418710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb6a135bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb6a3e8c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb6a328550>]}


============================== 2022-07-24 15:38:10.397525 | eb33d756-7ab5-499a-a57c-f99a39126c14 ==============================
15:38:10.397563 [info ] [MainThread]: Running with dbt=1.1.1
15:38:10.398545 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:38:10.398727 [debug] [MainThread]: Tracking: tracking
15:38:10.422347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90966e9ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90966e9700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9096832190>]}
15:38:10.494041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:38:10.494641 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/total_likes_by_video.sql
15:38:10.512955 [debug] [MainThread]: 1699: static parser successfully parsed mart/total_likes_by_video.sql
15:38:10.609686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb33d756-7ab5-499a-a57c-f99a39126c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90965d16d0>]}
15:38:10.619478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb33d756-7ab5-499a-a57c-f99a39126c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90968fd280>]}
15:38:10.619830 [info ] [MainThread]: Found 5 models, 21 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
15:38:10.620130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb33d756-7ab5-499a-a57c-f99a39126c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90965be640>]}
15:38:10.622375 [info ] [MainThread]: 
15:38:10.622869 [debug] [MainThread]: Acquiring new postgres connection "master"
15:38:10.623884 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
15:38:10.635558 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
15:38:10.635727 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
15:38:10.635863 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:38:10.679061 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.04 seconds
15:38:10.680658 [debug] [ThreadPool]: On list_get_dbt: Close
15:38:10.682102 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
15:38:10.689485 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:38:10.689673 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
15:38:10.689814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:38:10.699054 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:38:10.699250 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:38:10.699406 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
15:38:10.703285 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
15:38:10.704963 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
15:38:10.705239 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
15:38:10.710370 [debug] [MainThread]: Using postgres connection "master"
15:38:10.710539 [debug] [MainThread]: On master: BEGIN
15:38:10.710673 [debug] [MainThread]: Opening a new connection, currently in state init
15:38:10.720211 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:38:10.720422 [debug] [MainThread]: Using postgres connection "master"
15:38:10.720566 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:38:10.764397 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
15:38:10.765720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb33d756-7ab5-499a-a57c-f99a39126c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90966e93a0>]}
15:38:10.765996 [debug] [MainThread]: On master: ROLLBACK
15:38:10.766267 [debug] [MainThread]: Using postgres connection "master"
15:38:10.766423 [debug] [MainThread]: On master: BEGIN
15:38:10.766790 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:38:10.766943 [debug] [MainThread]: On master: COMMIT
15:38:10.767073 [debug] [MainThread]: Using postgres connection "master"
15:38:10.767191 [debug] [MainThread]: On master: COMMIT
15:38:10.767483 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:38:10.767644 [debug] [MainThread]: On master: Close
15:38:10.767983 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:38:10.768208 [info ] [MainThread]: 
15:38:10.772237 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
15:38:10.772609 [info ] [Thread-1  ]: 1 of 5 START table model wetube.account_information ............................ [RUN]
15:38:10.773103 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
15:38:10.773257 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
15:38:10.773399 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
15:38:10.777526 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
15:38:10.778360 [debug] [Thread-1  ]: finished collecting timing info
15:38:10.778533 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
15:38:10.815529 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
15:38:10.816146 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:38:10.816371 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
15:38:10.816514 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:38:10.828051 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:38:10.828288 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:38:10.828434 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (
    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (
    select * from
        "get_dbt"."wetube"."city"
),

source_state as (
    select * from
        "get_dbt"."wetube"."state"
),

source_user_address as (
    select * from
        "get_dbt"."wetube"."user_address"
),

source_account as (
    select * from
        "get_dbt"."wetube"."account"
),

account_info as (
    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name as city_name,
        state.name as state_name,
        channel.id_channel,
        channel.name as channel,
        channel.creation_date as channel_creation
    FROM source_account account
    	inner join source_channel channel on (channel.id_account = account.id_user)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
15:38:10.979861 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.15 seconds
15:38:10.988463 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:38:10.988777 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information" rename to "account_information__dbt_backup"
15:38:10.989511 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:38:10.992630 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:38:10.992913 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information__dbt_tmp" rename to "account_information"
15:38:10.993950 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:38:11.012269 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:38:11.012512 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:38:11.012761 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:38:11.020867 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
15:38:11.027906 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:38:11.028122 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
drop table if exists "get_dbt"."wetube"."account_information__dbt_backup" cascade
15:38:11.031728 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:38:11.033092 [debug] [Thread-1  ]: finished collecting timing info
15:38:11.033333 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
15:38:11.034051 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb33d756-7ab5-499a-a57c-f99a39126c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9096c0cdc0>]}
15:38:11.034711 [info ] [Thread-1  ]: 1 of 5 OK created table model wetube.account_information ....................... [[32mSELECT 5[0m in 0.26s]
15:38:11.035463 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
15:38:11.035924 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
15:38:11.036471 [info ] [Thread-1  ]: 2 of 5 START table model wetube.my_first_dbt_model ............................. [RUN]
15:38:11.037829 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
15:38:11.038065 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
15:38:11.038223 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
15:38:11.041935 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
15:38:11.043763 [debug] [Thread-1  ]: finished collecting timing info
15:38:11.044177 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
15:38:11.050034 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
15:38:11.050914 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:38:11.051170 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
15:38:11.051390 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:38:11.079280 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
15:38:11.079573 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:38:11.079743 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:38:11.084686 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
15:38:11.089268 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:38:11.089583 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:38:11.092010 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:38:11.098316 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:38:11.098534 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:38:11.099246 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:38:11.100953 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:38:11.101117 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:38:11.101254 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:38:11.113129 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
15:38:11.115254 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:38:11.115427 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
15:38:11.118319 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:38:11.119838 [debug] [Thread-1  ]: finished collecting timing info
15:38:11.120080 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
15:38:11.120562 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb33d756-7ab5-499a-a57c-f99a39126c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9096cb7dc0>]}
15:38:11.120971 [info ] [Thread-1  ]: 2 of 5 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.08s]
15:38:11.121443 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
15:38:11.121668 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
15:38:11.122160 [info ] [Thread-1  ]: 3 of 5 START table model wetube.number_of_subs_by_channel ...................... [RUN]
15:38:11.122856 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:38:11.123065 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
15:38:11.123233 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
15:38:11.126509 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:38:11.127004 [debug] [Thread-1  ]: finished collecting timing info
15:38:11.127178 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
15:38:11.130311 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:38:11.130839 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:38:11.130997 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
15:38:11.131131 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:38:11.140250 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:38:11.140466 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:38:11.140717 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
15:38:11.154673 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.01 seconds
15:38:11.157705 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:38:11.157909 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
15:38:11.158914 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:38:11.163651 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:38:11.163949 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
15:38:11.165279 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:38:11.168581 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:38:11.168803 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:38:11.168949 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:38:11.169562 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:38:11.171302 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:38:11.171481 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
15:38:11.173892 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:38:11.175343 [debug] [Thread-1  ]: finished collecting timing info
15:38:11.175535 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
15:38:11.175968 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb33d756-7ab5-499a-a57c-f99a39126c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9096948f40>]}
15:38:11.176347 [info ] [Thread-1  ]: 3 of 5 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.05s]
15:38:11.176777 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
15:38:11.176978 [debug] [Thread-1  ]: Began running node model.dbt_blog.total_likes_by_video
15:38:11.177210 [info ] [Thread-1  ]: 4 of 5 START table model wetube.total_likes_by_video ........................... [RUN]
15:38:11.177642 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.total_likes_by_video"
15:38:11.177936 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.total_likes_by_video
15:38:11.178195 [debug] [Thread-1  ]: Compiling model.dbt_blog.total_likes_by_video
15:38:11.181689 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.total_likes_by_video"
15:38:11.182250 [debug] [Thread-1  ]: finished collecting timing info
15:38:11.182434 [debug] [Thread-1  ]: Began executing node model.dbt_blog.total_likes_by_video
15:38:11.187428 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.total_likes_by_video"
15:38:11.188238 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:38:11.188408 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: BEGIN
15:38:11.188611 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:38:11.204334 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
15:38:11.204794 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:38:11.205130 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */


  create  table "get_dbt"."wetube"."total_likes_by_video__dbt_tmp"
  as (
    with source_video as (

    select * from
        "get_dbt"."wetube"."video"

),


source_video_like as (

    select * from
        "get_dbt"."wetube"."video_like"

),

source_account_info as (

    select * from
        "get_dbt"."wetube"."account_information"
),

source_total_like_by_video as (

    select source_account_info.id_channel, source_account_info.channel,
        source_video.id_video, source_video.title, count(*) as total_likes
    FROM source_video_like
        inner join source_video using (id_video)
        inner join source_account_info using (id_channel)
    GROUP BY source_account_info.id_channel,
             source_account_info.channel,
             source_video.id_video,
             source_video.title
    ORDER BY source_account_info.id_channel, total_likes, source_video.id_video  DESC
)

select * from source_total_like_by_video
  );
15:38:11.240052 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.03 seconds
15:38:11.244292 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:38:11.244508 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */
alter table "get_dbt"."wetube"."total_likes_by_video" rename to "total_likes_by_video__dbt_backup"
15:38:11.245421 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:38:11.249152 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:38:11.249360 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */
alter table "get_dbt"."wetube"."total_likes_by_video__dbt_tmp" rename to "total_likes_by_video"
15:38:11.249971 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:38:11.251715 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: COMMIT
15:38:11.251877 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:38:11.252015 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: COMMIT
15:38:11.266823 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
15:38:11.287061 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:38:11.287241 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */
drop table if exists "get_dbt"."wetube"."total_likes_by_video__dbt_backup" cascade
15:38:11.313210 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
15:38:11.314302 [debug] [Thread-1  ]: finished collecting timing info
15:38:11.314455 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: Close
15:38:11.314789 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb33d756-7ab5-499a-a57c-f99a39126c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9096c82610>]}
15:38:11.315081 [info ] [Thread-1  ]: 4 of 5 OK created table model wetube.total_likes_by_video ...................... [[32mSELECT 12[0m in 0.14s]
15:38:11.315419 [debug] [Thread-1  ]: Finished running node model.dbt_blog.total_likes_by_video
15:38:11.315568 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
15:38:11.315739 [info ] [Thread-1  ]: 5 of 5 START view model wetube.my_second_dbt_model ............................. [RUN]
15:38:11.316173 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
15:38:11.316301 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
15:38:11.316416 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
15:38:11.319072 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
15:38:11.319676 [debug] [Thread-1  ]: finished collecting timing info
15:38:11.319868 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
15:38:11.342506 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
15:38:11.343591 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:38:11.343956 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
15:38:11.344099 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:38:11.353443 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:38:11.353848 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:38:11.353997 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
15:38:11.358549 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:38:11.361302 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:38:11.361488 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:38:11.362024 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:38:11.363446 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:38:11.363616 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:38:11.363763 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:38:11.364410 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:38:11.366586 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:38:11.366772 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
15:38:11.367197 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:38:11.368634 [debug] [Thread-1  ]: finished collecting timing info
15:38:11.368829 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
15:38:11.369242 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb33d756-7ab5-499a-a57c-f99a39126c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9096d12fa0>]}
15:38:11.369613 [info ] [Thread-1  ]: 5 of 5 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
15:38:11.370052 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
15:38:11.371156 [debug] [MainThread]: Acquiring new postgres connection "master"
15:38:11.371359 [debug] [MainThread]: Using postgres connection "master"
15:38:11.371503 [debug] [MainThread]: On master: BEGIN
15:38:11.371633 [debug] [MainThread]: Opening a new connection, currently in state closed
15:38:11.381480 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:38:11.381719 [debug] [MainThread]: On master: COMMIT
15:38:11.381867 [debug] [MainThread]: Using postgres connection "master"
15:38:11.382000 [debug] [MainThread]: On master: COMMIT
15:38:11.382235 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:38:11.382394 [debug] [MainThread]: On master: Close
15:38:11.382812 [info ] [MainThread]: 
15:38:11.383076 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0.76s.
15:38:11.383319 [debug] [MainThread]: Connection 'master' was properly closed.
15:38:11.383446 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
15:38:11.390349 [info ] [MainThread]: 
15:38:11.390638 [info ] [MainThread]: [32mCompleted successfully[0m
15:38:11.390927 [info ] [MainThread]: 
15:38:11.391164 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
15:38:11.391483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90969601c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90969560d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90966db8e0>]}


============================== 2022-07-24 15:39:43.974159 | 18894ff7-213c-4972-baf8-7c08f555faa0 ==============================
15:39:43.974204 [info ] [MainThread]: Running with dbt=1.1.1
15:39:43.975364 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:39:43.975602 [debug] [MainThread]: Tracking: tracking
15:39:43.996404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada862aa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada862a2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada86344f0>]}
15:39:44.073766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:39:44.074382 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/total_likes_by_video.sql
15:39:44.091171 [debug] [MainThread]: 1699: static parser successfully parsed mart/total_likes_by_video.sql
15:39:44.187079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18894ff7-213c-4972-baf8-7c08f555faa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada850ffd0>]}
15:39:44.196620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18894ff7-213c-4972-baf8-7c08f555faa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada883e310>]}
15:39:44.196992 [info ] [MainThread]: Found 5 models, 21 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
15:39:44.197276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18894ff7-213c-4972-baf8-7c08f555faa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada84fd6d0>]}
15:39:44.199421 [info ] [MainThread]: 
15:39:44.199897 [debug] [MainThread]: Acquiring new postgres connection "master"
15:39:44.200885 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
15:39:44.212085 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
15:39:44.212251 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
15:39:44.212382 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:39:44.290627 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.08 seconds
15:39:44.292230 [debug] [ThreadPool]: On list_get_dbt: Close
15:39:44.293678 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
15:39:44.301364 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:39:44.301587 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
15:39:44.301745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:39:44.325904 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
15:39:44.326138 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:39:44.326290 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
15:39:44.329799 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
15:39:44.331539 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
15:39:44.331859 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
15:39:44.337155 [debug] [MainThread]: Using postgres connection "master"
15:39:44.337366 [debug] [MainThread]: On master: BEGIN
15:39:44.337520 [debug] [MainThread]: Opening a new connection, currently in state init
15:39:44.346933 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:39:44.347159 [debug] [MainThread]: Using postgres connection "master"
15:39:44.347309 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:39:44.389464 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
15:39:44.390755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18894ff7-213c-4972-baf8-7c08f555faa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada862a070>]}
15:39:44.391039 [debug] [MainThread]: On master: ROLLBACK
15:39:44.391303 [debug] [MainThread]: Using postgres connection "master"
15:39:44.391452 [debug] [MainThread]: On master: BEGIN
15:39:44.391760 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:39:44.391917 [debug] [MainThread]: On master: COMMIT
15:39:44.392052 [debug] [MainThread]: Using postgres connection "master"
15:39:44.392172 [debug] [MainThread]: On master: COMMIT
15:39:44.392406 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:39:44.392570 [debug] [MainThread]: On master: Close
15:39:44.392887 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:39:44.393121 [info ] [MainThread]: 
15:39:44.397562 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
15:39:44.397867 [info ] [Thread-1  ]: 1 of 5 START table model wetube.account_information ............................ [RUN]
15:39:44.398302 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
15:39:44.398447 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
15:39:44.398586 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
15:39:44.402604 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
15:39:44.403101 [debug] [Thread-1  ]: finished collecting timing info
15:39:44.403265 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
15:39:44.441718 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
15:39:44.442503 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:39:44.442679 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
15:39:44.442819 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:39:44.451949 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:39:44.452144 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:39:44.452292 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (
    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (
    select * from
        "get_dbt"."wetube"."city"
),

source_state as (
    select * from
        "get_dbt"."wetube"."state"
),

source_user_address as (
    select * from
        "get_dbt"."wetube"."user_address"
),

source_account as (
    select * from
        "get_dbt"."wetube"."account"
),

account_info as (
    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name as city_name,
        state.name as state_name,
        channel.id_channel,
        channel.name as channel,
        channel.creation_date as channel_creation
    FROM source_account account
    	inner join source_channel channel on (channel.id_account = account.id_user)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
15:39:44.458618 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
15:39:44.465837 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:39:44.466022 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information" rename to "account_information__dbt_backup"
15:39:44.466712 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:39:44.469120 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:39:44.469289 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information__dbt_tmp" rename to "account_information"
15:39:44.469813 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:39:44.483691 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:39:44.483909 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:39:44.484060 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:39:44.484719 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:39:44.490040 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:39:44.490205 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
drop table if exists "get_dbt"."wetube"."account_information__dbt_backup" cascade
15:39:44.494306 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:39:44.495828 [debug] [Thread-1  ]: finished collecting timing info
15:39:44.496044 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
15:39:44.496483 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18894ff7-213c-4972-baf8-7c08f555faa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada8a4bdc0>]}
15:39:44.496856 [info ] [Thread-1  ]: 1 of 5 OK created table model wetube.account_information ....................... [[32mSELECT 5[0m in 0.10s]
15:39:44.497312 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
15:39:44.497515 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
15:39:44.497741 [info ] [Thread-1  ]: 2 of 5 START table model wetube.my_first_dbt_model ............................. [RUN]
15:39:44.498166 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
15:39:44.498327 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
15:39:44.498477 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
15:39:44.501126 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
15:39:44.501768 [debug] [Thread-1  ]: finished collecting timing info
15:39:44.501967 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
15:39:44.505294 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
15:39:44.506032 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:39:44.506412 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
15:39:44.506699 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:39:44.563969 [debug] [Thread-1  ]: SQL status: BEGIN in 0.06 seconds
15:39:44.564193 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:39:44.564340 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:39:44.567539 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
15:39:44.570323 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:39:44.570504 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:39:44.572220 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:39:44.574404 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:39:44.574564 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:39:44.575097 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:39:44.576787 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:39:44.576965 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:39:44.577109 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:39:44.577880 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:39:44.579632 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:39:44.579791 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
15:39:44.582362 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:39:44.583825 [debug] [Thread-1  ]: finished collecting timing info
15:39:44.584036 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
15:39:44.584487 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18894ff7-213c-4972-baf8-7c08f555faa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada8af7e50>]}
15:39:44.584877 [info ] [Thread-1  ]: 2 of 5 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.09s]
15:39:44.585446 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
15:39:44.585662 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
15:39:44.586218 [info ] [Thread-1  ]: 3 of 5 START table model wetube.number_of_subs_by_channel ...................... [RUN]
15:39:44.586716 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:39:44.586882 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
15:39:44.587032 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
15:39:44.590242 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:39:44.590729 [debug] [Thread-1  ]: finished collecting timing info
15:39:44.590901 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
15:39:44.594032 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:39:44.594554 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:39:44.594715 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
15:39:44.594853 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:39:44.619001 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
15:39:44.619284 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:39:44.619465 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
15:39:44.666060 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.05 seconds
15:39:44.669243 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:39:44.669440 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
15:39:44.670023 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:39:44.672554 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:39:44.672753 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
15:39:44.673328 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:39:44.675238 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:39:44.675415 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:39:44.675562 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:39:44.684772 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
15:39:44.686569 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:39:44.686752 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
15:39:44.688536 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:39:44.689963 [debug] [Thread-1  ]: finished collecting timing info
15:39:44.690159 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
15:39:44.690720 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18894ff7-213c-4972-baf8-7c08f555faa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada8a645e0>]}
15:39:44.691180 [info ] [Thread-1  ]: 3 of 5 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.10s]
15:39:44.691627 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
15:39:44.691840 [debug] [Thread-1  ]: Began running node model.dbt_blog.total_likes_by_video
15:39:44.692198 [info ] [Thread-1  ]: 4 of 5 START table model wetube.total_likes_by_video ........................... [RUN]
15:39:44.692785 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.total_likes_by_video"
15:39:44.692973 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.total_likes_by_video
15:39:44.693131 [debug] [Thread-1  ]: Compiling model.dbt_blog.total_likes_by_video
15:39:44.696613 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.total_likes_by_video"
15:39:44.697125 [debug] [Thread-1  ]: finished collecting timing info
15:39:44.697303 [debug] [Thread-1  ]: Began executing node model.dbt_blog.total_likes_by_video
15:39:44.700564 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.total_likes_by_video"
15:39:44.701098 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:39:44.701257 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: BEGIN
15:39:44.701394 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:39:44.711255 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:39:44.711512 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:39:44.711673 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */


  create  table "get_dbt"."wetube"."total_likes_by_video__dbt_tmp"
  as (
    with source_video as (

    select * from
        "get_dbt"."wetube"."video"

),


source_video_like as (

    select * from
        "get_dbt"."wetube"."video_like"

),

source_account_info as (

    select * from
        "get_dbt"."wetube"."account_information"
),

source_total_like_by_video as (

    select source_account_info.id_channel, source_account_info.channel,
        source_video.id_video, source_video.title, count(*) as total_likes
    FROM source_video_like
        inner join source_video using (id_video)
        inner join source_account_info using (id_channel)
    GROUP BY source_account_info.id_channel,
             source_account_info.channel,
             source_video.id_video,
             source_video.title
    ORDER BY source_account_info.id_channel, source_video.id_video, total_likes,   DESC
)

select * from source_total_like_by_video
  );
15:39:44.723647 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "DESC"
LINE 38: ..._info.id_channel, source_video.id_video, total_likes,   DESC
                                                                    ^

15:39:44.724182 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: ROLLBACK
15:39:44.725079 [debug] [Thread-1  ]: finished collecting timing info
15:39:44.725712 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: Close
15:39:44.726522 [debug] [Thread-1  ]: Database Error in model total_likes_by_video (models/mart/total_likes_by_video.sql)
  syntax error at or near "DESC"
  LINE 38: ..._info.id_channel, source_video.id_video, total_likes,   DESC
                                                                      ^
  compiled SQL at target/run/dbt_blog/models/mart/total_likes_by_video.sql
15:39:44.726930 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18894ff7-213c-4972-baf8-7c08f555faa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada8c18e80>]}
15:39:44.727420 [error] [Thread-1  ]: 4 of 5 ERROR creating table model wetube.total_likes_by_video .................. [[31mERROR[0m in 0.03s]
15:39:44.727910 [debug] [Thread-1  ]: Finished running node model.dbt_blog.total_likes_by_video
15:39:44.728120 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
15:39:44.728511 [info ] [Thread-1  ]: 5 of 5 START view model wetube.my_second_dbt_model ............................. [RUN]
15:39:44.729705 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
15:39:44.729972 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
15:39:44.730155 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
15:39:44.733049 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
15:39:44.733692 [debug] [Thread-1  ]: finished collecting timing info
15:39:44.733878 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
15:39:44.766392 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
15:39:44.767761 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:39:44.768023 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
15:39:44.768272 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:39:44.804340 [debug] [Thread-1  ]: SQL status: BEGIN in 0.04 seconds
15:39:44.804893 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:39:44.805193 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
15:39:44.814233 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
15:39:44.816928 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:39:44.817100 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:39:44.817612 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:39:44.819767 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:39:44.820136 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:39:44.820432 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:39:44.841749 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
15:39:44.845349 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:39:44.845689 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
15:39:44.846136 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:39:44.847616 [debug] [Thread-1  ]: finished collecting timing info
15:39:44.847875 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
15:39:44.848338 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18894ff7-213c-4972-baf8-7c08f555faa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada86241f0>]}
15:39:44.848730 [info ] [Thread-1  ]: 5 of 5 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.12s]
15:39:44.849184 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
15:39:44.850695 [debug] [MainThread]: Acquiring new postgres connection "master"
15:39:44.851002 [debug] [MainThread]: Using postgres connection "master"
15:39:44.851174 [debug] [MainThread]: On master: BEGIN
15:39:44.851328 [debug] [MainThread]: Opening a new connection, currently in state closed
15:39:44.866839 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
15:39:44.867395 [debug] [MainThread]: On master: COMMIT
15:39:44.867648 [debug] [MainThread]: Using postgres connection "master"
15:39:44.867859 [debug] [MainThread]: On master: COMMIT
15:39:44.868482 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:39:44.868954 [debug] [MainThread]: On master: Close
15:39:44.869985 [info ] [MainThread]: 
15:39:44.870854 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0.67s.
15:39:44.871438 [debug] [MainThread]: Connection 'master' was properly closed.
15:39:44.871764 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
15:39:44.888016 [info ] [MainThread]: 
15:39:44.888341 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:39:44.888624 [info ] [MainThread]: 
15:39:44.888862 [error] [MainThread]: [33mDatabase Error in model total_likes_by_video (models/mart/total_likes_by_video.sql)[0m
15:39:44.889094 [error] [MainThread]:   syntax error at or near "DESC"
15:39:44.889311 [error] [MainThread]:   LINE 38: ..._info.id_channel, source_video.id_video, total_likes,   DESC
15:39:44.889665 [error] [MainThread]:                                                                       ^
15:39:44.890028 [error] [MainThread]:   compiled SQL at target/run/dbt_blog/models/mart/total_likes_by_video.sql
15:39:44.890419 [info ] [MainThread]: 
15:39:44.890708 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
15:39:44.891062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada8aee340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada8c65fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada8c2a340>]}


============================== 2022-07-24 15:40:59.920256 | d4934ea3-833c-42a9-bea0-4335fb7ec8d5 ==============================
15:40:59.920284 [info ] [MainThread]: Running with dbt=1.1.1
15:40:59.921196 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:40:59.921415 [debug] [MainThread]: Tracking: tracking
15:40:59.948797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d7dd7ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d7dd7700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d7f30190>]}
15:41:00.015998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:41:00.016644 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/total_likes_by_video.sql
15:41:00.035133 [debug] [MainThread]: 1699: static parser successfully parsed mart/total_likes_by_video.sql
15:41:00.134173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4934ea3-833c-42a9-bea0-4335fb7ec8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d7cbf6d0>]}
15:41:00.143717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4934ea3-833c-42a9-bea0-4335fb7ec8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d7ffd280>]}
15:41:00.144063 [info ] [MainThread]: Found 5 models, 21 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
15:41:00.144357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4934ea3-833c-42a9-bea0-4335fb7ec8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d7cac640>]}
15:41:00.146598 [info ] [MainThread]: 
15:41:00.147090 [debug] [MainThread]: Acquiring new postgres connection "master"
15:41:00.148105 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt"
15:41:00.160895 [debug] [ThreadPool]: Using postgres connection "list_get_dbt"
15:41:00.161210 [debug] [ThreadPool]: On list_get_dbt: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt"} */

    select distinct nspname from pg_namespace
  
15:41:00.161384 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:41:00.199440 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.04 seconds
15:41:00.201036 [debug] [ThreadPool]: On list_get_dbt: Close
15:41:00.202587 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
15:41:00.210012 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:41:00.210205 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
15:41:00.210350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:41:00.219925 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:41:00.220143 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
15:41:00.220297 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
15:41:00.224569 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
15:41:00.226233 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
15:41:00.226513 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
15:41:00.231732 [debug] [MainThread]: Using postgres connection "master"
15:41:00.231915 [debug] [MainThread]: On master: BEGIN
15:41:00.232053 [debug] [MainThread]: Opening a new connection, currently in state init
15:41:00.241549 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:41:00.241747 [debug] [MainThread]: Using postgres connection "master"
15:41:00.241885 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:41:00.284558 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
15:41:00.285898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4934ea3-833c-42a9-bea0-4335fb7ec8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d7f50fa0>]}
15:41:00.286168 [debug] [MainThread]: On master: ROLLBACK
15:41:00.286410 [debug] [MainThread]: Using postgres connection "master"
15:41:00.286537 [debug] [MainThread]: On master: BEGIN
15:41:00.286842 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:41:00.286993 [debug] [MainThread]: On master: COMMIT
15:41:00.287132 [debug] [MainThread]: Using postgres connection "master"
15:41:00.287248 [debug] [MainThread]: On master: COMMIT
15:41:00.287454 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:41:00.287593 [debug] [MainThread]: On master: Close
15:41:00.287897 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:41:00.288124 [info ] [MainThread]: 
15:41:00.292315 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
15:41:00.292678 [info ] [Thread-1  ]: 1 of 5 START table model wetube.account_information ............................ [RUN]
15:41:00.293131 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
15:41:00.293300 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
15:41:00.293442 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
15:41:00.297536 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
15:41:00.298481 [debug] [Thread-1  ]: finished collecting timing info
15:41:00.298657 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
15:41:00.335302 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.account_information"
15:41:00.335942 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:41:00.336100 [debug] [Thread-1  ]: On model.dbt_blog.account_information: BEGIN
15:41:00.336235 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:41:00.345624 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:41:00.345896 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:41:00.346058 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */


  create  table "get_dbt"."wetube"."account_information__dbt_tmp"
  as (
    with source_channel as (
    select * from
        "get_dbt"."wetube"."channel"
),

source_city as (
    select * from
        "get_dbt"."wetube"."city"
),

source_state as (
    select * from
        "get_dbt"."wetube"."state"
),

source_user_address as (
    select * from
        "get_dbt"."wetube"."user_address"
),

source_account as (
    select * from
        "get_dbt"."wetube"."account"
),

account_info as (
    select
        account.id_user as id_account,
        account.first_name,
        account.last_name,
        account.email,
        city.name as city_name,
        state.name as state_name,
        channel.id_channel,
        channel.name as channel,
        channel.creation_date as channel_creation
    FROM source_account account
    	inner join source_channel channel on (channel.id_account = account.id_user)
    	inner join source_user_address user_address using (id_user)
    	inner join source_state state using (id_state)
    	inner join source_city city using (id_city)
)

select * from account_info
  );
15:41:00.351873 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
15:41:00.359011 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:41:00.359179 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information" rename to "account_information__dbt_backup"
15:41:00.359694 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:41:00.362140 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:41:00.362309 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
alter table "get_dbt"."wetube"."account_information__dbt_tmp" rename to "account_information"
15:41:00.362826 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:41:00.375778 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:41:00.375961 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:41:00.376091 [debug] [Thread-1  ]: On model.dbt_blog.account_information: COMMIT
15:41:00.376731 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:41:00.381946 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.account_information"
15:41:00.382104 [debug] [Thread-1  ]: On model.dbt_blog.account_information: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.account_information"} */
drop table if exists "get_dbt"."wetube"."account_information__dbt_backup" cascade
15:41:00.384599 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:41:00.385798 [debug] [Thread-1  ]: finished collecting timing info
15:41:00.385971 [debug] [Thread-1  ]: On model.dbt_blog.account_information: Close
15:41:00.386358 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4934ea3-833c-42a9-bea0-4335fb7ec8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d820cd30>]}
15:41:00.386703 [info ] [Thread-1  ]: 1 of 5 OK created table model wetube.account_information ....................... [[32mSELECT 5[0m in 0.09s]
15:41:00.387123 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
15:41:00.387326 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
15:41:00.387545 [info ] [Thread-1  ]: 2 of 5 START table model wetube.my_first_dbt_model ............................. [RUN]
15:41:00.387952 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
15:41:00.388106 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
15:41:00.388248 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
15:41:00.390917 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
15:41:00.391450 [debug] [Thread-1  ]: finished collecting timing info
15:41:00.391620 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
15:41:00.395111 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_first_dbt_model"
15:41:00.395679 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:41:00.395941 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: BEGIN
15:41:00.396116 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:41:00.407153 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:41:00.407391 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:41:00.407540 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */


  create  table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:41:00.409996 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
15:41:00.413131 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:41:00.413433 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:41:00.414131 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:41:00.418080 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:41:00.418305 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
alter table "get_dbt"."wetube"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:41:00.419112 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:41:00.421324 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:41:00.421544 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:41:00.421689 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: COMMIT
15:41:00.422354 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:41:00.424214 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_first_dbt_model"
15:41:00.424371 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_first_dbt_model"} */
drop table if exists "get_dbt"."wetube"."my_first_dbt_model__dbt_backup" cascade
15:41:00.426469 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:41:00.427703 [debug] [Thread-1  ]: finished collecting timing info
15:41:00.427897 [debug] [Thread-1  ]: On model.dbt_blog.my_first_dbt_model: Close
15:41:00.428300 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4934ea3-833c-42a9-bea0-4335fb7ec8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d829e460>]}
15:41:00.428659 [info ] [Thread-1  ]: 2 of 5 OK created table model wetube.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.04s]
15:41:00.429068 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
15:41:00.429267 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
15:41:00.429493 [info ] [Thread-1  ]: 3 of 5 START table model wetube.number_of_subs_by_channel ...................... [RUN]
15:41:00.429917 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:41:00.430075 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
15:41:00.430222 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
15:41:00.433396 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:41:00.434045 [debug] [Thread-1  ]: finished collecting timing info
15:41:00.434228 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
15:41:00.437657 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.number_of_subs_by_channel"
15:41:00.438287 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:41:00.438457 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: BEGIN
15:41:00.438598 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:41:00.449516 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:41:00.449932 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:41:00.450131 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */


  create  table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp"
  as (
    with source_channel as (

    select * from
        "get_dbt"."wetube"."channel"
),

source_channel_subs as (

    select * from
        "get_dbt"."wetube"."channel_subs"

),

number_of_subs_by_channel as (

    select
        source_channel.id_channel,
        source_channel.name,
        count(source_channel_subs.id_subscriber) num_subs
    FROM source_channel_subs
    	inner join source_channel using (id_channel)
    GROUP BY 1, 2
)

select * from number_of_subs_by_channel
  );
15:41:00.454390 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
15:41:00.457651 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:41:00.458078 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel" rename to "number_of_subs_by_channel__dbt_backup"
15:41:00.458752 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:41:00.461281 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:41:00.461462 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
alter table "get_dbt"."wetube"."number_of_subs_by_channel__dbt_tmp" rename to "number_of_subs_by_channel"
15:41:00.462317 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:41:00.464925 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:41:00.465159 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:41:00.465303 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: COMMIT
15:41:00.465995 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:41:00.467735 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.number_of_subs_by_channel"
15:41:00.467899 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.number_of_subs_by_channel"} */
drop table if exists "get_dbt"."wetube"."number_of_subs_by_channel__dbt_backup" cascade
15:41:00.470917 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:41:00.472658 [debug] [Thread-1  ]: finished collecting timing info
15:41:00.472858 [debug] [Thread-1  ]: On model.dbt_blog.number_of_subs_by_channel: Close
15:41:00.473276 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4934ea3-833c-42a9-bea0-4335fb7ec8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d82239a0>]}
15:41:00.473638 [info ] [Thread-1  ]: 3 of 5 OK created table model wetube.number_of_subs_by_channel ................. [[32mSELECT 3[0m in 0.04s]
15:41:00.474362 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
15:41:00.474600 [debug] [Thread-1  ]: Began running node model.dbt_blog.total_likes_by_video
15:41:00.474858 [info ] [Thread-1  ]: 4 of 5 START table model wetube.total_likes_by_video ........................... [RUN]
15:41:00.475318 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.total_likes_by_video"
15:41:00.475485 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.total_likes_by_video
15:41:00.475637 [debug] [Thread-1  ]: Compiling model.dbt_blog.total_likes_by_video
15:41:00.479535 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.total_likes_by_video"
15:41:00.480377 [debug] [Thread-1  ]: finished collecting timing info
15:41:00.480571 [debug] [Thread-1  ]: Began executing node model.dbt_blog.total_likes_by_video
15:41:00.483993 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.total_likes_by_video"
15:41:00.484664 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:41:00.484841 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: BEGIN
15:41:00.484983 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:41:00.496051 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:41:00.496480 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:41:00.496681 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */


  create  table "get_dbt"."wetube"."total_likes_by_video__dbt_tmp"
  as (
    with source_video as (

    select * from
        "get_dbt"."wetube"."video"

),


source_video_like as (

    select * from
        "get_dbt"."wetube"."video_like"

),

source_account_info as (

    select * from
        "get_dbt"."wetube"."account_information"
),

source_total_like_by_video as (

    select source_account_info.id_channel, source_account_info.channel,
        source_video.id_video, source_video.title, count(*) as total_likes
    FROM source_video_like
        inner join source_video using (id_video)
        inner join source_account_info using (id_channel)
    GROUP BY source_account_info.id_channel,
             source_account_info.channel,
             source_video.id_video,
             source_video.title
    ORDER BY  total_likes DESC
)

select * from source_total_like_by_video
  );
15:41:00.503121 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.01 seconds
15:41:00.507281 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:41:00.507543 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */
alter table "get_dbt"."wetube"."total_likes_by_video" rename to "total_likes_by_video__dbt_backup"
15:41:00.508277 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:41:00.511144 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:41:00.511414 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */
alter table "get_dbt"."wetube"."total_likes_by_video__dbt_tmp" rename to "total_likes_by_video"
15:41:00.512038 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:41:00.513890 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: COMMIT
15:41:00.514197 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:41:00.514343 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: COMMIT
15:41:00.515073 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:41:00.517712 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.total_likes_by_video"
15:41:00.518097 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.total_likes_by_video"} */
drop table if exists "get_dbt"."wetube"."total_likes_by_video__dbt_backup" cascade
15:41:00.520477 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:41:00.522095 [debug] [Thread-1  ]: finished collecting timing info
15:41:00.522346 [debug] [Thread-1  ]: On model.dbt_blog.total_likes_by_video: Close
15:41:00.522974 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4934ea3-833c-42a9-bea0-4335fb7ec8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d82252b0>]}
15:41:00.523842 [info ] [Thread-1  ]: 4 of 5 OK created table model wetube.total_likes_by_video ...................... [[32mSELECT 12[0m in 0.05s]
15:41:00.525174 [debug] [Thread-1  ]: Finished running node model.dbt_blog.total_likes_by_video
15:41:00.525666 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
15:41:00.526228 [info ] [Thread-1  ]: 5 of 5 START view model wetube.my_second_dbt_model ............................. [RUN]
15:41:00.526906 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
15:41:00.527111 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
15:41:00.527992 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
15:41:00.534438 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
15:41:00.535907 [debug] [Thread-1  ]: finished collecting timing info
15:41:00.536423 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
15:41:00.576536 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_blog.my_second_dbt_model"
15:41:00.577316 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:41:00.577497 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: BEGIN
15:41:00.577641 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:41:00.591066 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:41:00.591467 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:41:00.591741 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */

  create view "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "get_dbt"."wetube"."my_first_dbt_model"
where id = 1
  );
15:41:00.594944 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:41:00.598465 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:41:00.598808 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
alter table "get_dbt"."wetube"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:41:00.599505 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:41:00.601100 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:41:00.601278 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:41:00.601468 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: COMMIT
15:41:00.613500 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
15:41:00.616806 [debug] [Thread-1  ]: Using postgres connection "model.dbt_blog.my_second_dbt_model"
15:41:00.617187 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "node_id": "model.dbt_blog.my_second_dbt_model"} */
drop view if exists "get_dbt"."wetube"."my_second_dbt_model__dbt_backup" cascade
15:41:00.617727 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:41:00.619531 [debug] [Thread-1  ]: finished collecting timing info
15:41:00.619744 [debug] [Thread-1  ]: On model.dbt_blog.my_second_dbt_model: Close
15:41:00.620176 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4934ea3-833c-42a9-bea0-4335fb7ec8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d8312fa0>]}
15:41:00.620569 [info ] [Thread-1  ]: 5 of 5 OK created view model wetube.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.09s]
15:41:00.621005 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
15:41:00.622827 [debug] [MainThread]: Acquiring new postgres connection "master"
15:41:00.623082 [debug] [MainThread]: Using postgres connection "master"
15:41:00.623312 [debug] [MainThread]: On master: BEGIN
15:41:00.623450 [debug] [MainThread]: Opening a new connection, currently in state closed
15:41:00.635824 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:41:00.636116 [debug] [MainThread]: On master: COMMIT
15:41:00.636273 [debug] [MainThread]: Using postgres connection "master"
15:41:00.636417 [debug] [MainThread]: On master: COMMIT
15:41:00.636681 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:41:00.636853 [debug] [MainThread]: On master: Close
15:41:00.637336 [info ] [MainThread]: 
15:41:00.637629 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0.49s.
15:41:00.638155 [debug] [MainThread]: Connection 'master' was properly closed.
15:41:00.638547 [debug] [MainThread]: Connection 'model.dbt_blog.my_second_dbt_model' was properly closed.
15:41:00.652461 [info ] [MainThread]: 
15:41:00.653003 [info ] [MainThread]: [32mCompleted successfully[0m
15:41:00.653656 [info ] [MainThread]: 
15:41:00.654263 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
15:41:00.655073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d760d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d80550d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d81e6310>]}


============================== 2022-07-24 17:25:49.253964 | 3bb464b4-dd35-4c80-8bfc-d71a32edf4bd ==============================
17:25:49.253987 [info ] [MainThread]: Running with dbt=1.1.1
17:25:49.255186 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
17:25:49.255393 [debug] [MainThread]: Tracking: tracking
17:25:49.299111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb666efb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb666ef3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb666f1550>]}
17:25:49.368655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:25:49.369230 [debug] [MainThread]: Partial parsing: updated file: dbt_blog://models/mart/total_likes_by_video.sql
17:25:49.389618 [debug] [MainThread]: 1699: static parser successfully parsed mart/total_likes_by_video.sql
17:25:49.489664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bb464b4-dd35-4c80-8bfc-d71a32edf4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb664a2df0>]}
17:25:49.499287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bb464b4-dd35-4c80-8bfc-d71a32edf4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb667fe310>]}
17:25:49.499611 [info ] [MainThread]: Found 5 models, 21 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
17:25:49.499904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bb464b4-dd35-4c80-8bfc-d71a32edf4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb664906a0>]}
17:25:49.502520 [info ] [MainThread]: 
17:25:49.503023 [debug] [MainThread]: Acquiring new postgres connection "master"
17:25:49.504169 [debug] [ThreadPool]: Acquiring new postgres connection "list_get_dbt_wetube"
17:25:49.516500 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
17:25:49.516714 [debug] [ThreadPool]: On list_get_dbt_wetube: BEGIN
17:25:49.516861 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:25:49.589391 [debug] [ThreadPool]: SQL status: BEGIN in 0.07 seconds
17:25:49.589632 [debug] [ThreadPool]: Using postgres connection "list_get_dbt_wetube"
17:25:49.589781 [debug] [ThreadPool]: On list_get_dbt_wetube: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "list_get_dbt_wetube"} */
select
      'get_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wetube'
    union all
    select
      'get_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wetube'
  
17:25:49.599164 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
17:25:49.601063 [debug] [ThreadPool]: On list_get_dbt_wetube: ROLLBACK
17:25:49.602492 [debug] [ThreadPool]: On list_get_dbt_wetube: Close
17:25:49.608175 [debug] [MainThread]: Using postgres connection "master"
17:25:49.608365 [debug] [MainThread]: On master: BEGIN
17:25:49.608509 [debug] [MainThread]: Opening a new connection, currently in state init
17:25:49.634233 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
17:25:49.634482 [debug] [MainThread]: Using postgres connection "master"
17:25:49.634630 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:25:49.750607 [debug] [MainThread]: SQL status: SELECT 2 in 0.12 seconds
17:25:49.752606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bb464b4-dd35-4c80-8bfc-d71a32edf4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb666e3b50>]}
17:25:49.752948 [debug] [MainThread]: On master: ROLLBACK
17:25:49.753273 [debug] [MainThread]: On master: Close
17:25:49.753708 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
17:25:49.754032 [info ] [MainThread]: 
17:25:49.759111 [debug] [Thread-1  ]: Began running node model.dbt_blog.account_information
17:25:49.759515 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.account_information"
17:25:49.759689 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.account_information
17:25:49.759848 [debug] [Thread-1  ]: Compiling model.dbt_blog.account_information
17:25:49.765057 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.account_information"
17:25:49.766809 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.767009 [debug] [Thread-1  ]: Began executing node model.dbt_blog.account_information
17:25:49.767191 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.767724 [debug] [Thread-1  ]: Finished running node model.dbt_blog.account_information
17:25:49.767978 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_first_dbt_model
17:25:49.768749 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_first_dbt_model"
17:25:49.768927 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_first_dbt_model
17:25:49.769077 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_first_dbt_model
17:25:49.771674 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_first_dbt_model"
17:25:49.772805 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.773144 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_first_dbt_model
17:25:49.773527 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.774299 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_first_dbt_model
17:25:49.774630 [debug] [Thread-1  ]: Began running node model.dbt_blog.number_of_subs_by_channel
17:25:49.775237 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.number_of_subs_by_channel"
17:25:49.775416 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.number_of_subs_by_channel
17:25:49.775571 [debug] [Thread-1  ]: Compiling model.dbt_blog.number_of_subs_by_channel
17:25:49.779579 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.number_of_subs_by_channel"
17:25:49.780257 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.780454 [debug] [Thread-1  ]: Began executing node model.dbt_blog.number_of_subs_by_channel
17:25:49.780625 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.781263 [debug] [Thread-1  ]: Finished running node model.dbt_blog.number_of_subs_by_channel
17:25:49.781683 [debug] [Thread-1  ]: Began running node model.dbt_blog.total_likes_by_video
17:25:49.782647 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.total_likes_by_video"
17:25:49.783160 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.total_likes_by_video
17:25:49.783359 [debug] [Thread-1  ]: Compiling model.dbt_blog.total_likes_by_video
17:25:49.787131 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.total_likes_by_video"
17:25:49.788813 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.789001 [debug] [Thread-1  ]: Began executing node model.dbt_blog.total_likes_by_video
17:25:49.789165 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.789673 [debug] [Thread-1  ]: Finished running node model.dbt_blog.total_likes_by_video
17:25:49.789893 [debug] [Thread-1  ]: Began running node test.dbt_blog.not_null_account_information_channel_creation.7e18a83ce5
17:25:49.790347 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_blog.not_null_account_information_channel_creation.7e18a83ce5"
17:25:49.790526 [debug] [Thread-1  ]: Began compiling node test.dbt_blog.not_null_account_information_channel_creation.7e18a83ce5
17:25:49.790682 [debug] [Thread-1  ]: Compiling test.dbt_blog.not_null_account_information_channel_creation.7e18a83ce5
17:25:49.806621 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_blog.not_null_account_information_channel_creation.7e18a83ce5"
17:25:49.807288 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.807477 [debug] [Thread-1  ]: Began executing node test.dbt_blog.not_null_account_information_channel_creation.7e18a83ce5
17:25:49.807643 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.808071 [debug] [Thread-1  ]: Finished running node test.dbt_blog.not_null_account_information_channel_creation.7e18a83ce5
17:25:49.808276 [debug] [Thread-1  ]: Began running node test.dbt_blog.not_null_account_information_channel_name.83ef84fc1b
17:25:49.808586 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_blog.not_null_account_information_channel_name.83ef84fc1b"
17:25:49.808747 [debug] [Thread-1  ]: Began compiling node test.dbt_blog.not_null_account_information_channel_name.83ef84fc1b
17:25:49.808896 [debug] [Thread-1  ]: Compiling test.dbt_blog.not_null_account_information_channel_name.83ef84fc1b
17:25:49.812805 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_blog.not_null_account_information_channel_name.83ef84fc1b"
17:25:49.813359 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.813534 [debug] [Thread-1  ]: Began executing node test.dbt_blog.not_null_account_information_channel_name.83ef84fc1b
17:25:49.813693 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.814096 [debug] [Thread-1  ]: Finished running node test.dbt_blog.not_null_account_information_channel_name.83ef84fc1b
17:25:49.814298 [debug] [Thread-1  ]: Began running node test.dbt_blog.not_null_account_information_city_name.5f58b84f9f
17:25:49.814751 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_blog.not_null_account_information_city_name.5f58b84f9f"
17:25:49.814921 [debug] [Thread-1  ]: Began compiling node test.dbt_blog.not_null_account_information_city_name.5f58b84f9f
17:25:49.815067 [debug] [Thread-1  ]: Compiling test.dbt_blog.not_null_account_information_city_name.5f58b84f9f
17:25:49.818953 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_blog.not_null_account_information_city_name.5f58b84f9f"
17:25:49.819390 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.819556 [debug] [Thread-1  ]: Began executing node test.dbt_blog.not_null_account_information_city_name.5f58b84f9f
17:25:49.819755 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.820210 [debug] [Thread-1  ]: Finished running node test.dbt_blog.not_null_account_information_city_name.5f58b84f9f
17:25:49.820414 [debug] [Thread-1  ]: Began running node test.dbt_blog.not_null_account_information_email.395093f840
17:25:49.820795 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_blog.not_null_account_information_email.395093f840"
17:25:49.820964 [debug] [Thread-1  ]: Began compiling node test.dbt_blog.not_null_account_information_email.395093f840
17:25:49.821109 [debug] [Thread-1  ]: Compiling test.dbt_blog.not_null_account_information_email.395093f840
17:25:49.824878 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_blog.not_null_account_information_email.395093f840"
17:25:49.825385 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.825558 [debug] [Thread-1  ]: Began executing node test.dbt_blog.not_null_account_information_email.395093f840
17:25:49.825712 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.826107 [debug] [Thread-1  ]: Finished running node test.dbt_blog.not_null_account_information_email.395093f840
17:25:49.826304 [debug] [Thread-1  ]: Began running node test.dbt_blog.not_null_account_information_first_name.984d85f718
17:25:49.826595 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_blog.not_null_account_information_first_name.984d85f718"
17:25:49.826749 [debug] [Thread-1  ]: Began compiling node test.dbt_blog.not_null_account_information_first_name.984d85f718
17:25:49.826892 [debug] [Thread-1  ]: Compiling test.dbt_blog.not_null_account_information_first_name.984d85f718
17:25:49.830725 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_blog.not_null_account_information_first_name.984d85f718"
17:25:49.831245 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.831418 [debug] [Thread-1  ]: Began executing node test.dbt_blog.not_null_account_information_first_name.984d85f718
17:25:49.831567 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.831946 [debug] [Thread-1  ]: Finished running node test.dbt_blog.not_null_account_information_first_name.984d85f718
17:25:49.832135 [debug] [Thread-1  ]: Began running node test.dbt_blog.not_null_account_information_id_account.bf43591088
17:25:49.832415 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_blog.not_null_account_information_id_account.bf43591088"
17:25:49.832563 [debug] [Thread-1  ]: Began compiling node test.dbt_blog.not_null_account_information_id_account.bf43591088
17:25:49.832701 [debug] [Thread-1  ]: Compiling test.dbt_blog.not_null_account_information_id_account.bf43591088
17:25:49.837497 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_blog.not_null_account_information_id_account.bf43591088"
17:25:49.837927 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.838091 [debug] [Thread-1  ]: Began executing node test.dbt_blog.not_null_account_information_id_account.bf43591088
17:25:49.838247 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.838625 [debug] [Thread-1  ]: Finished running node test.dbt_blog.not_null_account_information_id_account.bf43591088
17:25:49.838807 [debug] [Thread-1  ]: Began running node test.dbt_blog.not_null_account_information_id_channel.1503a2c6a7
17:25:49.839105 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_blog.not_null_account_information_id_channel.1503a2c6a7"
17:25:49.839245 [debug] [Thread-1  ]: Began compiling node test.dbt_blog.not_null_account_information_id_channel.1503a2c6a7
17:25:49.839374 [debug] [Thread-1  ]: Compiling test.dbt_blog.not_null_account_information_id_channel.1503a2c6a7
17:25:49.842700 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_blog.not_null_account_information_id_channel.1503a2c6a7"
17:25:49.843075 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.843227 [debug] [Thread-1  ]: Began executing node test.dbt_blog.not_null_account_information_id_channel.1503a2c6a7
17:25:49.843351 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.843665 [debug] [Thread-1  ]: Finished running node test.dbt_blog.not_null_account_information_id_channel.1503a2c6a7
17:25:49.843821 [debug] [Thread-1  ]: Began running node test.dbt_blog.not_null_account_information_last_name.15cc6fbe68
17:25:49.844056 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_blog.not_null_account_information_last_name.15cc6fbe68"
17:25:49.844192 [debug] [Thread-1  ]: Began compiling node test.dbt_blog.not_null_account_information_last_name.15cc6fbe68
17:25:49.844305 [debug] [Thread-1  ]: Compiling test.dbt_blog.not_null_account_information_last_name.15cc6fbe68
17:25:49.847294 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_blog.not_null_account_information_last_name.15cc6fbe68"
17:25:49.847630 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.847758 [debug] [Thread-1  ]: Began executing node test.dbt_blog.not_null_account_information_last_name.15cc6fbe68
17:25:49.847873 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.848169 [debug] [Thread-1  ]: Finished running node test.dbt_blog.not_null_account_information_last_name.15cc6fbe68
17:25:49.848316 [debug] [Thread-1  ]: Began running node test.dbt_blog.not_null_account_information_state_name.4034a13391
17:25:49.848535 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_blog.not_null_account_information_state_name.4034a13391"
17:25:49.848654 [debug] [Thread-1  ]: Began compiling node test.dbt_blog.not_null_account_information_state_name.4034a13391
17:25:49.848761 [debug] [Thread-1  ]: Compiling test.dbt_blog.not_null_account_information_state_name.4034a13391
17:25:49.851564 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_blog.not_null_account_information_state_name.4034a13391"
17:25:49.852040 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.852269 [debug] [Thread-1  ]: Began executing node test.dbt_blog.not_null_account_information_state_name.4034a13391
17:25:49.852523 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.853013 [debug] [Thread-1  ]: Finished running node test.dbt_blog.not_null_account_information_state_name.4034a13391
17:25:49.853279 [debug] [Thread-1  ]: Began running node model.dbt_blog.my_second_dbt_model
17:25:49.853639 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_blog.my_second_dbt_model"
17:25:49.853757 [debug] [Thread-1  ]: Began compiling node model.dbt_blog.my_second_dbt_model
17:25:49.853957 [debug] [Thread-1  ]: Compiling model.dbt_blog.my_second_dbt_model
17:25:49.855835 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_blog.my_second_dbt_model"
17:25:49.856194 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.856317 [debug] [Thread-1  ]: Began executing node model.dbt_blog.my_second_dbt_model
17:25:49.856433 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.856740 [debug] [Thread-1  ]: Finished running node model.dbt_blog.my_second_dbt_model
17:25:49.856889 [debug] [Thread-1  ]: Began running node test.dbt_blog.not_null_my_first_dbt_model_id.5fb22c2710
17:25:49.857230 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_blog.not_null_my_first_dbt_model_id.5fb22c2710"
17:25:49.857357 [debug] [Thread-1  ]: Began compiling node test.dbt_blog.not_null_my_first_dbt_model_id.5fb22c2710
17:25:49.857469 [debug] [Thread-1  ]: Compiling test.dbt_blog.not_null_my_first_dbt_model_id.5fb22c2710
17:25:49.860393 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_blog.not_null_my_first_dbt_model_id.5fb22c2710"
17:25:49.860976 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.861115 [debug] [Thread-1  ]: Began executing node test.dbt_blog.not_null_my_first_dbt_model_id.5fb22c2710
17:25:49.861233 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.861535 [debug] [Thread-1  ]: Finished running node test.dbt_blog.not_null_my_first_dbt_model_id.5fb22c2710
17:25:49.861683 [debug] [Thread-1  ]: Began running node test.dbt_blog.unique_my_first_dbt_model_id.16e066b321
17:25:49.861904 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_blog.unique_my_first_dbt_model_id.16e066b321"
17:25:49.862020 [debug] [Thread-1  ]: Began compiling node test.dbt_blog.unique_my_first_dbt_model_id.16e066b321
17:25:49.862126 [debug] [Thread-1  ]: Compiling test.dbt_blog.unique_my_first_dbt_model_id.16e066b321
17:25:49.867448 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_blog.unique_my_first_dbt_model_id.16e066b321"
17:25:49.867922 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.868059 [debug] [Thread-1  ]: Began executing node test.dbt_blog.unique_my_first_dbt_model_id.16e066b321
17:25:49.868177 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.868477 [debug] [Thread-1  ]: Finished running node test.dbt_blog.unique_my_first_dbt_model_id.16e066b321
17:25:49.868631 [debug] [Thread-1  ]: Began running node test.dbt_blog.not_null_number_of_subs_by_channel_channel.4e8a2d3994
17:25:49.868910 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_blog.not_null_number_of_subs_by_channel_channel.4e8a2d3994"
17:25:49.869085 [debug] [Thread-1  ]: Began compiling node test.dbt_blog.not_null_number_of_subs_by_channel_channel.4e8a2d3994
17:25:49.869210 [debug] [Thread-1  ]: Compiling test.dbt_blog.not_null_number_of_subs_by_channel_channel.4e8a2d3994
17:25:49.871993 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_blog.not_null_number_of_subs_by_channel_channel.4e8a2d3994"
17:25:49.872327 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.872449 [debug] [Thread-1  ]: Began executing node test.dbt_blog.not_null_number_of_subs_by_channel_channel.4e8a2d3994
17:25:49.872561 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.872848 [debug] [Thread-1  ]: Finished running node test.dbt_blog.not_null_number_of_subs_by_channel_channel.4e8a2d3994
17:25:49.873062 [debug] [Thread-1  ]: Began running node test.dbt_blog.not_null_number_of_subs_by_channel_id_channel.5b7ebeb01e
17:25:49.873411 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_blog.not_null_number_of_subs_by_channel_id_channel.5b7ebeb01e"
17:25:49.873533 [debug] [Thread-1  ]: Began compiling node test.dbt_blog.not_null_number_of_subs_by_channel_id_channel.5b7ebeb01e
17:25:49.873643 [debug] [Thread-1  ]: Compiling test.dbt_blog.not_null_number_of_subs_by_channel_id_channel.5b7ebeb01e
17:25:49.876696 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_blog.not_null_number_of_subs_by_channel_id_channel.5b7ebeb01e"
17:25:49.877108 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.877238 [debug] [Thread-1  ]: Began executing node test.dbt_blog.not_null_number_of_subs_by_channel_id_channel.5b7ebeb01e
17:25:49.877355 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.877654 [debug] [Thread-1  ]: Finished running node test.dbt_blog.not_null_number_of_subs_by_channel_id_channel.5b7ebeb01e
17:25:49.877804 [debug] [Thread-1  ]: Began running node test.dbt_blog.not_null_number_of_subs_by_channel_num_of_subs.6b5f17f826
17:25:49.878233 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_blog.not_null_number_of_subs_by_channel_num_of_subs.6b5f17f826"
17:25:49.878371 [debug] [Thread-1  ]: Began compiling node test.dbt_blog.not_null_number_of_subs_by_channel_num_of_subs.6b5f17f826
17:25:49.878536 [debug] [Thread-1  ]: Compiling test.dbt_blog.not_null_number_of_subs_by_channel_num_of_subs.6b5f17f826
17:25:49.881506 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_blog.not_null_number_of_subs_by_channel_num_of_subs.6b5f17f826"
17:25:49.881850 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.881978 [debug] [Thread-1  ]: Began executing node test.dbt_blog.not_null_number_of_subs_by_channel_num_of_subs.6b5f17f826
17:25:49.882092 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.882388 [debug] [Thread-1  ]: Finished running node test.dbt_blog.not_null_number_of_subs_by_channel_num_of_subs.6b5f17f826
17:25:49.882536 [debug] [Thread-1  ]: Began running node test.dbt_blog.not_null_total_likes_by_video_channel.6661558f8d
17:25:49.882757 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_blog.not_null_total_likes_by_video_channel.6661558f8d"
17:25:49.882873 [debug] [Thread-1  ]: Began compiling node test.dbt_blog.not_null_total_likes_by_video_channel.6661558f8d
17:25:49.882981 [debug] [Thread-1  ]: Compiling test.dbt_blog.not_null_total_likes_by_video_channel.6661558f8d
17:25:49.885877 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_blog.not_null_total_likes_by_video_channel.6661558f8d"
17:25:49.886211 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.886338 [debug] [Thread-1  ]: Began executing node test.dbt_blog.not_null_total_likes_by_video_channel.6661558f8d
17:25:49.886452 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.886749 [debug] [Thread-1  ]: Finished running node test.dbt_blog.not_null_total_likes_by_video_channel.6661558f8d
17:25:49.886895 [debug] [Thread-1  ]: Began running node test.dbt_blog.not_null_total_likes_by_video_id_channel.56941e4ff8
17:25:49.887114 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_blog.not_null_total_likes_by_video_id_channel.56941e4ff8"
17:25:49.887234 [debug] [Thread-1  ]: Began compiling node test.dbt_blog.not_null_total_likes_by_video_id_channel.56941e4ff8
17:25:49.887342 [debug] [Thread-1  ]: Compiling test.dbt_blog.not_null_total_likes_by_video_id_channel.56941e4ff8
17:25:49.890401 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_blog.not_null_total_likes_by_video_id_channel.56941e4ff8"
17:25:49.890795 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.890925 [debug] [Thread-1  ]: Began executing node test.dbt_blog.not_null_total_likes_by_video_id_channel.56941e4ff8
17:25:49.891042 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.891336 [debug] [Thread-1  ]: Finished running node test.dbt_blog.not_null_total_likes_by_video_id_channel.56941e4ff8
17:25:49.891483 [debug] [Thread-1  ]: Began running node test.dbt_blog.not_null_total_likes_by_video_id_video.e98dfe96b2
17:25:49.891701 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_blog.not_null_total_likes_by_video_id_video.e98dfe96b2"
17:25:49.891816 [debug] [Thread-1  ]: Began compiling node test.dbt_blog.not_null_total_likes_by_video_id_video.e98dfe96b2
17:25:49.891923 [debug] [Thread-1  ]: Compiling test.dbt_blog.not_null_total_likes_by_video_id_video.e98dfe96b2
17:25:49.896350 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_blog.not_null_total_likes_by_video_id_video.e98dfe96b2"
17:25:49.896977 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.897138 [debug] [Thread-1  ]: Began executing node test.dbt_blog.not_null_total_likes_by_video_id_video.e98dfe96b2
17:25:49.897298 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.897670 [debug] [Thread-1  ]: Finished running node test.dbt_blog.not_null_total_likes_by_video_id_video.e98dfe96b2
17:25:49.897827 [debug] [Thread-1  ]: Began running node test.dbt_blog.not_null_total_likes_by_video_title.1fd2392c14
17:25:49.898258 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_blog.not_null_total_likes_by_video_title.1fd2392c14"
17:25:49.898460 [debug] [Thread-1  ]: Began compiling node test.dbt_blog.not_null_total_likes_by_video_title.1fd2392c14
17:25:49.898571 [debug] [Thread-1  ]: Compiling test.dbt_blog.not_null_total_likes_by_video_title.1fd2392c14
17:25:49.902547 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_blog.not_null_total_likes_by_video_title.1fd2392c14"
17:25:49.903093 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.903227 [debug] [Thread-1  ]: Began executing node test.dbt_blog.not_null_total_likes_by_video_title.1fd2392c14
17:25:49.903348 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.903679 [debug] [Thread-1  ]: Finished running node test.dbt_blog.not_null_total_likes_by_video_title.1fd2392c14
17:25:49.903831 [debug] [Thread-1  ]: Began running node test.dbt_blog.not_null_total_likes_by_video_total_likes.6f89f72266
17:25:49.904277 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_blog.not_null_total_likes_by_video_total_likes.6f89f72266"
17:25:49.904465 [debug] [Thread-1  ]: Began compiling node test.dbt_blog.not_null_total_likes_by_video_total_likes.6f89f72266
17:25:49.904607 [debug] [Thread-1  ]: Compiling test.dbt_blog.not_null_total_likes_by_video_total_likes.6f89f72266
17:25:49.907847 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_blog.not_null_total_likes_by_video_total_likes.6f89f72266"
17:25:49.908261 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.908427 [debug] [Thread-1  ]: Began executing node test.dbt_blog.not_null_total_likes_by_video_total_likes.6f89f72266
17:25:49.908542 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.908895 [debug] [Thread-1  ]: Finished running node test.dbt_blog.not_null_total_likes_by_video_total_likes.6f89f72266
17:25:49.909063 [debug] [Thread-1  ]: Began running node test.dbt_blog.not_null_my_second_dbt_model_id.151b76d778
17:25:49.909468 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_blog.not_null_my_second_dbt_model_id.151b76d778"
17:25:49.909596 [debug] [Thread-1  ]: Began compiling node test.dbt_blog.not_null_my_second_dbt_model_id.151b76d778
17:25:49.909706 [debug] [Thread-1  ]: Compiling test.dbt_blog.not_null_my_second_dbt_model_id.151b76d778
17:25:49.912886 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_blog.not_null_my_second_dbt_model_id.151b76d778"
17:25:49.913303 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.913449 [debug] [Thread-1  ]: Began executing node test.dbt_blog.not_null_my_second_dbt_model_id.151b76d778
17:25:49.913593 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.913948 [debug] [Thread-1  ]: Finished running node test.dbt_blog.not_null_my_second_dbt_model_id.151b76d778
17:25:49.914132 [debug] [Thread-1  ]: Began running node test.dbt_blog.unique_my_second_dbt_model_id.57a0f8c493
17:25:49.914455 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_blog.unique_my_second_dbt_model_id.57a0f8c493"
17:25:49.914588 [debug] [Thread-1  ]: Began compiling node test.dbt_blog.unique_my_second_dbt_model_id.57a0f8c493
17:25:49.914707 [debug] [Thread-1  ]: Compiling test.dbt_blog.unique_my_second_dbt_model_id.57a0f8c493
17:25:49.918182 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_blog.unique_my_second_dbt_model_id.57a0f8c493"
17:25:49.918618 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.918775 [debug] [Thread-1  ]: Began executing node test.dbt_blog.unique_my_second_dbt_model_id.57a0f8c493
17:25:49.918921 [debug] [Thread-1  ]: finished collecting timing info
17:25:49.919316 [debug] [Thread-1  ]: Finished running node test.dbt_blog.unique_my_second_dbt_model_id.57a0f8c493
17:25:49.920204 [debug] [MainThread]: Connection 'master' was properly closed.
17:25:49.920365 [debug] [MainThread]: Connection 'test.dbt_blog.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:25:49.927441 [info ] [MainThread]: Done.
17:25:49.931739 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
17:25:49.932157 [info ] [MainThread]: Building catalog
17:25:49.935900 [debug] [ThreadPool]: Acquiring new postgres connection "get_dbt.information_schema"
17:25:49.945733 [debug] [ThreadPool]: Using postgres connection "get_dbt.information_schema"
17:25:49.946142 [debug] [ThreadPool]: On get_dbt.information_schema: BEGIN
17:25:49.946363 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:25:49.977285 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
17:25:49.977559 [debug] [ThreadPool]: Using postgres connection "get_dbt.information_schema"
17:25:49.977786 [debug] [ThreadPool]: On get_dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_blog", "target_name": "dev", "connection_name": "get_dbt.information_schema"} */

    
    

    select
        'get_dbt' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('wetube'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
17:25:50.094546 [debug] [ThreadPool]: SQL status: SELECT 50 in 0.12 seconds
17:25:50.106572 [debug] [ThreadPool]: On get_dbt.information_schema: ROLLBACK
17:25:50.107001 [debug] [ThreadPool]: On get_dbt.information_schema: Close
17:25:50.119575 [info ] [MainThread]: Catalog written to /Users/joao.sanches/Documents/blog/dbt_project/dbt_blog/target/catalog.json
17:25:50.120036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb666efb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb66aa1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb66aa1cd0>]}
17:25:50.792442 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
17:25:50.792762 [debug] [MainThread]: Connection 'get_dbt.information_schema' was properly closed.


============================== 2022-07-24 17:26:14.213417 | 384654b1-c60c-46d7-b92f-2fcdeb4ec980 ==============================
17:26:14.213444 [info ] [MainThread]: Running with dbt=1.1.1
17:26:14.215110 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
17:26:14.215684 [debug] [MainThread]: Tracking: tracking
17:26:14.256617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f87ce2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f87ce2670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f87ced640>]}
17:26:14.267353 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
17:26:14.268181 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
17:26:14.268974 [info ] [MainThread]: 
17:26:14.269650 [info ] [MainThread]: 
17:26:14.269937 [info ] [MainThread]: Press Ctrl+C to exit.
17:26:14.271587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f87cedd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f87ced6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f87ceddf0>]}


============================== 2022-07-24 17:32:28.567271 | 6cd9cf79-9047-4dec-818e-4ba4def83575 ==============================
17:32:28.567294 [info ] [MainThread]: Running with dbt=1.1.1
17:32:28.568477 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joao.sanches/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
17:32:28.568666 [debug] [MainThread]: Tracking: tracking
17:32:28.592870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1996d7070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1996d78b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1998311f0>]}
17:32:28.597777 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
17:32:28.598608 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
17:32:28.598968 [info ] [MainThread]: 
17:32:28.599505 [info ] [MainThread]: 
17:32:28.599794 [info ] [MainThread]: Press Ctrl+C to exit.
